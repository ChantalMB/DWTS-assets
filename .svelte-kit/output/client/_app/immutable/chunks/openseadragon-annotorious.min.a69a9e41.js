import{g as Nx,c as Es}from"./_commonjsHelpers.725317a4.js";function zx(wn,cr){for(var Wt=0;Wt<cr.length;Wt++){const dt=cr[Wt];if(typeof dt!="string"&&!Array.isArray(dt)){for(const T in dt)if(T!=="default"&&!(T in wn)){const pt=Object.getOwnPropertyDescriptor(dt,T);pt&&Object.defineProperty(wn,T,pt.get?pt:{enumerable:!0,get:()=>dt[T]})}}}return Object.freeze(Object.defineProperty(wn,Symbol.toStringTag,{value:"Module"}))}var cd={exports:{}};(function(wn,cr){(function(Wt,dt){wn.exports=dt()})(Es,function(){var Wt=Object.defineProperty,dt=(t,i,e)=>i in t?Wt(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,T=(t,i,e)=>(dt(t,typeof i!="symbol"?i+"":i,e),e),pt,Z,bs,En,xs,Ss,_s,Zn={},Cs=[],dd=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ft(t,i){for(var e in i)t[e]=i[e];return t}function Ts(t){var i=t.parentNode;i&&i.removeChild(t)}function Oe(t,i,e){var n,r,o,s={};for(o in i)o=="key"?n=i[o]:o=="ref"?r=i[o]:s[o]=i[o];if(arguments.length>2&&(s.children=arguments.length>3?pt.call(arguments,2):e),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return bn(t,s,n,r,null)}function bn(t,i,e,n,r){var o={type:t,props:i,key:e,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r??++bs};return r==null&&Z.vnode!=null&&Z.vnode(o),o}function hr(){return{current:null}}function et(t){return t.children}function Ae(t,i){this.props=t,this.context=i}function Gt(t,i){if(i==null)return t.__?Gt(t.__,t.__.__k.indexOf(t)+1):null;for(var e;i<t.__k.length;i++)if((e=t.__k[i])!=null&&e.__e!=null)return e.__e;return typeof t.type=="function"?Gt(t):null}function Ps(t){var i,e;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,i=0;i<t.__k.length;i++)if((e=t.__k[i])!=null&&e.__e!=null){t.__e=t.__c.base=e.__e;break}return Ps(t)}}function dr(t){(!t.__d&&(t.__d=!0)&&En.push(t)&&!Kn.__r++||Ss!==Z.debounceRendering)&&((Ss=Z.debounceRendering)||xs)(Kn)}function Kn(){for(var t;Kn.__r=En.length;)t=En.sort(function(i,e){return i.__v.__b-e.__v.__b}),En=[],t.some(function(i){var e,n,r,o,s,a;i.__d&&(s=(o=(e=i).__v).__e,(a=e.__P)&&(n=[],(r=ft({},o)).__v=o.__v+1,pr(a,o,r,e.__n,a.ownerSVGElement!==void 0,o.__h!=null?[s]:null,n,s??Gt(o),o.__h),Ms(n,o),o.__e!=s&&Ps(o)))})}function As(t,i,e,n,r,o,s,a,l,u){var c,h,d,g,y,S,E,C=n&&n.__k||Cs,p=C.length;for(e.__k=[],c=0;c<i.length;c++)if((g=e.__k[c]=(g=i[c])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?bn(null,g,null,null,g):Array.isArray(g)?bn(et,{children:g},null,null,null):g.__b>0?bn(g.type,g.props,g.key,null,g.__v):g)!=null){if(g.__=e,g.__b=e.__b+1,(d=C[c])===null||d&&g.key==d.key&&g.type===d.type)C[c]=void 0;else for(h=0;h<p;h++){if((d=C[h])&&g.key==d.key&&g.type===d.type){C[h]=void 0;break}d=null}pr(t,g,d=d||Zn,r,o,s,a,l,u),y=g.__e,(h=g.ref)&&d.ref!=h&&(E||(E=[]),d.ref&&E.push(d.ref,null,g),E.push(h,g.__c||y,g)),y!=null?(S==null&&(S=y),typeof g.type=="function"&&g.__k===d.__k?g.__d=l=Ds(g,l,t):l=Os(t,g,d,C,y,l),typeof e.type=="function"&&(e.__d=l)):l&&d.__e==l&&l.parentNode!=t&&(l=Gt(d))}for(e.__e=S,c=p;c--;)C[c]!=null&&(typeof e.type=="function"&&C[c].__e!=null&&C[c].__e==e.__d&&(e.__d=Gt(n,c+1)),Is(C[c],C[c]));if(E)for(c=0;c<E.length;c++)Fs(E[c],E[++c],E[++c])}function Ds(t,i,e){for(var n,r=t.__k,o=0;r&&o<r.length;o++)(n=r[o])&&(n.__=t,i=typeof n.type=="function"?Ds(n,i,e):Os(e,n,n,r,n.__e,i));return i}function gt(t,i){return i=i||[],t==null||typeof t=="boolean"||(Array.isArray(t)?t.some(function(e){gt(e,i)}):i.push(t)),i}function Os(t,i,e,n,r,o){var s,a,l;if(i.__d!==void 0)s=i.__d,i.__d=void 0;else if(e==null||r!=o||r.parentNode==null)e:if(o==null||o.parentNode!==t)t.appendChild(r),s=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<n.length;l+=2)if(a==r)break e;t.insertBefore(r,o),s=o}return s!==void 0?s:r.nextSibling}function pd(t,i,e,n,r){var o;for(o in e)o==="children"||o==="key"||o in i||Jn(t,o,null,e[o],n);for(o in i)r&&typeof i[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||e[o]===i[o]||Jn(t,o,i[o],e[o],n)}function Rs(t,i,e){i[0]==="-"?t.setProperty(i,e):t[i]=e==null?"":typeof e!="number"||dd.test(i)?e:e+"px"}function Jn(t,i,e,n,r){var o;e:if(i==="style")if(typeof e=="string")t.style.cssText=e;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(i in n)e&&i in e||Rs(t.style,i,"");if(e)for(i in e)n&&e[i]===n[i]||Rs(t.style,i,e[i])}else if(i[0]==="o"&&i[1]==="n")o=i!==(i=i.replace(/Capture$/,"")),i=i.toLowerCase()in t?i.toLowerCase().slice(2):i.slice(2),t.l||(t.l={}),t.l[i+o]=e,e?n||t.addEventListener(i,o?Bs:ks,o):t.removeEventListener(i,o?Bs:ks,o);else if(i!=="dangerouslySetInnerHTML"){if(r)i=i.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(i!=="href"&&i!=="list"&&i!=="form"&&i!=="tabIndex"&&i!=="download"&&i in t)try{t[i]=e??"";break e}catch{}typeof e=="function"||(e!=null&&(e!==!1||i[0]==="a"&&i[1]==="r")?t.setAttribute(i,e):t.removeAttribute(i))}}function ks(t){this.l[t.type+!1](Z.event?Z.event(t):t)}function Bs(t){this.l[t.type+!0](Z.event?Z.event(t):t)}function pr(t,i,e,n,r,o,s,a,l){var u,c,h,d,g,y,S,E,C,p,x,A=i.type;if(i.constructor!==void 0)return null;e.__h!=null&&(l=e.__h,a=i.__e=e.__e,i.__h=null,o=[a]),(u=Z.__b)&&u(i);try{e:if(typeof A=="function"){if(E=i.props,C=(u=A.contextType)&&n[u.__c],p=u?C?C.props.value:u.__:n,e.__c?S=(c=i.__c=e.__c).__=c.__E:("prototype"in A&&A.prototype.render?i.__c=c=new A(E,p):(i.__c=c=new Ae(E,p),c.constructor=A,c.render=gd),C&&C.sub(c),c.props=E,c.state||(c.state={}),c.context=p,c.__n=n,h=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),A.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=ft({},c.__s)),ft(c.__s,A.getDerivedStateFromProps(E,c.__s))),d=c.props,g=c.state,h)A.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(A.getDerivedStateFromProps==null&&E!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(E,p),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(E,c.__s,p)===!1||i.__v===e.__v){c.props=E,c.state=c.__s,i.__v!==e.__v&&(c.__d=!1),c.__v=i,i.__e=e.__e,i.__k=e.__k,i.__k.forEach(function(P){P&&(P.__=i)}),c.__h.length&&s.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(E,c.__s,p),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,g,y)})}c.context=p,c.props=E,c.state=c.__s,(u=Z.__r)&&u(i),c.__d=!1,c.__v=i,c.__P=t,u=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(n=ft(ft({},n),c.getChildContext())),h||c.getSnapshotBeforeUpdate==null||(y=c.getSnapshotBeforeUpdate(d,g)),x=u!=null&&u.type===et&&u.key==null?u.props.children:u,As(t,Array.isArray(x)?x:[x],i,e,n,r,o,s,a,l),c.base=i.__e,i.__h=null,c.__h.length&&s.push(c),S&&(c.__E=c.__=null),c.__e=!1}else o==null&&i.__v===e.__v?(i.__k=e.__k,i.__e=e.__e):i.__e=fd(e.__e,i,e,n,r,o,s,l);(u=Z.diffed)&&u(i)}catch(P){i.__v=null,(l||o!=null)&&(i.__e=a,i.__h=!!l,o[o.indexOf(a)]=null),Z.__e(P,i,e)}}function Ms(t,i){Z.__c&&Z.__c(i,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(n){n.call(e)})}catch(n){Z.__e(n,e.__v)}})}function fd(t,i,e,n,r,o,s,a){var l,u,c,h=e.props,d=i.props,g=i.type,y=0;if(g==="svg"&&(r=!0),o!=null){for(;y<o.length;y++)if((l=o[y])&&"setAttribute"in l==!!g&&(g?l.localName===g:l.nodeType===3)){t=l,o[y]=null;break}}if(t==null){if(g===null)return document.createTextNode(d);t=r?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,d.is&&d),o=null,a=!1}if(g===null)h===d||a&&t.data===d||(t.data=d);else{if(o=o&&pt.call(t.childNodes),u=(h=e.props||Zn).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!a){if(o!=null)for(h={},y=0;y<t.attributes.length;y++)h[t.attributes[y].name]=t.attributes[y].value;(c||u)&&(c&&(u&&c.__html==u.__html||c.__html===t.innerHTML)||(t.innerHTML=c&&c.__html||""))}if(pd(t,d,h,r,a),c)i.__k=[];else if(y=i.props.children,As(t,Array.isArray(y)?y:[y],i,e,n,r&&g!=="foreignObject",o,s,o?o[0]:e.__k&&Gt(e,0),a),o!=null)for(y=o.length;y--;)o[y]!=null&&Ts(o[y]);a||("value"in d&&(y=d.value)!==void 0&&(y!==h.value||y!==t.value||g==="progress"&&!y)&&Jn(t,"value",y,h.value,!1),"checked"in d&&(y=d.checked)!==void 0&&y!==t.checked&&Jn(t,"checked",y,h.checked,!1))}return t}function Fs(t,i,e){try{typeof t=="function"?t(i):t.current=i}catch(n){Z.__e(n,e)}}function Is(t,i,e){var n,r;if(Z.unmount&&Z.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||Fs(n,null,i)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){Z.__e(o,i)}n.base=n.__P=null}if(n=t.__k)for(r=0;r<n.length;r++)n[r]&&Is(n[r],i,typeof t.type!="function");e||t.__e==null||Ts(t.__e),t.__e=t.__d=void 0}function gd(t,i,e){return this.constructor(t,e)}function xn(t,i,e){var n,r,o;Z.__&&Z.__(t,i),r=(n=typeof e=="function")?null:e&&e.__k||i.__k,o=[],pr(i,t=(!n&&e||i).__k=Oe(et,null,[t]),r||Zn,Zn,i.ownerSVGElement!==void 0,!n&&e?[e]:r?null:i.firstChild?pt.call(i.childNodes):null,o,!n&&e?e:r?r.__e:i.firstChild,n),Ms(o,t)}function Ls(t,i){xn(t,i,Ls)}function md(t,i,e){var n,r,o,s=ft({},t.props);for(o in i)o=="key"?n=i[o]:o=="ref"?r=i[o]:s[o]=i[o];return arguments.length>2&&(s.children=arguments.length>3?pt.call(arguments,2):e),bn(t.type,s,n||t.key,r||t.ref,null)}function Sn(t,i){var e={__c:i="__cC"+_s++,__:t,Consumer:function(n,r){return n.children(r)},Provider:function(n){var r,o;return this.getChildContext||(r=[],(o={})[i]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(s){this.props.value!==s.value&&r.some(dr)},this.sub=function(s){r.push(s);var a=s.componentWillUnmount;s.componentWillUnmount=function(){r.splice(r.indexOf(s),1),a&&a.call(s)}}),n.children}};return e.Provider.__=e.Consumer.contextType=e}pt=Cs.slice,Z={__e:function(t,i){for(var e,n,r;i=i.__;)if((e=i.__c)&&!e.__)try{if((n=e.constructor)&&n.getDerivedStateFromError!=null&&(e.setState(n.getDerivedStateFromError(t)),r=e.__d),e.componentDidCatch!=null&&(e.componentDidCatch(t),r=e.__d),r)return e.__E=e}catch(o){t=o}throw t}},bs=0,Ae.prototype.setState=function(t,i){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ft({},this.state),typeof t=="function"&&(t=t(ft({},e),this.props)),t&&ft(e,t),t!=null&&this.__v&&(i&&this.__h.push(i),dr(this))},Ae.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),dr(this))},Ae.prototype.render=et,En=[],xs=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Kn.__r=0,_s=0;var kt,Me,Ns,$t=0,fr=[],zs=Z.__b,Hs=Z.__r,js=Z.diffed,Vs=Z.__c,Us=Z.unmount;function Xt(t,i){Z.__h&&Z.__h(Me,t,$t||i),$t=0;var e=Me.__H||(Me.__H={__:[],__h:[]});return t>=e.__.length&&e.__.push({}),e.__[t]}function mt(t){return $t=1,gr(Xs,t)}function gr(t,i,e){var n=Xt(kt++,2);return n.t=t,n.__c||(n.__=[e?e(i):Xs(void 0,i),function(r){var o=n.t(n.__[0],r);n.__[0]!==o&&(n.__=[o,n.__[1]],n.__c.setState({}))}],n.__c=Me),n.__}function Bt(t,i){var e=Xt(kt++,3);!Z.__s&&yr(e.__H,i)&&(e.__=t,e.__H=i,Me.__H.__h.push(e))}function mr(t,i){var e=Xt(kt++,4);!Z.__s&&yr(e.__H,i)&&(e.__=t,e.__H=i,Me.__h.push(e))}function rt(t){return $t=5,vt(function(){return{current:t}},[])}function Ws(t,i,e){$t=6,mr(function(){typeof t=="function"?t(i()):t&&(t.current=i())},e==null?e:e.concat(t))}function vt(t,i){var e=Xt(kt++,7);return yr(e.__H,i)&&(e.__=t(),e.__H=i,e.__h=t),e.__}function ot(t,i){return $t=8,vt(function(){return t},i)}function _n(t){var i=Me.context[t.__c],e=Xt(kt++,9);return e.c=t,i?(e.__==null&&(e.__=!0,i.sub(Me)),i.props.value):t.__}function Gs(t,i){Z.useDebugValue&&Z.useDebugValue(i?i(t):t)}function vd(t){var i=Xt(kt++,10),e=mt();return i.__=t,Me.componentDidCatch||(Me.componentDidCatch=function(n){i.__&&i.__(n),e[1](n)}),[e[0],function(){e[1](void 0)}]}function yd(){var t;for(fr.sort(function(i,e){return i.__v.__b-e.__v.__b});t=fr.pop();)if(t.__P)try{t.__H.__h.forEach(Qn),t.__H.__h.forEach(vr),t.__H.__h=[]}catch(i){t.__H.__h=[],Z.__e(i,t.__v)}}Z.__b=function(t){Me=null,zs&&zs(t)},Z.__r=function(t){Hs&&Hs(t),kt=0;var i=(Me=t.__c).__H;i&&(i.__h.forEach(Qn),i.__h.forEach(vr),i.__h=[])},Z.diffed=function(t){js&&js(t);var i=t.__c;i&&i.__H&&i.__H.__h.length&&(fr.push(i)!==1&&Ns===Z.requestAnimationFrame||((Ns=Z.requestAnimationFrame)||function(e){var n,r=function(){clearTimeout(o),$s&&cancelAnimationFrame(n),setTimeout(e)},o=setTimeout(r,100);$s&&(n=requestAnimationFrame(r))})(yd)),Me=null},Z.__c=function(t,i){i.some(function(e){try{e.__h.forEach(Qn),e.__h=e.__h.filter(function(n){return!n.__||vr(n)})}catch(n){i.some(function(r){r.__h&&(r.__h=[])}),i=[],Z.__e(n,e.__v)}}),Vs&&Vs(t,i)},Z.unmount=function(t){Us&&Us(t);var i,e=t.__c;e&&e.__H&&(e.__H.__.forEach(function(n){try{Qn(n)}catch(r){i=r}}),i&&Z.__e(i,e.__v))};var $s=typeof requestAnimationFrame=="function";function Qn(t){var i=Me,e=t.__c;typeof e=="function"&&(t.__c=void 0,e()),Me=i}function vr(t){var i=Me;t.__c=t.__(),Me=i}function yr(t,i){return!t||t.length!==i.length||i.some(function(e,n){return e!==t[n]})}function Xs(t,i){return typeof i=="function"?i(t):i}function qs(t,i){for(var e in i)t[e]=i[e];return t}function wr(t,i){for(var e in t)if(e!=="__source"&&!(e in i))return!0;for(var n in i)if(n!=="__source"&&t[n]!==i[n])return!0;return!1}function Cn(t){this.props=t}function Ys(t,i){function e(r){var o=this.props.ref,s=o==r.ref;return!s&&o&&(o.call?o(null):o.current=null),i?!i(this.props,r)||!s:wr(this.props,r)}function n(r){return this.shouldComponentUpdate=e,Oe(t,r)}return n.displayName="Memo("+(t.displayName||t.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(Cn.prototype=new Ae).isPureReactComponent=!0,Cn.prototype.shouldComponentUpdate=function(t,i){return wr(this.props,t)||wr(this.state,i)};var Zs=Z.__b;Z.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Zs&&Zs(t)};var wd=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Er(t){function i(e,n){var r=qs({},e);return delete r.ref,t(r,(n=e.ref||n)&&(typeof n!="object"||"current"in n)?n:null)}return i.$$typeof=wd,i.render=i,i.prototype.isReactComponent=i.__f=!0,i.displayName="ForwardRef("+(t.displayName||t.name)+")",i}var Ks=function(t,i){return t==null?null:gt(gt(t).map(i))},Js={map:Ks,forEach:Ks,count:function(t){return t?gt(t).length:0},only:function(t){var i=gt(t);if(i.length!==1)throw"Children.only";return i[0]},toArray:gt},Ed=Z.__e;Z.__e=function(t,i,e){if(t.then){for(var n,r=i;r=r.__;)if((n=r.__c)&&n.__c)return i.__e==null&&(i.__e=e.__e,i.__k=e.__k),n.__c(t,i)}Ed(t,i,e)};var Qs=Z.unmount;function Tn(){this.__u=0,this.t=null,this.__b=null}function ea(t){var i=t.__.__c;return i&&i.__e&&i.__e(t)}function ta(t){var i,e,n;function r(o){if(i||(i=t()).then(function(s){e=s.default||s},function(s){n=s}),n)throw n;if(!e)throw i;return Oe(e,o)}return r.displayName="Lazy",r.__f=!0,r}function qt(){this.u=null,this.o=null}Z.unmount=function(t){var i=t.__c;i&&i.__R&&i.__R(),i&&t.__h===!0&&(t.type=null),Qs&&Qs(t)},(Tn.prototype=new Ae).__c=function(t,i){var e=i.__c,n=this;n.t==null&&(n.t=[]),n.t.push(e);var r=ea(n.__v),o=!1,s=function(){o||(o=!0,e.__R=null,r?r(a):a())};e.__R=s;var a=function(){if(!--n.__u){if(n.state.__e){var u=n.state.__e;n.__v.__k[0]=function h(d,g,y){return d&&(d.__v=null,d.__k=d.__k&&d.__k.map(function(S){return h(S,g,y)}),d.__c&&d.__c.__P===g&&(d.__e&&y.insertBefore(d.__e,d.__d),d.__c.__e=!0,d.__c.__P=y)),d}(u,u.__c.__P,u.__c.__O)}var c;for(n.setState({__e:n.__b=null});c=n.t.pop();)c.forceUpdate()}},l=i.__h===!0;n.__u++||l||n.setState({__e:n.__b=n.__v.__k[0]}),t.then(s,s)},Tn.prototype.componentWillUnmount=function(){this.t=[]},Tn.prototype.render=function(t,i){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=function o(s,a,l){return s&&(s.__c&&s.__c.__H&&(s.__c.__H.__.forEach(function(u){typeof u.__c=="function"&&u.__c()}),s.__c.__H=null),(s=qs({},s)).__c!=null&&(s.__c.__P===l&&(s.__c.__P=a),s.__c=null),s.__k=s.__k&&s.__k.map(function(u){return o(u,a,l)})),s}(this.__b,e,n.__O=n.__P)}this.__b=null}var r=i.__e&&Oe(et,null,t.fallback);return r&&(r.__h=null),[Oe(et,null,i.__e?null:t.children),r]};var na=function(t,i,e){if(++e[1]===e[0]&&t.o.delete(i),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(e=t.u;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;t.u=e=e[2]}};function bd(t){return this.getChildContext=function(){return t.context},t.children}function xd(t){var i=this,e=t.i;i.componentWillUnmount=function(){xn(null,i.l),i.l=null,i.i=null},i.i&&i.i!==e&&i.componentWillUnmount(),t.__v?(i.l||(i.i=e,i.l={nodeType:1,parentNode:e,childNodes:[],appendChild:function(n){this.childNodes.push(n),i.i.appendChild(n)},insertBefore:function(n,r){this.childNodes.push(n),i.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),i.i.removeChild(n)}}),xn(Oe(bd,{context:i.context},t.__v),i.l)):i.l&&i.componentWillUnmount()}function br(t,i){return Oe(xd,{__v:t,i})}(qt.prototype=new Ae).__e=function(t){var i=this,e=ea(i.__v),n=i.o.get(t);return n[0]++,function(r){var o=function(){i.props.revealOrder?(n.push(r),na(i,t,n)):r()};e?e(o):o()}},qt.prototype.render=function(t){this.u=null,this.o=new Map;var i=gt(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&i.reverse();for(var e=i.length;e--;)this.o.set(i[e],this.u=[1,0,this.u]);return t.children},qt.prototype.componentDidUpdate=qt.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(i,e){na(t,e,i)})};var ia=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Sd=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,_d=typeof document<"u",Cd=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(t)};function ra(t,i,e){return i.__k==null&&(i.textContent=""),xn(t,i),typeof e=="function"&&e(),t?t.__c:null}function oa(t,i,e){return Ls(t,i),typeof e=="function"&&e(),t?t.__c:null}Ae.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Ae.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(i){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:i})}})});var sa=Z.event;function Td(){}function Pd(){return this.cancelBubble}function Ad(){return this.defaultPrevented}Z.event=function(t){return sa&&(t=sa(t)),t.persist=Td,t.isPropagationStopped=Pd,t.isDefaultPrevented=Ad,t.nativeEvent=t};var aa,la={configurable:!0,get:function(){return this.class}},ua=Z.vnode;Z.vnode=function(t){var i=t.type,e=t.props,n=e;if(typeof i=="string"){var r=i.indexOf("-")===-1;for(var o in n={},e){var s=e[o];_d&&o==="children"&&i==="noscript"||o==="value"&&"defaultValue"in e&&s==null||(o==="defaultValue"&&"value"in e&&e.value==null?o="value":o==="download"&&s===!0?s="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+i)&&!Cd(e.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp)/.test(o)?o=o.toLowerCase():r&&Sd.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():s===null&&(s=void 0),n[o]=s)}i=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=gt(e.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),i=="select"&&n.defaultValue!=null&&(n.value=gt(e.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),t.props=n,e.class!=e.className&&(la.enumerable="className"in e,e.className!=null&&(n.class=e.className),Object.defineProperty(n,"className",la))}t.$$typeof=ia,ua&&ua(t)};var ca=Z.__r;Z.__r=function(t){ca&&ca(t),aa=t.__c};var ha={ReactCurrentDispatcher:{current:{readContext:function(t){return aa.__n[t.__c].props.value}}}},Dd="17.0.2";function da(t){return Oe.bind(null,t)}function xr(t){return!!t&&t.$$typeof===ia}function pa(t){return xr(t)?md.apply(null,arguments):t}function fa(t){return!!t.__k&&(xn(null,t),!0)}function ga(t){return t&&(t.base||t.nodeType===1&&t)||null}var ma=function(t,i){return t(i)},va=function(t,i){return t(i)},Od=et,B={useState:mt,useReducer:gr,useEffect:Bt,useLayoutEffect:mr,useRef:rt,useImperativeHandle:Ws,useMemo:vt,useCallback:ot,useContext:_n,useDebugValue:Gs,version:"17.0.2",Children:Js,render:ra,hydrate:oa,unmountComponentAtNode:fa,createPortal:br,createElement:Oe,createContext:Sn,createFactory:da,cloneElement:pa,createRef:hr,Fragment:et,isValidElement:xr,findDOMNode:ga,Component:Ae,PureComponent:Cn,memo:Ys,forwardRef:Er,flushSync:va,unstable_batchedUpdates:ma,StrictMode:et,Suspense:Tn,SuspenseList:qt,lazy:ta,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ha},Sr=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:B,version:Dd,Children:Js,render:ra,hydrate:oa,unmountComponentAtNode:fa,createPortal:br,createFactory:da,cloneElement:pa,isValidElement:xr,findDOMNode:ga,PureComponent:Cn,memo:Ys,forwardRef:Er,flushSync:va,unstable_batchedUpdates:ma,StrictMode:Od,Suspense:Tn,SuspenseList:qt,lazy:ta,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ha,createElement:Oe,createContext:Sn,createRef:hr,Fragment:et,Component:Ae,useState:mt,useReducer:gr,useEffect:Bt,useLayoutEffect:mr,useRef:rt,useImperativeHandle:Ws,useMemo:vt,useCallback:ot,useContext:_n,useDebugValue:Gs,useErrorBoundary:vd}),St=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Es<"u"?Es:typeof self<"u"?self:{};function Rd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function _r(t){if(t.__esModule)return t;var i=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(i,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),i}var Cr={exports:{}};function Tr(){}Tr.prototype={on:function(t,i,e){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:i,ctx:e}),this},once:function(t,i,e){var n=this;function r(){n.off(t,r),i.apply(e,arguments)}return r._=i,this.on(t,r,e)},emit:function(t){var i=[].slice.call(arguments,1),e=((this.e||(this.e={}))[t]||[]).slice(),n=0,r=e.length;for(n;n<r;n++)e[n].fn.apply(e[n].ctx,i);return this},off:function(t,i){var e=this.e||(this.e={}),n=e[t],r=[];if(n&&i)for(var o=0,s=n.length;o<s;o++)n[o].fn!==i&&n[o].fn._!==i&&r.push(n[o]);return r.length?e[t]=r:delete e[t],this}},Cr.exports=Tr,Cr.exports.TinyEmitter=Tr;var ei=Cr.exports,ti={exports:{}},ya={},Yt=_r(Sr),Pn={exports:{}},kd="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Bd=kd,Md=Bd;function wa(){}function Ea(){}Ea.resetWarningCache=wa;var Fd=function(){function t(n,r,o,s,a,l){if(l!==Md){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function i(){return t}var e={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:i,element:t,elementType:t,instanceOf:i,node:t,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:Ea,resetWarningCache:wa};return e.PropTypes=e,e};Pn.exports=Fd();function ba(t){var i,e,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(i=0;i<t.length;i++)t[i]&&(e=ba(t[i]))&&(n&&(n+=" "),n+=e);else for(i in t)t[i]&&(n&&(n+=" "),n+=i);return n}function xa(){for(var t,i,e=0,n="";e<arguments.length;)(t=arguments[e++])&&(i=ba(t))&&(n&&(n+=" "),n+=i);return n}var Id=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",clsx:xa,default:xa}),Ld=_r(Id),_e={},st={};Object.defineProperty(st,"__esModule",{value:!0}),st.dontSetMe=Vd,st.findInArray=Nd,st.int=jd,st.isFunction=zd,st.isNum=Hd;function Nd(t,i){for(var e=0,n=t.length;e<n;e++)if(i.apply(i,[t[e],e,t]))return t[e]}function zd(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Hd(t){return typeof t=="number"&&!isNaN(t)}function jd(t){return parseInt(t,10)}function Vd(t,i,e){if(t[i])return new Error("Invalid prop ".concat(i," passed to ").concat(e," - do not set this, set it on the child."))}var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.browserPrefixToKey=_a,Mt.browserPrefixToStyle=Ud,Mt.default=void 0,Mt.getPrefix=Sa;var Pr=["Moz","Webkit","O","ms"];function Sa(){var t,i,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";var n=(t=window.document)===null||t===void 0||(i=t.documentElement)===null||i===void 0?void 0:i.style;if(!n||e in n)return"";for(var r=0;r<Pr.length;r++)if(_a(e,Pr[r])in n)return Pr[r];return""}function _a(t,i){return i?"".concat(i).concat(Wd(t)):t}function Ud(t,i){return i?"-".concat(i.toLowerCase(),"-").concat(t):t}function Wd(t){for(var i="",e=!0,n=0;n<t.length;n++)e?(i+=t[n].toUpperCase(),e=!1):t[n]==="-"?e=!0:i+=t[n];return i}var Gd=Sa();Mt.default=Gd;function Ar(t){return Ar=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ar(t)}Object.defineProperty(_e,"__esModule",{value:!0}),_e.addClassName=Ra,_e.addEvent=qd,_e.addUserSelectStyles=op,_e.createCSSTransform=tp,_e.createSVGTransform=np,_e.getTouch=ip,_e.getTouchIdentifier=rp,_e.getTranslation=Dr,_e.innerHeight=Jd,_e.innerWidth=Qd,_e.matchesSelector=Oa,_e.matchesSelectorAndParentsTo=Xd,_e.offsetXYFromParent=ep,_e.outerHeight=Zd,_e.outerWidth=Kd,_e.removeClassName=ka,_e.removeEvent=Yd,_e.removeUserSelectStyles=sp;var $e=st,Ca=$d(Mt);function Ta(t){if(typeof WeakMap!="function")return null;var i=new WeakMap,e=new WeakMap;return(Ta=function(n){return n?e:i})(t)}function $d(t,i){if(!i&&t&&t.__esModule)return t;if(t===null||Ar(t)!=="object"&&typeof t!="function")return{default:t};var e=Ta(i);if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function Pa(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,n)}return e}function Aa(t){for(var i=1;i<arguments.length;i++){var e=arguments[i]!=null?arguments[i]:{};i%2?Pa(Object(e),!0).forEach(function(n){Da(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Pa(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Da(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var ni="";function Oa(t,i){return ni||(ni=(0,$e.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(e){return(0,$e.isFunction)(t[e])})),(0,$e.isFunction)(t[ni])?t[ni](i):!1}function Xd(t,i,e){var n=t;do{if(Oa(n,i))return!0;if(n===e)return!1;n=n.parentNode}while(n);return!1}function qd(t,i,e,n){if(t){var r=Aa({capture:!0},n);t.addEventListener?t.addEventListener(i,e,r):t.attachEvent?t.attachEvent("on"+i,e):t["on"+i]=e}}function Yd(t,i,e,n){if(t){var r=Aa({capture:!0},n);t.removeEventListener?t.removeEventListener(i,e,r):t.detachEvent?t.detachEvent("on"+i,e):t["on"+i]=null}}function Zd(t){var i=t.clientHeight,e=t.ownerDocument.defaultView.getComputedStyle(t);return i+=(0,$e.int)(e.borderTopWidth),i+=(0,$e.int)(e.borderBottomWidth),i}function Kd(t){var i=t.clientWidth,e=t.ownerDocument.defaultView.getComputedStyle(t);return i+=(0,$e.int)(e.borderLeftWidth),i+=(0,$e.int)(e.borderRightWidth),i}function Jd(t){var i=t.clientHeight,e=t.ownerDocument.defaultView.getComputedStyle(t);return i-=(0,$e.int)(e.paddingTop),i-=(0,$e.int)(e.paddingBottom),i}function Qd(t){var i=t.clientWidth,e=t.ownerDocument.defaultView.getComputedStyle(t);return i-=(0,$e.int)(e.paddingLeft),i-=(0,$e.int)(e.paddingRight),i}function ep(t,i,e){var n=i===i.ownerDocument.body,r=n?{left:0,top:0}:i.getBoundingClientRect(),o=(t.clientX+i.scrollLeft-r.left)/e,s=(t.clientY+i.scrollTop-r.top)/e;return{x:o,y:s}}function tp(t,i){var e=Dr(t,i,"px");return Da({},(0,Ca.browserPrefixToKey)("transform",Ca.default),e)}function np(t,i){var e=Dr(t,i,"");return e}function Dr(t,i,e){var n=t.x,r=t.y,o="translate(".concat(n).concat(e,",").concat(r).concat(e,")");if(i){var s="".concat(typeof i.x=="string"?i.x:i.x+e),a="".concat(typeof i.y=="string"?i.y:i.y+e);o="translate(".concat(s,", ").concat(a,")")+o}return o}function ip(t,i){return t.targetTouches&&(0,$e.findInArray)(t.targetTouches,function(e){return i===e.identifier})||t.changedTouches&&(0,$e.findInArray)(t.changedTouches,function(e){return i===e.identifier})}function rp(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function op(t){if(t){var i=t.getElementById("react-draggable-style-el");i||(i=t.createElement("style"),i.type="text/css",i.id="react-draggable-style-el",i.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,i.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(i)),t.body&&Ra(t.body,"react-draggable-transparent-selection")}}function sp(t){if(t)try{if(t.body&&ka(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{var i=(t.defaultView||window).getSelection();i&&i.type!=="Caret"&&i.removeAllRanges()}}catch{}}function Ra(t,i){t.classList?t.classList.add(i):t.className.match(new RegExp("(?:^|\\s)".concat(i,"(?!\\S)")))||(t.className+=" ".concat(i))}function ka(t,i){t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(i,"(?!\\S)"),"g"),"")}var at={};Object.defineProperty(at,"__esModule",{value:!0}),at.canDragX=up,at.canDragY=cp,at.createCoreData=dp,at.createDraggableData=pp,at.getBoundPosition=ap,at.getControlPosition=hp,at.snapToGrid=lp;var Xe=st,Zt=_e;function ap(t,i,e){if(!t.props.bounds)return[i,e];var n=t.props.bounds;n=typeof n=="string"?n:fp(n);var r=Or(t);if(typeof n=="string"){var o=r.ownerDocument,s=o.defaultView,a;if(n==="parent"?a=r.parentNode:a=o.querySelector(n),!(a instanceof s.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');var l=a,u=s.getComputedStyle(r),c=s.getComputedStyle(l);n={left:-r.offsetLeft+(0,Xe.int)(c.paddingLeft)+(0,Xe.int)(u.marginLeft),top:-r.offsetTop+(0,Xe.int)(c.paddingTop)+(0,Xe.int)(u.marginTop),right:(0,Zt.innerWidth)(l)-(0,Zt.outerWidth)(r)-r.offsetLeft+(0,Xe.int)(c.paddingRight)-(0,Xe.int)(u.marginRight),bottom:(0,Zt.innerHeight)(l)-(0,Zt.outerHeight)(r)-r.offsetTop+(0,Xe.int)(c.paddingBottom)-(0,Xe.int)(u.marginBottom)}}return(0,Xe.isNum)(n.right)&&(i=Math.min(i,n.right)),(0,Xe.isNum)(n.bottom)&&(e=Math.min(e,n.bottom)),(0,Xe.isNum)(n.left)&&(i=Math.max(i,n.left)),(0,Xe.isNum)(n.top)&&(e=Math.max(e,n.top)),[i,e]}function lp(t,i,e){var n=Math.round(i/t[0])*t[0],r=Math.round(e/t[1])*t[1];return[n,r]}function up(t){return t.props.axis==="both"||t.props.axis==="x"}function cp(t){return t.props.axis==="both"||t.props.axis==="y"}function hp(t,i,e){var n=typeof i=="number"?(0,Zt.getTouch)(t,i):null;if(typeof i=="number"&&!n)return null;var r=Or(e),o=e.props.offsetParent||r.offsetParent||r.ownerDocument.body;return(0,Zt.offsetXYFromParent)(n||t,o,e.props.scale)}function dp(t,i,e){var n=t.state,r=!(0,Xe.isNum)(n.lastX),o=Or(t);return r?{node:o,deltaX:0,deltaY:0,lastX:i,lastY:e,x:i,y:e}:{node:o,deltaX:i-n.lastX,deltaY:e-n.lastY,lastX:n.lastX,lastY:n.lastY,x:i,y:e}}function pp(t,i){var e=t.props.scale;return{node:i.node,x:t.state.x+i.deltaX/e,y:t.state.y+i.deltaY/e,deltaX:i.deltaX/e,deltaY:i.deltaY/e,lastX:t.state.x,lastY:t.state.y}}function fp(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function Or(t){var i=t.findDOMNode();if(!i)throw new Error("<DraggableCore>: Unmounted during event!");return i}var ii={},ri={};Object.defineProperty(ri,"__esModule",{value:!0}),ri.default=gp;function gp(){}function oi(t){return oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},oi(t)}Object.defineProperty(ii,"__esModule",{value:!0}),ii.default=void 0;var Rr=vp(Yt),qe=Br(Pn.exports),mp=Br(Yt),He=_e,_t=at,kr=st,An=Br(ri);function Br(t){return t&&t.__esModule?t:{default:t}}function Ba(t){if(typeof WeakMap!="function")return null;var i=new WeakMap,e=new WeakMap;return(Ba=function(n){return n?e:i})(t)}function vp(t,i){if(!i&&t&&t.__esModule)return t;if(t===null||oi(t)!=="object"&&typeof t!="function")return{default:t};var e=Ba(i);if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function Ma(t,i){return bp(t)||Ep(t,i)||wp(t,i)||yp()}function yp(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wp(t,i){if(t){if(typeof t=="string")return Fa(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Fa(t,i)}}function Fa(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,n=new Array(i);e<i;e++)n[e]=t[e];return n}function Ep(t,i){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],r=!0,o=!1,s,a;try{for(e=e.call(t);!(r=(s=e.next()).done)&&(n.push(s.value),!(i&&n.length===i));r=!0);}catch(l){o=!0,a=l}finally{try{!r&&e.return!=null&&e.return()}finally{if(o)throw a}}return n}}function bp(t){if(Array.isArray(t))return t}function xp(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Ia(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sp(t,i,e){return i&&Ia(t.prototype,i),e&&Ia(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _p(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Mr(t,i)}function Mr(t,i){return Mr=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},Mr(t,i)}function Cp(t){var i=Pp();return function(){var e=si(t),n;if(i){var r=si(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return Tp(this,n)}}function Tp(t,i){if(i&&(oi(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return je(t)}function je(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pp(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function si(t){return si=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},si(t)}function tt(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var it={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},Ct=it.mouse,ai=function(t){_p(e,t);var i=Cp(e);function e(){var n;xp(this,e);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return n=i.call.apply(i,[this].concat(o)),tt(je(n),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),tt(je(n),"mounted",!1),tt(je(n),"handleDragStart",function(a){if(n.props.onMouseDown(a),!n.props.allowAnyClick&&typeof a.button=="number"&&a.button!==0)return!1;var l=n.findDOMNode();if(!l||!l.ownerDocument||!l.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var u=l.ownerDocument;if(!(n.props.disabled||!(a.target instanceof u.defaultView.Node)||n.props.handle&&!(0,He.matchesSelectorAndParentsTo)(a.target,n.props.handle,l)||n.props.cancel&&(0,He.matchesSelectorAndParentsTo)(a.target,n.props.cancel,l))){a.type==="touchstart"&&a.preventDefault();var c=(0,He.getTouchIdentifier)(a);n.setState({touchIdentifier:c});var h=(0,_t.getControlPosition)(a,c,je(n));if(h!=null){var d=h.x,g=h.y,y=(0,_t.createCoreData)(je(n),d,g);(0,An.default)("DraggableCore: handleDragStart: %j",y),(0,An.default)("calling",n.props.onStart);var S=n.props.onStart(a,y);S===!1||n.mounted===!1||(n.props.enableUserSelectHack&&(0,He.addUserSelectStyles)(u),n.setState({dragging:!0,lastX:d,lastY:g}),(0,He.addEvent)(u,Ct.move,n.handleDrag),(0,He.addEvent)(u,Ct.stop,n.handleDragStop))}}}),tt(je(n),"handleDrag",function(a){var l=(0,_t.getControlPosition)(a,n.state.touchIdentifier,je(n));if(l!=null){var u=l.x,c=l.y;if(Array.isArray(n.props.grid)){var h=u-n.state.lastX,d=c-n.state.lastY,g=(0,_t.snapToGrid)(n.props.grid,h,d),y=Ma(g,2);if(h=y[0],d=y[1],!h&&!d)return;u=n.state.lastX+h,c=n.state.lastY+d}var S=(0,_t.createCoreData)(je(n),u,c);(0,An.default)("DraggableCore: handleDrag: %j",S);var E=n.props.onDrag(a,S);if(E===!1||n.mounted===!1){try{n.handleDragStop(new MouseEvent("mouseup"))}catch{var C=document.createEvent("MouseEvents");C.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.handleDragStop(C)}return}n.setState({lastX:u,lastY:c})}}),tt(je(n),"handleDragStop",function(a){if(n.state.dragging){var l=(0,_t.getControlPosition)(a,n.state.touchIdentifier,je(n));if(l!=null){var u=l.x,c=l.y;if(Array.isArray(n.props.grid)){var h=u-n.state.lastX||0,d=c-n.state.lastY||0,g=(0,_t.snapToGrid)(n.props.grid,h,d),y=Ma(g,2);h=y[0],d=y[1],u=n.state.lastX+h,c=n.state.lastY+d}var S=(0,_t.createCoreData)(je(n),u,c),E=n.props.onStop(a,S);if(E===!1||n.mounted===!1)return!1;var C=n.findDOMNode();C&&n.props.enableUserSelectHack&&(0,He.removeUserSelectStyles)(C.ownerDocument),(0,An.default)("DraggableCore: handleDragStop: %j",S),n.setState({dragging:!1,lastX:NaN,lastY:NaN}),C&&((0,An.default)("DraggableCore: Removing handlers"),(0,He.removeEvent)(C.ownerDocument,Ct.move,n.handleDrag),(0,He.removeEvent)(C.ownerDocument,Ct.stop,n.handleDragStop))}}}),tt(je(n),"onMouseDown",function(a){return Ct=it.mouse,n.handleDragStart(a)}),tt(je(n),"onMouseUp",function(a){return Ct=it.mouse,n.handleDragStop(a)}),tt(je(n),"onTouchStart",function(a){return Ct=it.touch,n.handleDragStart(a)}),tt(je(n),"onTouchEnd",function(a){return Ct=it.touch,n.handleDragStop(a)}),n}return Sp(e,[{key:"componentDidMount",value:function(){this.mounted=!0;var n=this.findDOMNode();n&&(0,He.addEvent)(n,it.touch.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var n=this.findDOMNode();if(n){var r=n.ownerDocument;(0,He.removeEvent)(r,it.mouse.move,this.handleDrag),(0,He.removeEvent)(r,it.touch.move,this.handleDrag),(0,He.removeEvent)(r,it.mouse.stop,this.handleDragStop),(0,He.removeEvent)(r,it.touch.stop,this.handleDragStop),(0,He.removeEvent)(n,it.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,He.removeUserSelectStyles)(r)}}},{key:"findDOMNode",value:function(){var n,r,o;return(n=this.props)!==null&&n!==void 0&&n.nodeRef?(r=this.props)===null||r===void 0||(o=r.nodeRef)===null||o===void 0?void 0:o.current:mp.default.findDOMNode(this)}},{key:"render",value:function(){return Rr.cloneElement(Rr.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}]),e}(Rr.Component);ii.default=ai,tt(ai,"displayName","DraggableCore"),tt(ai,"propTypes",{allowAnyClick:qe.default.bool,disabled:qe.default.bool,enableUserSelectHack:qe.default.bool,offsetParent:function(t,i){if(t[i]&&t[i].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:qe.default.arrayOf(qe.default.number),handle:qe.default.string,cancel:qe.default.string,nodeRef:qe.default.object,onStart:qe.default.func,onDrag:qe.default.func,onStop:qe.default.func,onMouseDown:qe.default.func,scale:qe.default.number,className:kr.dontSetMe,style:kr.dontSetMe,transform:kr.dontSetMe}),tt(ai,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),function(t){function i(M){return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},i(M)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var e=y(Yt),n=d(Pn.exports),r=d(Yt),o=d(Ld),s=_e,a=at,l=st,u=d(ii),c=d(ri),h=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function d(M){return M&&M.__esModule?M:{default:M}}function g(M){if(typeof WeakMap!="function")return null;var H=new WeakMap,V=new WeakMap;return(g=function(j){return j?V:H})(M)}function y(M,H){if(!H&&M&&M.__esModule)return M;if(M===null||i(M)!=="object"&&typeof M!="function")return{default:M};var V=g(H);if(V&&V.has(M))return V.get(M);var j={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in M)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(M,Q)){var ye=U?Object.getOwnPropertyDescriptor(M,Q):null;ye&&(ye.get||ye.set)?Object.defineProperty(j,Q,ye):j[Q]=M[Q]}return j.default=M,V&&V.set(M,j),j}function S(){return S=Object.assign||function(M){for(var H=1;H<arguments.length;H++){var V=arguments[H];for(var j in V)Object.prototype.hasOwnProperty.call(V,j)&&(M[j]=V[j])}return M},S.apply(this,arguments)}function E(M,H){if(M==null)return{};var V=C(M,H),j,U;if(Object.getOwnPropertySymbols){var Q=Object.getOwnPropertySymbols(M);for(U=0;U<Q.length;U++)j=Q[U],!(H.indexOf(j)>=0)&&(!Object.prototype.propertyIsEnumerable.call(M,j)||(V[j]=M[j]))}return V}function C(M,H){if(M==null)return{};var V={},j=Object.keys(M),U,Q;for(Q=0;Q<j.length;Q++)U=j[Q],!(H.indexOf(U)>=0)&&(V[U]=M[U]);return V}function p(M,H){var V=Object.keys(M);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(M);H&&(j=j.filter(function(U){return Object.getOwnPropertyDescriptor(M,U).enumerable})),V.push.apply(V,j)}return V}function x(M){for(var H=1;H<arguments.length;H++){var V=arguments[H]!=null?arguments[H]:{};H%2?p(Object(V),!0).forEach(function(j){$(M,j,V[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(V)):p(Object(V)).forEach(function(j){Object.defineProperty(M,j,Object.getOwnPropertyDescriptor(V,j))})}return M}function A(M,H){return N(M)||I(M,H)||D(M,H)||P()}function P(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D(M,H){if(M){if(typeof M=="string")return O(M,H);var V=Object.prototype.toString.call(M).slice(8,-1);if(V==="Object"&&M.constructor&&(V=M.constructor.name),V==="Map"||V==="Set")return Array.from(M);if(V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V))return O(M,H)}}function O(M,H){(H==null||H>M.length)&&(H=M.length);for(var V=0,j=new Array(H);V<H;V++)j[V]=M[V];return j}function I(M,H){var V=M==null?null:typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(V!=null){var j=[],U=!0,Q=!1,ye,Se;try{for(V=V.call(M);!(U=(ye=V.next()).done)&&(j.push(ye.value),!(H&&j.length===H));U=!0);}catch(de){Q=!0,Se=de}finally{try{!U&&V.return!=null&&V.return()}finally{if(Q)throw Se}}return j}}function N(M){if(Array.isArray(M))return M}function W(M,H){if(!(M instanceof H))throw new TypeError("Cannot call a class as a function")}function q(M,H){for(var V=0;V<H.length;V++){var j=H[V];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(M,j.key,j)}}function G(M,H,V){return H&&q(M.prototype,H),V&&q(M,V),Object.defineProperty(M,"prototype",{writable:!1}),M}function J(M,H){if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(H&&H.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),Object.defineProperty(M,"prototype",{writable:!1}),H&&K(M,H)}function K(M,H){return K=Object.setPrototypeOf||function(V,j){return V.__proto__=j,V},K(M,H)}function oe(M){var H=pe();return function(){var V=Ee(M),j;if(H){var U=Ee(this).constructor;j=Reflect.construct(V,arguments,U)}else j=V.apply(this,arguments);return re(this,j)}}function re(M,H){if(H&&(i(H)==="object"||typeof H=="function"))return H;if(H!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ae(M)}function ae(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function pe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ee(M){return Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(H){return H.__proto__||Object.getPrototypeOf(H)},Ee(M)}function $(M,H,V){return H in M?Object.defineProperty(M,H,{value:V,enumerable:!0,configurable:!0,writable:!0}):M[H]=V,M}var le=function(M){J(V,M);var H=oe(V);function V(j){var U;return W(this,V),U=H.call(this,j),$(ae(U),"onDragStart",function(Q,ye){(0,c.default)("Draggable: onDragStart: %j",ye);var Se=U.props.onStart(Q,(0,a.createDraggableData)(ae(U),ye));if(Se===!1)return!1;U.setState({dragging:!0,dragged:!0})}),$(ae(U),"onDrag",function(Q,ye){if(!U.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",ye);var Se=(0,a.createDraggableData)(ae(U),ye),de={x:Se.x,y:Se.y};if(U.props.bounds){var nt=de.x,Ge=de.y;de.x+=U.state.slackX,de.y+=U.state.slackY;var Je=(0,a.getBoundPosition)(ae(U),de.x,de.y),f=A(Je,2),_=f[0],R=f[1];de.x=_,de.y=R,de.slackX=U.state.slackX+(nt-de.x),de.slackY=U.state.slackY+(Ge-de.y),Se.x=de.x,Se.y=de.y,Se.deltaX=de.x-U.state.x,Se.deltaY=de.y-U.state.y}var L=U.props.onDrag(Q,Se);if(L===!1)return!1;U.setState(de)}),$(ae(U),"onDragStop",function(Q,ye){if(!U.state.dragging)return!1;var Se=U.props.onStop(Q,(0,a.createDraggableData)(ae(U),ye));if(Se===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",ye);var de={dragging:!1,slackX:0,slackY:0},nt=!!U.props.position;if(nt){var Ge=U.props.position,Je=Ge.x,f=Ge.y;de.x=Je,de.y=f}U.setState(de)}),U.state={dragging:!1,dragged:!1,x:j.position?j.position.x:j.defaultPosition.x,y:j.position?j.position.y:j.defaultPosition.y,prevPropsPosition:x({},j.position),slackX:0,slackY:0,isElementSVG:!1},j.position&&!(j.onDrag||j.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),U}return G(V,[{key:"componentDidMount",value:function(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var j,U,Q;return(j=(U=this.props)===null||U===void 0||(Q=U.nodeRef)===null||Q===void 0?void 0:Q.current)!==null&&j!==void 0?j:r.default.findDOMNode(this)}},{key:"render",value:function(){var j,U=this.props;U.axis,U.bounds;var Q=U.children,ye=U.defaultPosition,Se=U.defaultClassName,de=U.defaultClassNameDragging,nt=U.defaultClassNameDragged,Ge=U.position,Je=U.positionOffset;U.scale;var f=E(U,h),_={},R=null,L=!!Ge,F=!L||this.state.dragging,Y=Ge||ye,X={x:(0,a.canDragX)(this)&&F?this.state.x:Y.x,y:(0,a.canDragY)(this)&&F?this.state.y:Y.y};this.state.isElementSVG?R=(0,s.createSVGTransform)(X,Je):_=(0,s.createCSSTransform)(X,Je);var fe=(0,o.default)(Q.props.className||"",Se,(j={},$(j,de,this.state.dragging),$(j,nt,this.state.dragged),j));return e.createElement(u.default,S({},f,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(Q),{className:fe,style:x(x({},Q.props.style),_),transform:R}))}}],[{key:"getDerivedStateFromProps",value:function(j,U){var Q=j.position,ye=U.prevPropsPosition;return Q&&(!ye||Q.x!==ye.x||Q.y!==ye.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:Q,prevPropsPosition:ye}),{x:Q.x,y:Q.y,prevPropsPosition:x({},Q)}):null}}]),V}(e.Component);t.default=le,$(le,"displayName","Draggable"),$(le,"propTypes",x(x({},u.default.propTypes),{},{axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe})),$(le,"defaultProps",x(x({},u.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))}(ya);var La=ya,Na=La.default,Ap=La.DraggableCore;ti.exports=Na,ti.exports.default=Na,ti.exports.DraggableCore=Ap;var Dp=ti.exports,Op=["second","minute","hour","day","week","month","year"];function Rp(t,i){if(i===0)return["just now","right now"];var e=Op[Math.floor(i/2)];return t>1&&(e+="s"),[t+" "+e+" ago","in "+t+" "+e]}var kp=["","","","","","",""];function Bp(t,i){if(i===0)return["",""];var e=kp[~~(i/2)];return[t+" "+e+"",t+" "+e+""]}var Fr={},Ce=function(t,i){Fr[t]=i},za=function(t){return Fr[t]||Fr.en_US},Ft=[60,60,24,7,365/7/12,12];function Ha(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function ja(t,i){var e=t<0?1:0;t=Math.abs(t);for(var n=t,r=0;t>=Ft[r]&&r<Ft.length;r++)t/=Ft[r];return t=Math.floor(t),r*=2,t>(r===0?9:1)&&(r+=1),i(t,r,n)[e].replace("%s",t.toString())}function Va(t,i){var e=i?Ha(i):new Date;return(+e-+Ha(t))/1e3}function Mp(t){for(var i=1,e=0,n=Math.abs(t);t>=Ft[e]&&e<Ft.length;e++)t/=Ft[e],i*=Ft[e];return n=n%i,n=n?i-n:i,Math.ceil(n)}var Fp=function(t,i,e){var n=Va(t,e&&e.relativeDate);return ja(n,za(i))},Ua="timeago-id";function Ip(t){return t.getAttribute("datetime")}function Lp(t,i){t.setAttribute(Ua,i)}function Wa(t){return parseInt(t.getAttribute(Ua))}var Ir={},Lr=function(t){clearTimeout(t),delete Ir[t]};function Ga(t,i,e,n){Lr(Wa(t));var r=n.relativeDate,o=n.minInterval,s=Va(i,r);t.innerText=ja(s,e);var a=setTimeout(function(){Ga(t,i,e,n)},Math.min(Math.max(Mp(s),o||1)*1e3,2147483647));Ir[a]=0,Lp(t,a)}function $a(t){t?Lr(Wa(t)):Object.keys(Ir).forEach(Lr)}function Np(t,i,e){var n=t.length?t:[t];return n.forEach(function(r){Ga(r,Ip(r),za(i),e||{})}),n}Ce("en_US",Rp),Ce("zh_CN",Bp);var zp=globalThis&&globalThis.__extends||function(){var t=function(i,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},t(i,e)};return function(i,e){t(i,e);function n(){this.constructor=i}i.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Nr=globalThis&&globalThis.__assign||function(){return Nr=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++){i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Nr.apply(this,arguments)},Hp=globalThis&&globalThis.__rest||function(t,i){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)i.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(e[n[r]]=t[n[r]]);return e},jp=function(t){return""+(t instanceof Date?t.getTime():t)},Vp=function(t){zp(i,t);function i(){var e=t!==null&&t.apply(this,arguments)||this;return e.dom=null,e}return i.prototype.componentDidMount=function(){this.renderTimeAgo()},i.prototype.componentDidUpdate=function(){this.renderTimeAgo()},i.prototype.renderTimeAgo=function(){var e=this.props,n=e.live,r=e.datetime,o=e.locale,s=e.opts;$a(this.dom),n!==!1&&(this.dom.setAttribute("datetime",jp(r)),Np(this.dom,o,s))},i.prototype.componentWillUnmount=function(){$a(this.dom)},i.prototype.render=function(){var e=this,n=this.props,r=n.datetime;n.live;var o=n.locale,s=n.opts,a=Hp(n,["datetime","live","locale","opts"]);return Oe("time",Nr({ref:function(l){e.dom=l}},a),Fp(r,o,s))},i.defaultProps={live:!0,className:""},i}(Cn);function Up(t,i){const e=n=>{t.current&&!t.current.contains(event.target)&&i()};Bt(()=>(document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)))}var Xa=Object.prototype.toString,qa=function(t){var i=Xa.call(t),e=i==="[object Arguments]";return e||(e=i!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&Xa.call(t.callee)==="[object Function]"),e},Ya;if(!Object.keys){var li=Object.prototype.hasOwnProperty,Za=Object.prototype.toString,Wp=qa,Ka=Object.prototype.propertyIsEnumerable,Gp=!Ka.call({toString:null},"toString"),$p=Ka.call(function(){},"prototype"),ui=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],zr=function(t){var i=t.constructor;return i&&i.prototype===t},Xp={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},qp=function(){if(typeof window>"u")return!1;for(var t in window)try{if(!Xp["$"+t]&&li.call(window,t)&&window[t]!==null&&typeof window[t]=="object")try{zr(window[t])}catch{return!0}}catch{return!0}return!1}(),Yp=function(t){if(typeof window>"u"||!qp)return zr(t);try{return zr(t)}catch{return!1}};Ya=function(t){var i=t!==null&&typeof t=="object",e=Za.call(t)==="[object Function]",n=Wp(t),r=i&&Za.call(t)==="[object String]",o=[];if(!i&&!e&&!n)throw new TypeError("Object.keys called on a non-object");var s=$p&&e;if(r&&t.length>0&&!li.call(t,0))for(var a=0;a<t.length;++a)o.push(String(a));if(n&&t.length>0)for(var l=0;l<t.length;++l)o.push(String(l));else for(var u in t)!(s&&u==="prototype")&&li.call(t,u)&&o.push(String(u));if(Gp)for(var c=Yp(t),h=0;h<ui.length;++h)!(c&&ui[h]==="constructor")&&li.call(t,ui[h])&&o.push(ui[h]);return o}}var Zp=Ya,Kp=Array.prototype.slice,Jp=qa,Ja=Object.keys,ci=Ja?function(t){return Ja(t)}:Zp,Qa=Object.keys;ci.shim=function(){if(Object.keys){var t=function(){var i=Object.keys(arguments);return i&&i.length===arguments.length}(1,2);t||(Object.keys=function(i){return Jp(i)?Qa(Kp.call(i)):Qa(i)})}else Object.keys=ci;return Object.keys||ci};var Qp=ci,el=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},i=Symbol("test"),e=Object(i);if(typeof i=="string"||Object.prototype.toString.call(i)!=="[object Symbol]"||Object.prototype.toString.call(e)!=="[object Symbol]")return!1;var n=42;t[i]=n;for(i in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var r=Object.getOwnPropertySymbols(t);if(r.length!==1||r[0]!==i||!Object.prototype.propertyIsEnumerable.call(t,i))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,i);if(o.value!==n||o.enumerable!==!0)return!1}return!0},tl=typeof Symbol<"u"&&Symbol,ef=el,nl=function(){return typeof tl!="function"||typeof Symbol!="function"||typeof tl("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:ef()},il={foo:{}},tf=Object,nf=function(){return{__proto__:il}.foo===il.foo&&!({__proto__:null}instanceof tf)},rf="Function.prototype.bind called on incompatible ",Hr=Array.prototype.slice,of=Object.prototype.toString,sf="[object Function]",af=function(t){var i=this;if(typeof i!="function"||of.call(i)!==sf)throw new TypeError(rf+i);for(var e=Hr.call(arguments,1),n,r=function(){if(this instanceof n){var u=i.apply(this,e.concat(Hr.call(arguments)));return Object(u)===u?u:this}else return i.apply(t,e.concat(Hr.call(arguments)))},o=Math.max(0,i.length-e.length),s=[],a=0;a<o;a++)s.push("$"+a);if(n=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(r),i.prototype){var l=function(){};l.prototype=i.prototype,n.prototype=new l,l.prototype=null}return n},lf=af,jr=Function.prototype.bind||lf,uf=jr,rl=uf.call(Function.call,Object.prototype.hasOwnProperty),ue,Kt=SyntaxError,ol=Function,Jt=TypeError,Vr=function(t){try{return ol('"use strict"; return ('+t+").constructor;")()}catch{}},It=Object.getOwnPropertyDescriptor;if(It)try{It({},"")}catch{It=null}var Ur=function(){throw new Jt},cf=It?function(){try{return arguments.callee,Ur}catch{try{return It(arguments,"callee").get}catch{return Ur}}}():Ur,Qt=nl(),hf=nf(),Re=Object.getPrototypeOf||(hf?function(t){return t.__proto__}:null),en={},df=typeof Uint8Array>"u"||!Re?ue:Re(Uint8Array),Lt={"%AggregateError%":typeof AggregateError>"u"?ue:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ue:ArrayBuffer,"%ArrayIteratorPrototype%":Qt&&Re?Re([][Symbol.iterator]()):ue,"%AsyncFromSyncIteratorPrototype%":ue,"%AsyncFunction%":en,"%AsyncGenerator%":en,"%AsyncGeneratorFunction%":en,"%AsyncIteratorPrototype%":en,"%Atomics%":typeof Atomics>"u"?ue:Atomics,"%BigInt%":typeof BigInt>"u"?ue:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ue:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ue:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ue:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?ue:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ue:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ue:FinalizationRegistry,"%Function%":ol,"%GeneratorFunction%":en,"%Int8Array%":typeof Int8Array>"u"?ue:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ue:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ue:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Qt&&Re?Re(Re([][Symbol.iterator]())):ue,"%JSON%":typeof JSON=="object"?JSON:ue,"%Map%":typeof Map>"u"?ue:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Qt||!Re?ue:Re(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ue:Promise,"%Proxy%":typeof Proxy>"u"?ue:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?ue:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ue:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Qt||!Re?ue:Re(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ue:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Qt&&Re?Re(""[Symbol.iterator]()):ue,"%Symbol%":Qt?Symbol:ue,"%SyntaxError%":Kt,"%ThrowTypeError%":cf,"%TypedArray%":df,"%TypeError%":Jt,"%Uint8Array%":typeof Uint8Array>"u"?ue:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ue:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ue:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ue:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?ue:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ue:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ue:WeakSet};if(Re)try{null.error}catch(t){var pf=Re(Re(t));Lt["%Error.prototype%"]=pf}var ff=function t(i){var e;if(i==="%AsyncFunction%")e=Vr("async function () {}");else if(i==="%GeneratorFunction%")e=Vr("function* () {}");else if(i==="%AsyncGeneratorFunction%")e=Vr("async function* () {}");else if(i==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(i==="%AsyncIteratorPrototype%"){var r=t("%AsyncGenerator%");r&&Re&&(e=Re(r.prototype))}return Lt[i]=e,e},sl={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Dn=jr,hi=rl,gf=Dn.call(Function.call,Array.prototype.concat),mf=Dn.call(Function.apply,Array.prototype.splice),al=Dn.call(Function.call,String.prototype.replace),di=Dn.call(Function.call,String.prototype.slice),vf=Dn.call(Function.call,RegExp.prototype.exec),yf=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,wf=/\\(\\)?/g,Ef=function(t){var i=di(t,0,1),e=di(t,-1);if(i==="%"&&e!=="%")throw new Kt("invalid intrinsic syntax, expected closing `%`");if(e==="%"&&i!=="%")throw new Kt("invalid intrinsic syntax, expected opening `%`");var n=[];return al(t,yf,function(r,o,s,a){n[n.length]=s?al(a,wf,"$1"):o||r}),n},bf=function(t,i){var e=t,n;if(hi(sl,e)&&(n=sl[e],e="%"+n[0]+"%"),hi(Lt,e)){var r=Lt[e];if(r===en&&(r=ff(e)),typeof r>"u"&&!i)throw new Jt("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:e,value:r}}throw new Kt("intrinsic "+t+" does not exist!")},Fe=function(t,i){if(typeof t!="string"||t.length===0)throw new Jt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof i!="boolean")throw new Jt('"allowMissing" argument must be a boolean');if(vf(/^%?[^%]*%?$/,t)===null)throw new Kt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var e=Ef(t),n=e.length>0?e[0]:"",r=bf("%"+n+"%",i),o=r.name,s=r.value,a=!1,l=r.alias;l&&(n=l[0],mf(e,gf([0,1],l)));for(var u=1,c=!0;u<e.length;u+=1){var h=e[u],d=di(h,0,1),g=di(h,-1);if((d==='"'||d==="'"||d==="`"||g==='"'||g==="'"||g==="`")&&d!==g)throw new Kt("property names with quotes must have matching quotes");if((h==="constructor"||!c)&&(a=!0),n+="."+h,o="%"+n+"%",hi(Lt,o))s=Lt[o];else if(s!=null){if(!(h in s)){if(!i)throw new Jt("base intrinsic for "+t+" exists, but the property is not available.");return}if(It&&u+1>=e.length){var y=It(s,h);c=!!y,c&&"get"in y&&!("originalValue"in y.get)?s=y.get:s=s[h]}else c=hi(s,h),s=s[h];c&&!a&&(Lt[o]=s)}}return s},xf=Fe,Wr=xf("%Object.defineProperty%",!0),Gr=function(){if(Wr)try{return Wr({},"a",{value:1}),!0}catch{return!1}return!1};Gr.hasArrayLengthDefineBug=function(){if(!Gr())return null;try{return Wr([],"length",{value:1}).length!==1}catch{return!0}};var Sf=Gr,_f=Qp,Cf=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Tf=Object.prototype.toString,Pf=Array.prototype.concat,ll=Object.defineProperty,Af=function(t){return typeof t=="function"&&Tf.call(t)==="[object Function]"},Df=Sf(),ul=ll&&Df,Of=function(t,i,e,n){if(i in t){if(n===!0){if(t[i]===e)return}else if(!Af(n)||!n())return}ul?ll(t,i,{configurable:!0,enumerable:!1,value:e,writable:!0}):t[i]=e},cl=function(t,i){var e=arguments.length>2?arguments[2]:{},n=_f(i);Cf&&(n=Pf.call(n,Object.getOwnPropertySymbols(i)));for(var r=0;r<n.length;r+=1)Of(t,n[r],i[n[r]],e[n[r]])};cl.supportsDescriptors=!!ul;var tn=cl,On={exports:{}};(function(t){var i=jr,e=Fe,n=e("%Function.prototype.apply%"),r=e("%Function.prototype.call%"),o=e("%Reflect.apply%",!0)||i.call(r,n),s=e("%Object.getOwnPropertyDescriptor%",!0),a=e("%Object.defineProperty%",!0),l=e("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(c){var h=o(i,r,arguments);if(s&&a){var d=s(h,"length");d.configurable&&a(h,"length",{value:1+l(0,c.length-(arguments.length-1))})}return h};var u=function(){return o(i,n,arguments)};a?a(t.exports,"apply",{value:u}):t.exports.apply=u})(On);var hl=Fe,dl=On.exports,Rf=dl(hl("String.prototype.indexOf")),yt=function(t,i){var e=hl(t,!!i);return typeof e=="function"&&Rf(t,".prototype.")>-1?dl(e):e},kf=Fe,Bf=kf("%TypeError%"),Mf=function(t,i){if(t==null)throw new Bf(i||"Cannot call method on "+t);return t},Rn=Mf,Ff=Fe,pl=Ff("%Array%"),If=!pl.isArray&&yt("Object.prototype.toString"),Lf=pl.isArray||function(t){return If(t)==="[object Array]"},Nf=Lf,fl=Fe,zf=yt,Hf=fl("%TypeError%"),jf=Nf,Vf=fl("%Reflect.apply%",!0)||zf("Function.prototype.apply"),Uf=function(t,i){var e=arguments.length>2?arguments[2]:[];if(!jf(e))throw new Hf("Assertion failed: optional `argumentsList`, if provided, must be a List");return Vf(t,i,e)},Wf={},Gf=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Wf}),$f=_r(Gf),$r=typeof Map=="function"&&Map.prototype,Xr=Object.getOwnPropertyDescriptor&&$r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,pi=$r&&Xr&&typeof Xr.get=="function"?Xr.get:null,gl=$r&&Map.prototype.forEach,qr=typeof Set=="function"&&Set.prototype,Yr=Object.getOwnPropertyDescriptor&&qr?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,fi=qr&&Yr&&typeof Yr.get=="function"?Yr.get:null,ml=qr&&Set.prototype.forEach,Xf=typeof WeakMap=="function"&&WeakMap.prototype,kn=Xf?WeakMap.prototype.has:null,qf=typeof WeakSet=="function"&&WeakSet.prototype,Bn=qf?WeakSet.prototype.has:null,Yf=typeof WeakRef=="function"&&WeakRef.prototype,vl=Yf?WeakRef.prototype.deref:null,Zf=Boolean.prototype.valueOf,Kf=Object.prototype.toString,Jf=Function.prototype.toString,Qf=String.prototype.match,Zr=String.prototype.slice,Tt=String.prototype.replace,eg=String.prototype.toUpperCase,yl=String.prototype.toLowerCase,wl=RegExp.prototype.test,El=Array.prototype.concat,lt=Array.prototype.join,tg=Array.prototype.slice,bl=Math.floor,Kr=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Jr=Object.getOwnPropertySymbols,Qr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,nn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ve=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===nn||"symbol")?Symbol.toStringTag:null,xl=Object.prototype.propertyIsEnumerable,Sl=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function _l(t,i){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||wl.call(/e/,i))return i;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-bl(-t):bl(t);if(n!==t){var r=String(n),o=Zr.call(i,r.length+1);return Tt.call(r,e,"$&_")+"."+Tt.call(Tt.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Tt.call(i,e,"$&_")}var eo=$f,Cl=eo.custom,Tl=Dl(Cl)?Cl:null,ng=function t(i,e,n,r){var o=e||{};if(Pt(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Pt(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=Pt(o,"customInspect")?o.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Pt(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Pt(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=o.numericSeparator;if(typeof i>"u")return"undefined";if(i===null)return"null";if(typeof i=="boolean")return i?"true":"false";if(typeof i=="string")return Rl(i,o);if(typeof i=="number"){if(i===0)return 1/0/i>0?"0":"-0";var l=String(i);return a?_l(i,l):l}if(typeof i=="bigint"){var u=String(i)+"n";return a?_l(i,u):u}var c=typeof o.depth>"u"?5:o.depth;if(typeof n>"u"&&(n=0),n>=c&&c>0&&typeof i=="object")return to(i)?"[Array]":"[Object]";var h=Eg(o,n);if(typeof r>"u")r=[];else if(Ol(r,i)>=0)return"[Circular]";function d(J,K,oe){if(K&&(r=tg.call(r),r.push(K)),oe){var re={depth:o.depth};return Pt(o,"quoteStyle")&&(re.quoteStyle=o.quoteStyle),t(J,re,n+1,r)}return t(J,o,n+1,r)}if(typeof i=="function"&&!Al(i)){var g=hg(i),y=gi(i,d);return"[Function"+(g?": "+g:" (anonymous)")+"]"+(y.length>0?" { "+lt.call(y,", ")+" }":"")}if(Dl(i)){var S=nn?Tt.call(String(i),/^(Symbol\(.*\))_[^)]*$/,"$1"):Qr.call(i);return typeof i=="object"&&!nn?Mn(S):S}if(vg(i)){for(var E="<"+yl.call(String(i.nodeName)),C=i.attributes||[],p=0;p<C.length;p++)E+=" "+C[p].name+"="+Pl(ig(C[p].value),"double",o);return E+=">",i.childNodes&&i.childNodes.length&&(E+="..."),E+="</"+yl.call(String(i.nodeName))+">",E}if(to(i)){if(i.length===0)return"[]";var x=gi(i,d);return h&&!wg(x)?"["+io(x,h)+"]":"[ "+lt.call(x,", ")+" ]"}if(og(i)){var A=gi(i,d);return!("cause"in Error.prototype)&&"cause"in i&&!xl.call(i,"cause")?"{ ["+String(i)+"] "+lt.call(El.call("[cause]: "+d(i.cause),A),", ")+" }":A.length===0?"["+String(i)+"]":"{ ["+String(i)+"] "+lt.call(A,", ")+" }"}if(typeof i=="object"&&s){if(Tl&&typeof i[Tl]=="function"&&eo)return eo(i,{depth:c-n});if(s!=="symbol"&&typeof i.inspect=="function")return i.inspect()}if(dg(i)){var P=[];return gl&&gl.call(i,function(J,K){P.push(d(K,i,!0)+" => "+d(J,i))}),kl("Map",pi.call(i),P,h)}if(gg(i)){var D=[];return ml&&ml.call(i,function(J){D.push(d(J,i))}),kl("Set",fi.call(i),D,h)}if(pg(i))return no("WeakMap");if(mg(i))return no("WeakSet");if(fg(i))return no("WeakRef");if(ag(i))return Mn(d(Number(i)));if(ug(i))return Mn(d(Kr.call(i)));if(lg(i))return Mn(Zf.call(i));if(sg(i))return Mn(d(String(i)));if(!rg(i)&&!Al(i)){var O=gi(i,d),I=Sl?Sl(i)===Object.prototype:i instanceof Object||i.constructor===Object,N=i instanceof Object?"":"null prototype",W=!I&&Ve&&Object(i)===i&&Ve in i?Zr.call(At(i),8,-1):N?"Object":"",q=I||typeof i.constructor!="function"?"":i.constructor.name?i.constructor.name+" ":"",G=q+(W||N?"["+lt.call(El.call([],W||[],N||[]),": ")+"] ":"");return O.length===0?G+"{}":h?G+"{"+io(O,h)+"}":G+"{ "+lt.call(O,", ")+" }"}return String(i)};function Pl(t,i,e){var n=(e.quoteStyle||i)==="double"?'"':"'";return n+t+n}function ig(t){return Tt.call(String(t),/"/g,"&quot;")}function to(t){return At(t)==="[object Array]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function rg(t){return At(t)==="[object Date]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function Al(t){return At(t)==="[object RegExp]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function og(t){return At(t)==="[object Error]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function sg(t){return At(t)==="[object String]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function ag(t){return At(t)==="[object Number]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function lg(t){return At(t)==="[object Boolean]"&&(!Ve||!(typeof t=="object"&&Ve in t))}function Dl(t){if(nn)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Qr)return!1;try{return Qr.call(t),!0}catch{}return!1}function ug(t){if(!t||typeof t!="object"||!Kr)return!1;try{return Kr.call(t),!0}catch{}return!1}var cg=Object.prototype.hasOwnProperty||function(t){return t in this};function Pt(t,i){return cg.call(t,i)}function At(t){return Kf.call(t)}function hg(t){if(t.name)return t.name;var i=Qf.call(Jf.call(t),/^function\s*([\w$]+)/);return i?i[1]:null}function Ol(t,i){if(t.indexOf)return t.indexOf(i);for(var e=0,n=t.length;e<n;e++)if(t[e]===i)return e;return-1}function dg(t){if(!pi||!t||typeof t!="object")return!1;try{pi.call(t);try{fi.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function pg(t){if(!kn||!t||typeof t!="object")return!1;try{kn.call(t,kn);try{Bn.call(t,Bn)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function fg(t){if(!vl||!t||typeof t!="object")return!1;try{return vl.call(t),!0}catch{}return!1}function gg(t){if(!fi||!t||typeof t!="object")return!1;try{fi.call(t);try{pi.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function mg(t){if(!Bn||!t||typeof t!="object")return!1;try{Bn.call(t,Bn);try{kn.call(t,kn)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function vg(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Rl(t,i){if(t.length>i.maxStringLength){var e=t.length-i.maxStringLength,n="... "+e+" more character"+(e>1?"s":"");return Rl(Zr.call(t,0,i.maxStringLength),i)+n}var r=Tt.call(Tt.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,yg);return Pl(r,"single",i)}function yg(t){var i=t.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[i];return e?"\\"+e:"\\x"+(i<16?"0":"")+eg.call(i.toString(16))}function Mn(t){return"Object("+t+")"}function no(t){return t+" { ? }"}function kl(t,i,e,n){var r=n?io(e,n):lt.call(e,", ");return t+" ("+i+") {"+r+"}"}function wg(t){for(var i=0;i<t.length;i++)if(Ol(t[i],`
`)>=0)return!1;return!0}function Eg(t,i){var e;if(t.indent==="	")e="	";else if(typeof t.indent=="number"&&t.indent>0)e=lt.call(Array(t.indent+1)," ");else return null;return{base:e,prev:lt.call(Array(i+1),e)}}function io(t,i){if(t.length===0)return"";var e=`
`+i.prev+i.base;return e+lt.call(t,","+e)+`
`+i.prev}function gi(t,i){var e=to(t),n=[];if(e){n.length=t.length;for(var r=0;r<t.length;r++)n[r]=Pt(t,r)?i(t[r],t):""}var o=typeof Jr=="function"?Jr(t):[],s;if(nn){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var l in t)!Pt(t,l)||e&&String(Number(l))===l&&l<t.length||nn&&s["$"+l]instanceof Symbol||(wl.call(/[^\w$]/,l)?n.push(i(l,t)+": "+i(t[l],t)):n.push(l+": "+i(t[l],t)));if(typeof Jr=="function")for(var u=0;u<o.length;u++)xl.call(t,o[u])&&n.push("["+i(o[u])+"]: "+i(t[o[u]],t));return n}var Bl=function(t){return typeof t=="string"||typeof t=="symbol"},bg=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(typeof t=="function"||typeof t=="object")return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"},xg=bg,Fn=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":xg(t)},Sg=Fe,Ml=Sg("%TypeError%"),_g=ng,Cg=Bl,Tg=Fn,Fl=function(t,i){if(Tg(t)!=="Object")throw new Ml("Assertion failed: Type(O) is not Object");if(!Cg(i))throw new Ml("Assertion failed: IsPropertyKey(P) is not true, got "+_g(i));return t[i]},Pg=Fe,Il=Pg("%TypeError%"),Ag=Bl,Dg=Fn,Og=function(t,i){if(Dg(t)!=="Object")throw new Il("Assertion failed: `O` must be an Object");if(!Ag(i))throw new Il("Assertion failed: `P` must be a Property Key");return i in t},Ll=Function.prototype.toString,rn=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ro,mi;if(typeof rn=="function"&&typeof Object.defineProperty=="function")try{ro=Object.defineProperty({},"length",{get:function(){throw mi}}),mi={},rn(function(){throw 42},null,ro)}catch(t){t!==mi&&(rn=null)}else rn=null;var Rg=/^\s*class\b/,oo=function(t){try{var i=Ll.call(t);return Rg.test(i)}catch{return!1}},so=function(t){try{return oo(t)?!1:(Ll.call(t),!0)}catch{return!1}},vi=Object.prototype.toString,kg="[object Object]",Bg="[object Function]",Mg="[object GeneratorFunction]",Fg="[object HTMLAllCollection]",Ig="[object HTML document.all class]",Lg="[object HTMLCollection]",Ng=typeof Symbol=="function"&&!!Symbol.toStringTag,zg=!(0 in[,]),ao=function(){return!1};if(typeof document=="object"){var Hg=document.all;vi.call(Hg)===vi.call(document.all)&&(ao=function(t){if((zg||!t)&&(typeof t>"u"||typeof t=="object"))try{var i=vi.call(t);return(i===Fg||i===Ig||i===Lg||i===kg)&&t("")==null}catch{}return!1})}var Nl=rn?function(t){if(ao(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{rn(t,null,ro)}catch(i){if(i!==mi)return!1}return!oo(t)&&so(t)}:function(t){if(ao(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Ng)return so(t);if(oo(t))return!1;var i=vi.call(t);return i!==Bg&&i!==Mg&&!/^\[object HTML/.test(i)?!1:so(t)},jg=Nl,zl=Fe,Vg=zl("%Math%"),Ug=zl("%Number%"),Wg=Ug.MAX_SAFE_INTEGER||Vg.pow(2,53)-1,Gg=Fe,$g=Gg("%Math.abs%"),Xg=function(t){return $g(t)},qg=Fn,Yg=Math.floor,Zg=function(t){return qg(t)==="BigInt"?t:Yg(t)},Kg=function(t){return t===null||typeof t!="function"&&typeof t!="object"},Jg=function(t){return t===null||typeof t!="function"&&typeof t!="object"},Qg=el,lo=function(){return Qg()&&!!Symbol.toStringTag},em=Date.prototype.getDay,tm=function(t){try{return em.call(t),!0}catch{return!1}},nm=Object.prototype.toString,im="[object Date]",rm=lo(),om=function(t){return typeof t!="object"||t===null?!1:rm?tm(t):nm.call(t)===im},uo={exports:{}},sm=Object.prototype.toString,am=nl();if(am){var lm=Symbol.prototype.toString,um=/^Symbol\(.*\)$/,cm=function(t){return typeof t.valueOf()!="symbol"?!1:um.test(lm.call(t))};uo.exports=function(t){if(typeof t=="symbol")return!0;if(sm.call(t)!=="[object Symbol]")return!1;try{return cm(t)}catch{return!1}}}else uo.exports=function(t){return!1};var hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",co=Jg,Hl=Nl,dm=om,jl=uo.exports,pm=function(t,i){if(typeof t>"u"||t===null)throw new TypeError("Cannot call method on "+t);if(typeof i!="string"||i!=="number"&&i!=="string")throw new TypeError('hint must be "string" or "number"');var e=i==="string"?["toString","valueOf"]:["valueOf","toString"],n,r,o;for(o=0;o<e.length;++o)if(n=t[e[o]],Hl(n)&&(r=n.call(t),co(r)))return r;throw new TypeError("No default value")},fm=function(t,i){var e=t[i];if(e!==null&&typeof e<"u"){if(!Hl(e))throw new TypeError(e+" returned for property "+i+" of object "+t+" is not a function");return e}},gm=function(t){if(co(t))return t;var i="default";arguments.length>1&&(arguments[1]===String?i="string":arguments[1]===Number&&(i="number"));var e;if(hm&&(Symbol.toPrimitive?e=fm(t,Symbol.toPrimitive):jl(t)&&(e=Symbol.prototype.valueOf)),typeof e<"u"){var n=e.call(t,i);if(co(n))return n;throw new TypeError("unable to convert exotic object to primitive")}return i==="default"&&(dm(t)||jl(t))&&(i="string"),pm(t,i==="default"?"number":i)},Vl=gm,mm=function(t){return arguments.length>1?Vl(t,arguments[1]):Vl(t)},ho=yt,Ul=lo(),Wl,Gl,po,fo;if(Ul){Wl=ho("Object.prototype.hasOwnProperty"),Gl=ho("RegExp.prototype.exec"),po={};var go=function(){throw po};fo={toString:go,valueOf:go},typeof Symbol.toPrimitive=="symbol"&&(fo[Symbol.toPrimitive]=go)}var vm=ho("Object.prototype.toString"),ym=Object.getOwnPropertyDescriptor,wm="[object RegExp]",Em=Ul?function(t){if(!t||typeof t!="object")return!1;var i=ym(t,"lastIndex"),e=i&&Wl(i,"value");if(!e)return!1;try{Gl(t,fo)}catch(n){return n===po}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:vm(t)===wm},bm=yt,xm=Fe,Sm=Em,_m=bm("RegExp.prototype.exec"),Cm=xm("%TypeError%"),Tm=function(t){if(!Sm(t))throw new Cm("`regex` must be a RegExp");return function(i){return _m(t,i)!==null}},$l=Fe,Pm=$l("%String%"),Am=$l("%TypeError%"),Xl=function(t){if(typeof t=="symbol")throw new Am("Cannot convert a Symbol value to a string");return Pm(t)},Dm=Rn,Om=Xl,Rm=yt,ql=Rm("String.prototype.replace"),Yl=/^\s$/.test(""),km=Yl?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,Bm=Yl?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,Zl=function(){var t=Om(Dm(this));return ql(ql(t,km,""),Bm,"")},Mm=Zl,Kl="",on="",Jl=function(){return String.prototype.trim&&Kl.trim()===Kl&&on.trim()===on&&("_"+on).trim()==="_"+on&&(on+"_").trim()===on+"_"?String.prototype.trim:Mm},Fm=tn,Im=Jl,Lm=function(){var t=Im();return Fm(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t},Nm=On.exports,zm=tn,Hm=Rn,jm=Zl,Ql=Jl,Vm=Lm,Um=Nm(Ql()),eu=function(t){return Hm(t),Um(t)};zm(eu,{getPolyfill:Ql,implementation:jm,shim:Vm});var tu=eu,yi=Fe,mo=yi("%Number%"),Wm=yi("%RegExp%"),Gm=yi("%TypeError%"),nu=yi("%parseInt%"),$m=yt,wi=Tm,iu=$m("String.prototype.slice"),Xm=wi(/^0b[01]+$/i),qm=wi(/^0o[0-7]+$/i),Ym=wi(/^[-+]0x[0-9a-f]+$/i),Zm=["","",""].join(""),Km=new Wm("["+Zm+"]","g"),Jm=wi(Km),Qm=tu,e0=Fn,t0=function t(i){if(e0(i)!=="String")throw new Gm("Assertion failed: `argument` is not a String");if(Xm(i))return mo(nu(iu(i,2),2));if(qm(i))return mo(nu(iu(i,2),8));if(Jm(i)||Ym(i))return NaN;var e=Qm(i);return e!==i?t(e):mo(i)},ru=Fe,ou=ru("%TypeError%"),su=ru("%Number%"),n0=Kg,i0=mm,r0=t0,o0=function(t){var i=n0(t)?t:i0(t,su);if(typeof i=="symbol")throw new ou("Cannot convert a Symbol value to a number");if(typeof i=="bigint")throw new ou("Conversion from 'BigInt' to 'number' is not allowed.");return typeof i=="string"?r0(i):su(i)},au=Number.isNaN||function(t){return t!==t},s0=au,a0=function(t){return(typeof t=="number"||typeof t=="bigint")&&!s0(t)&&t!==1/0&&t!==-1/0},l0=function(t){return t>=0?1:-1},u0=Xg,c0=Zg,h0=o0,d0=au,p0=a0,f0=l0,g0=function(t){var i=h0(t);if(d0(i)||i===0)return 0;if(!p0(i))return i;var e=c0(u0(i));return e===0?0:f0(i)*e},lu=Wg,m0=g0,v0=function(t){var i=m0(t);return i<=0?0:i>lu?lu:i},y0=Fe,w0=y0("%TypeError%"),E0=Fl,b0=v0,x0=Fn,S0=function(t){if(x0(t)!=="Object")throw new w0("Assertion failed: `obj` must be an Object");return b0(E0(t,"length"))},_0=Fe,C0=_0("%Object%"),T0=Rn,P0=function(t){return T0(t),C0(t)},A0=String.prototype.valueOf,D0=function(t){try{return A0.call(t),!0}catch{return!1}},O0=Object.prototype.toString,R0="[object String]",k0=lo(),B0=function(t){return typeof t=="string"?!0:typeof t!="object"?!1:k0?D0(t):O0.call(t)===R0},M0=Fe,F0=yt,I0=M0("%TypeError%"),L0=Uf,N0=Fl,z0=Og,H0=jg,j0=S0,V0=P0,U0=Xl,W0=B0,G0=F0("String.prototype.split"),uu=Object("a"),$0=uu[0]!=="a"||!(0 in uu),cu=function(t){var i=V0(this),e=$0&&W0(this)?G0(this,""):i,n=j0(e);if(!H0(t))throw new I0("Array.prototype.forEach callback must be a function");var r;arguments.length>1&&(r=arguments[1]);for(var o=0;o<n;){var s=U0(o),a=z0(e,s);if(a){var l=N0(e,s);L0(t,r,[l,o,e])}o+=1}},X0=function(t){var i=!0,e=!0,n=!1;if(typeof t=="function"){try{t.call("f",function(r,o,s){typeof s!="object"&&(i=!1)}),t.call([null],function(){"use strict";e=typeof this=="string"},"x")}catch{n=!0}return!n&&i&&e}return!1},q0=X0,Y0=cu,hu=function(){var t=Array.prototype.forEach;return q0(t)?t:Y0},Z0=tn,K0=hu,J0=function(){var t=K0();return Z0(Array.prototype,{forEach:t},{forEach:function(){return Array.prototype.forEach!==t}}),t},Q0=tn,ev=On.exports,tv=yt,nv=Rn,iv=cu,du=hu,rv=du(),ov=J0,sv=tv("Array.prototype.slice"),av=ev.apply(rv),pu=function(t,i){return nv(t),av(t,sv(arguments,1))};Q0(pu,{getPolyfill:du,implementation:iv,shim:ov});var lv=pu,uv=Rn,fu=yt,cv=fu("Object.prototype.propertyIsEnumerable"),hv=fu("Array.prototype.push"),gu=function(t){var i=uv(t),e=[];for(var n in i)cv(i,n)&&hv(e,[n,i[n]]);return e},dv=gu,mu=function(){return typeof Object.entries=="function"?Object.entries:dv},pv=mu,fv=tn,gv=function(){var t=pv();return fv(Object,{entries:t},{entries:function(){return Object.entries!==t}}),t},mv=tn,vv=On.exports,yv=gu,vu=mu,wv=gv,yu=vv(vu(),Object);mv(yu,{getPolyfill:vu,implementation:yv,shim:wv});var Ev=yu,Ei=lv,vo=Ev,wu=rl,bv=tu,xv=function(t){},Eu=String.prototype.replace,bu=String.prototype.split,bi="||||",yo=function(t){var i=t%100,e=i%10;return i!==11&&e===1?0:2<=e&&e<=4&&!(i>=12&&i<=14)?1:2},xu={pluralTypes:{arabic:function(t){if(t<3)return t;var i=t%100;return i>=3&&i<=10?3:i>=11?4:5},bosnian_serbian:yo,chinese:function(){return 0},croatian:yo,french:function(t){return t>=2?1:0},german:function(t){return t!==1?1:0},russian:yo,lithuanian:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return t===1?0:t>=2&&t<=4?1:2},polish:function(t){if(t===1)return 0;var i=t%10;return 2<=i&&i<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!==1||t%100===11?1:0},slovenian:function(t){var i=t%100;return i===1?0:i===2?1:i===3||i===4?2:3},romanian:function(t){if(t===1)return 0;var i=t%100;return t===0||i>=2&&i<=19?1:2}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is","mk"],slovenian:["sl-SL"],romanian:["ro"]}};function Sv(t){var i={};return Ei(vo(t),function(e){var n=e[0],r=e[1];Ei(r,function(o){i[o]=n})}),i}function _v(t,i){var e=Sv(t.pluralTypeToLanguages);return e[i]||e[bu.call(i,/-/,1)[0]]||e.en}function Cv(t,i,e){return t.pluralTypes[i](e)}function Tv(){var t={};return function(i,e){var n=t[e];return n&&!i.pluralTypes[n]&&(n=null,t[e]=n),n||(n=_v(i,e),n&&(t[e]=n)),n}}function Su(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Pv(t){var i=t&&t.prefix||"%{",e=t&&t.suffix||"}";if(i===bi||e===bi)throw new RangeError('"'+bi+'" token is reserved for pluralization');return new RegExp(Su(i)+"(.*?)"+Su(e),"g")}var Av=Tv(),Dv=/%\{(.*?)\}/g;function wo(t,i,e,n,r,o){if(typeof t!="string")throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(i==null)return t;var s=t,a=n||Dv,l=o||Eu,u=typeof i=="number"?{smart_count:i}:i;if(u.smart_count!=null&&t){var c=r||xu,h=bu.call(t,bi),d=e||"en",g=Av(c,d),y=Cv(c,g,u.smart_count);s=bv(h[y]||h[0])}return s=l.call(s,a,function(S,E){return!wu(u,E)||u[E]==null?S:u[E]}),s}function wt(t){var i=t||{};this.phrases={},this.extend(i.phrases||{}),this.currentLocale=i.locale||"en";var e=i.allowMissing?wo:null;this.onMissingKey=typeof i.onMissingKey=="function"?i.onMissingKey:e,this.warn=i.warn||xv,this.replaceImplementation=i.replace||Eu,this.tokenRegex=Pv(i.interpolation),this.pluralRules=i.pluralRules||xu}wt.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},wt.prototype.extend=function(t,i){Ei(vo(t||{}),function(e){var n=e[0],r=e[1],o=i?i+"."+n:n;typeof r=="object"?this.extend(r,o):this.phrases[o]=r},this)},wt.prototype.unset=function(t,i){typeof t=="string"?delete this.phrases[t]:Ei(vo(t||{}),function(e){var n=e[0],r=e[1],o=i?i+"."+n:n;typeof r=="object"?this.unset(r,o):delete this.phrases[o]},this)},wt.prototype.clear=function(){this.phrases={}},wt.prototype.replace=function(t){this.clear(),this.extend(t)},wt.prototype.t=function(t,i){var e,n,r=i??{};if(typeof this.phrases[t]=="string")e=this.phrases[t];else if(typeof r._=="string")e=r._;else if(this.onMissingKey){var o=this.onMissingKey;n=o(t,r,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)}else this.warn('Missing translation for key: "'+t+'"'),n=t;return typeof e=="string"&&(n=wo(e,r,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)),n},wt.prototype.has=function(t){return wu(this.phrases,t)},wt.transformPhrase=function(t,i,e){return wo(t,i,e)};var Ov=wt,Rv={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:"",Close:"",Edit:"Edit",Delete:"Delete",Ok:""},kv={"Add a comment...":"Napsat koment...","Add a reply...":"Odpovdt...","Add tag...":"Pidat ttek...",Cancel:"Zruit",Close:"Zavt",Edit:"Upravit",Delete:"Smazat",Ok:"Ok"},Bv={"Add a comment...":"Kommentar schreiben...","Add a reply...":"Antwort schreiben...","Add tag...":"Tag...",Cancel:"Abbrechen",Close:"Schliessen",Edit:"Bearbeiten",Delete:"Lschen",Ok:"Ok"},Mv={"Add a comment...":"...","Add a reply...":"...","Add tag...":" tag...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:"Ok"},Fv={"Add a comment...":"Agregar un comentario...","Add a reply...":"Agregar una respuesta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Cerrar",Edit:"Editar",Delete:"Eliminar",Ok:"Ok"},Iv={"Add a comment...":"Lis kommentti","Add a reply...":"Lis vastaus","Add tag...":"Lis tunniste",Cancel:"Peruuta",Close:"Sulje",Edit:"Muokkaa",Delete:"Poista",Ok:"Ok"},Lv={"Add a comment...":"Ajouter un commentaire...","Add a reply...":"Ajouter une rponse...","Add tag...":"Ajouter une tiquette...",Cancel:"Annuler",Close:"Fermer",Edit:"diter",Delete:"Supprimer",Ok:"Ok"},Nv={"Add a comment...":"Engadir un comentario...","Add a reply...":"Engadir unha resposta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Pechar",Edit:"Edit",Delete:"Delete",Ok:"Ok"},zv={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:" ",Close:" ",Edit:" ",Delete:"",Ok:" "},Hv={"Add a comment...":"Commenta...","Add a reply...":"Rispondi...","Add tag...":"Aggiungi tag...",Cancel:"Annulla",Close:"Chiudi",Edit:"Edit",Delete:"Delete",Ok:"Ok"},jv={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:"Ok"},Vv={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},Uv={"Add a comment...":"Commentaar toevoegen...","Add a reply...":"Antwoord toevoegen...","Add tag...":"Tag toevoegen...",Cancel:"Afbreken",Close:"Sluiten",Edit:"Bewerken",Delete:"Verwijderen",Ok:"Ok"},Wv={"Add a comment...":"Adicionar um comentrio...","Add a reply...":"Adicionar uma resposta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Fechar",Edit:"Editar",Delete:"Apagar",Ok:"Ok"},Gv={"Add a comment...":" ...","Add a reply...":" ...","Add tag...":" ...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},$v={"Add a comment...":"Skriv en kommentar...","Add a reply...":"Skriv ett svar...","Add tag...":"Tagg...",Cancel:"Cancel",Close:"Stng",Edit:"Edit",Delete:"Delete",Ok:"Ok"},Xv={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},qv={"Add a comment...":"Yorum ekle...","Add a reply...":"Cevap ekle...","Add tag...":"Tag Ekle...",Cancel:"ptal",Close:"Kapat",Edit:"Dzenle",Delete:"Sil",Ok:"Tamam"},Yv={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:" ",Close:" ",Edit:" ",Delete:"",Ok:" "},Zv={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},Kv={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},_u={};Object.defineProperty(_u,"__esModule",{value:!0});var Eo=[["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "]];function Jv(t,i){return i<3?Eo[t][i-1]:i>=3&&i<=10?Eo[t][2]:Eo[t][3]}function Qv(t,i){if(i===0)return[" "," "];var e=Jv(Math.floor(i/2),t);return[" "+e," "+e]}var ey=_u.default=Qv,Cu={};Object.defineProperty(Cu,"__esModule",{value:!0});function ty(t,i){var e=0,n=i==1||i==3||i==5||i==7||i==9||i==11||i==13;return n&&t>=5&&(e=1),[[["prv te","prv te"]],[["ped %s vteinami","za %s vteiny"],["ped %s vteinami","za %s vtein"]],[["ped minutou","za minutu"]],[["ped %s minutami","za %s minuty"],["ped %s minutami","za %s minut"]],[["ped hodinou","za hodinu"]],[["ped %s hodinami","za %s hodiny"],["ped %s hodinami","za %s hodin"]],[["vera","ztra"]],[["ped %s dny","za %s dny"],["ped %s dny","za %s dn"]],[["minul tden","pt tden"]],[["ped %s tdny","za %s tdny"],["ped %s tdny","za %s tdn"]],[["minul msc","pst msc"]],[["ped %s msci","za %s msce"],["ped %s msci","za %s msc"]],[["ped rokem","pst rok"]],[["ped %s lety","za %s roky"],["ped %s lety","za %s let"]]][i][e]}var ny=Cu.default=ty,Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});function iy(t,i){return[["gerade eben","vor einer Weile"],["vor %s Sekunden","in %s Sekunden"],["vor 1 Minute","in 1 Minute"],["vor %s Minuten","in %s Minuten"],["vor 1 Stunde","in 1 Stunde"],["vor %s Stunden","in %s Stunden"],["vor 1 Tag","in 1 Tag"],["vor %s Tagen","in %s Tagen"],["vor 1 Woche","in 1 Woche"],["vor %s Wochen","in %s Wochen"],["vor 1 Monat","in 1 Monat"],["vor %s Monaten","in %s Monaten"],["vor 1 Jahr","in 1 Jahr"],["vor %s Jahren","in %s Jahren"]][i]}var ry=Tu.default=iy,Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});function oy(t,i){return[[" "," "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "]][i]}var sy=Pu.default=oy,Au={};Object.defineProperty(Au,"__esModule",{value:!0});function ay(t,i){return[["justo ahora","en un rato"],["hace %s segundos","en %s segundos"],["hace 1 minuto","en 1 minuto"],["hace %s minutos","en %s minutos"],["hace 1 hora","en 1 hora"],["hace %s horas","en %s horas"],["hace 1 da","en 1 da"],["hace %s das","en %s das"],["hace 1 semana","en 1 semana"],["hace %s semanas","en %s semanas"],["hace 1 mes","en 1 mes"],["hace %s meses","en %s meses"],["hace 1 ao","en 1 ao"],["hace %s aos","en %s aos"]][i]}var ly=Au.default=ay,Du={};Object.defineProperty(Du,"__esModule",{value:!0});function uy(t,i){return[["juuri sken","juuri nyt"],["%s sekuntia sitten","%s sekunnin pst"],["minuutti sitten","minuutin pst"],["%s minuuttia sitten","%s minuutin pst"],["tunti sitten","tunnin pst"],["%s tuntia sitten","%s tunnin pst"],["piv sitten","pivn pst"],["%s piv sitten","%s pivn pst"],["viikko sitten","viikon pst"],["%s viikkoa sitten","%s viikon pst"],["kuukausi sitten","kuukauden pst"],["%s kuukautta sitten","%s kuukauden pst"],["vuosi sitten","vuoden pst"],["%s vuotta sitten","%s vuoden pst"]][i]}var cy=Du.default=uy,Ou={};Object.defineProperty(Ou,"__esModule",{value:!0});function hy(t,i){return[[" l'instant","dans un instant"],["il y a %s secondes","dans %s secondes"],["il y a 1 minute","dans 1 minute"],["il y a %s minutes","dans %s minutes"],["il y a 1 heure","dans 1 heure"],["il y a %s heures","dans %s heures"],["il y a 1 jour","dans 1 jour"],["il y a %s jours","dans %s jours"],["il y a 1 semaine","dans 1 semaine"],["il y a %s semaines","dans %s semaines"],["il y a 1 mois","dans 1 mois"],["il y a %s mois","dans %s mois"],["il y a 1 an","dans 1 an"],["il y a %s ans","dans %s ans"]][i]}var dy=Ou.default=hy,Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});function py(t,i){return[["xusto agora","daqu a un pouco"],["hai %s segundos","en %s segundos"],["hai 1 minuto","nun minuto"],["hai %s minutos","en %s minutos"],["hai 1 hora","nunha hora"],["hai %s horas","en %s horas"],["hai 1 da","nun da"],["hai %s das","en %s das"],["hai 1 semana","nunha semana"],["hai %s semanas","en %s semanas"],["hai 1 mes","nun mes"],["hai %s meses","en %s meses"],["hai 1 ano","nun ano"],["hai %s anos","en %s anos"]][i]}var fy=Ru.default=py,ku={};Object.defineProperty(ku,"__esModule",{value:!0});function gy(t,i){return[[""," "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "]][i]}var my=ku.default=gy,Bu={};Object.defineProperty(Bu,"__esModule",{value:!0});function vy(t,i){return[["poco fa","fra poco"],["%s secondi fa","fra %s secondi"],["un minuto fa","fra un minuto"],["%s minuti fa","fra %s minuti"],["un'ora fa","fra un'ora"],["%s ore fa","fra %s ore"],["un giorno fa","fra un giorno"],["%s giorni fa","fra %s giorni"],["una settimana fa","fra una settimana"],["%s settimane fa","fra %s settimane"],["un mese fa","fra un mese"],["%s mesi fa","fra %s mesi"],["un anno fa","fra un anno"],["%s anni fa","fra %s anni"]][i]}var yy=Bu.default=vy,Mu={};Object.defineProperty(Mu,"__esModule",{value:!0});function wy(t,i){return[["",""],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"]][i]}var Ey=Mu.default=wy,Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});function by(t,i){return[["",""],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "]][i]}var xy=Fu.default=by,Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});function Sy(t,i){return[["recent","binnenkort"],["%s seconden geleden","binnen %s seconden"],["1 minuut geleden","binnen 1 minuut"],["%s minuten geleden","binnen %s minuten"],["1 uur geleden","binnen 1 uur"],["%s uur geleden","binnen %s uur"],["1 dag geleden","binnen 1 dag"],["%s dagen geleden","binnen %s dagen"],["1 week geleden","binnen 1 week"],["%s weken geleden","binnen %s weken"],["1 maand geleden","binnen 1 maand"],["%s maanden geleden","binnen %s maanden"],["1 jaar geleden","binnen 1 jaar"],["%s jaar geleden","binnen %s jaar"]][i]}var _y=Iu.default=Sy,Lu={};Object.defineProperty(Lu,"__esModule",{value:!0});function Cy(t,i){return[["agora mesmo","agora"],["h %s segundos","em %s segundos"],["h um minuto","em um minuto"],["h %s minutos","em %s minutos"],["h uma hora","em uma hora"],["h %s horas","em %s horas"],["h um dia","em um dia"],["h %s dias","em %s dias"],["h uma semana","em uma semana"],["h %s semanas","em %s semanas"],["h um ms","em um ms"],["h %s meses","em %s meses"],["h um ano","em um ano"],["h %s anos","em %s anos"]][i]}var Ty=Lu.default=Cy,Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});function Nt(t,i,e,n,r){var o=r%10,s=n;return r===1?s=t:o===1&&r>20?s=i:o>1&&o<5&&(r>20||r<10)&&(s=e),s}var zu=Nt.bind(null,"","%s ","%s ","%s "),Hu=Nt.bind(null,"","%s ","%s ","%s "),ju=Nt.bind(null,"","%s ","%s ","%s "),Vu=Nt.bind(null,"","%s ","%s ","%s "),Uu=Nt.bind(null,"","%s ","%s ","%s "),Wu=Nt.bind(null,"","%s ","%s ","%s "),Gu=Nt.bind(null,"","%s ","%s ","%s ");function Py(t,i){switch(i){case 0:return[" ","  "];case 1:return[zu(t)+" "," "+zu(t)];case 2:case 3:return[Hu(t)+" "," "+Hu(t)];case 4:case 5:return[ju(t)+" "," "+ju(t)];case 6:return["",""];case 7:return[Vu(t)+" "," "+Vu(t)];case 8:case 9:return[Uu(t)+" "," "+Uu(t)];case 10:case 11:return[Wu(t)+" "," "+Wu(t)];case 12:case 13:return[Gu(t)+" "," "+Gu(t)];default:return["",""]}}var Ay=Nu.default=Py,$u={};Object.defineProperty($u,"__esModule",{value:!0});function Dy(t,i){return[["just nu","om en stund"],["%s sekunder sedan","om %s sekunder"],["1 minut sedan","om 1 minut"],["%s minuter sedan","om %s minuter"],["1 timme sedan","om 1 timme"],["%s timmar sedan","om %s timmar"],["1 dag sedan","om 1 dag"],["%s dagar sedan","om %s dagar"],["1 vecka sedan","om 1 vecka"],["%s veckor sedan","om %s veckor"],["1 mnad sedan","om 1 mnad"],["%s mnader sedan","om %s mnader"],["1 r sedan","om 1 r"],["%s r sedan","om %s r"]][i]}var Oy=$u.default=Dy,Xu={};Object.defineProperty(Xu,"__esModule",{value:!0});function Ry(t,i){return[["",""],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "]][i]}var ky=Xu.default=Ry,qu={};Object.defineProperty(qu,"__esModule",{value:!0});function By(t,i){return[["az nce","imdi"],["%s saniye nce","%s saniye iinde"],["1 dakika nce","1 dakika iinde"],["%s dakika nce","%s dakika iinde"],["1 saat nce","1 saat iinde"],["%s saat nce","%s saat iinde"],["1 gn nce","1 gn iinde"],["%s gn nce","%s gn iinde"],["1 hafta nce","1 hafta iinde"],["%s hafta nce","%s hafta iinde"],["1 ay nce","1 ay iinde"],["%s ay nce","%s ay iinde"],["1 yl nce","1 yl iinde"],["%s yl nce","%s yl iinde"]][i]}var My=qu.default=By,Yu={};Object.defineProperty(Yu,"__esModule",{value:!0});var Fy=["","","","","","",""];function Iy(t,i){if(i===0)return["",""];var e=Fy[~~(i/2)];return[t+" "+e+"",t+" "+e+""]}var Ly=Yu.default=Iy,Zu={};Object.defineProperty(Zu,"__esModule",{value:!0});function Ny(t,i){return[["",""],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "]][i]}var zy=Zu.default=Ny;const sn={ar:Rv,cs:kv,de:Bv,el:Mv,es:Fv,fi:Iv,fr:Lv,gl:Nv,hi:zv,it:Hv,ja:jv,ko:Vv,nl:Uv,pt:Wv,ru:Gv,sv:$v,th:Xv,tr:qv,ur:Yv,"zh-CN":Zv,"zh-TW":Kv},Hy=Object.keys(sn),zt=new Ov({allowMissing:!0});zt.init=(t,i)=>{zt.clear(),t&&(zt.locale(t),zt.extend(sn[t])),i&&zt.extend(i)},Ce("ar",ey),Ce("cs",ny),Ce("de",ry),Ce("el",sy),Ce("es",ly),Ce("fi",cy),Ce("fr",dy),Ce("gl",fy),Ce("hi",my),Ce("it",yy),Ce("ja",Ey),Ce("ko",xy),Ce("nl",_y),Ce("pt",Ty),Ce("ru",Ay),Ce("sv",Oy),Ce("th",ky),Ce("tr",My),Ce("zh-CN",Ly),Ce("zh-TW",zy),zt.registerMessages=(t,i)=>{sn[t]?sn[t]={...sn[t],...i}:sn[t]=i};var Ye=zt,jy=t=>{const i=rt();return Up(i,()=>t.onClickOutside()),B.createElement("ul",{ref:i,className:"r6o-comment-dropdown-menu"},B.createElement("li",{onClick:t.onEdit},Ye.t("Edit")),B.createElement("li",{onClick:t.onDelete},Ye.t("Delete")))},Ku={},bo={},xo={exports:{}};/*!
	autosize 4.0.4
	license: MIT
	http://www.jacklmoore.com/autosize
*/(function(t,i){(function(e,n){n(t,i)})(St,function(e,n){var r=typeof Map=="function"?new Map:function(){var c=[],h=[];return{has:function(d){return c.indexOf(d)>-1},get:function(d){return h[c.indexOf(d)]},set:function(d,g){c.indexOf(d)===-1&&(c.push(d),h.push(g))},delete:function(d){var g=c.indexOf(d);g>-1&&(c.splice(g,1),h.splice(g,1))}}}(),o=function(c){return new Event(c,{bubbles:!0})};try{new Event("test")}catch{o=function(c){var h=document.createEvent("Event");return h.initEvent(c,!0,!1),h}}function s(c){if(!c||!c.nodeName||c.nodeName!=="TEXTAREA"||r.has(c))return;var h=null,d=null,g=null;function y(){var P=window.getComputedStyle(c,null);P.resize==="vertical"?c.style.resize="none":P.resize==="both"&&(c.style.resize="horizontal"),P.boxSizing==="content-box"?h=-(parseFloat(P.paddingTop)+parseFloat(P.paddingBottom)):h=parseFloat(P.borderTopWidth)+parseFloat(P.borderBottomWidth),isNaN(h)&&(h=0),p()}function S(P){{var D=c.style.width;c.style.width="0px",c.offsetWidth,c.style.width=D}c.style.overflowY=P}function E(P){for(var D=[];P&&P.parentNode&&P.parentNode instanceof Element;)P.parentNode.scrollTop&&D.push({node:P.parentNode,scrollTop:P.parentNode.scrollTop}),P=P.parentNode;return D}function C(){if(c.scrollHeight!==0){var P=E(c),D=document.documentElement&&document.documentElement.scrollTop;c.style.height="",c.style.height=c.scrollHeight+h+"px",d=c.clientWidth,P.forEach(function(O){O.node.scrollTop=O.scrollTop}),D&&(document.documentElement.scrollTop=D)}}function p(){C();var P=Math.round(parseFloat(c.style.height)),D=window.getComputedStyle(c,null),O=D.boxSizing==="content-box"?Math.round(parseFloat(D.height)):c.offsetHeight;if(O<P?D.overflowY==="hidden"&&(S("scroll"),C(),O=D.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(c,null).height)):c.offsetHeight):D.overflowY!=="hidden"&&(S("hidden"),C(),O=D.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(c,null).height)):c.offsetHeight),g!==O){g=O;var I=o("autosize:resized");try{c.dispatchEvent(I)}catch{}}}var x=function(){c.clientWidth!==d&&p()},A=(function(P){window.removeEventListener("resize",x,!1),c.removeEventListener("input",p,!1),c.removeEventListener("keyup",p,!1),c.removeEventListener("autosize:destroy",A,!1),c.removeEventListener("autosize:update",p,!1),Object.keys(P).forEach(function(D){c.style[D]=P[D]}),r.delete(c)}).bind(c,{height:c.style.height,resize:c.style.resize,overflowY:c.style.overflowY,overflowX:c.style.overflowX,wordWrap:c.style.wordWrap});c.addEventListener("autosize:destroy",A,!1),"onpropertychange"in c&&"oninput"in c&&c.addEventListener("keyup",p,!1),window.addEventListener("resize",x,!1),c.addEventListener("input",p,!1),c.addEventListener("autosize:update",p,!1),c.style.overflowX="hidden",c.style.wordWrap="break-word",r.set(c,{destroy:A,update:p}),y()}function a(c){var h=r.get(c);h&&h.destroy()}function l(c){var h=r.get(c);h&&h.update()}var u=null;typeof window>"u"||typeof window.getComputedStyle!="function"?(u=function(c){return c},u.destroy=function(c){return c},u.update=function(c){return c}):(u=function(c,h){return c&&Array.prototype.forEach.call(c.length?c:[c],function(d){return s(d)}),c},u.destroy=function(c){return c&&Array.prototype.forEach.call(c.length?c:[c],a),c},u.update=function(c){return c&&Array.prototype.forEach.call(c.length?c:[c],l),c}),n.default=u,e.exports=n.default})})(xo,xo.exports);var Vy=function(t,i,e){return e=window.getComputedStyle,(e?e(t):t.currentStyle)[i.replace(/-(\w)/gi,function(n,r){return r.toUpperCase()})]},Uy=Vy,So=Uy;function Wy(t){var i=So(t,"line-height"),e=parseFloat(i,10);if(i===e+""){var n=t.style.lineHeight;t.style.lineHeight=i+"em",i=So(t,"line-height"),e=parseFloat(i,10),n?t.style.lineHeight=n:delete t.style.lineHeight}if(i.indexOf("pt")!==-1?(e*=4,e/=3):i.indexOf("mm")!==-1?(e*=96,e/=25.4):i.indexOf("cm")!==-1?(e*=96,e/=2.54):i.indexOf("in")!==-1?e*=96:i.indexOf("pc")!==-1&&(e*=16),e=Math.round(e),i==="normal"){var r=t.nodeName,o=document.createElement(r);o.innerHTML="&nbsp;",r.toUpperCase()==="TEXTAREA"&&o.setAttribute("rows","1");var s=So(t,"font-size");o.style.fontSize=s,o.style.padding="0px",o.style.border="0px";var a=document.body;a.appendChild(o);var l=o.offsetHeight;e=l,a.removeChild(o)}return e}var Gy=Wy,$y=St&&St.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,e){i.__proto__=e}||function(i,e){for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n])};return function(i,e){t(i,e);function n(){this.constructor=i}i.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),_o=St&&St.__assign||Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++){i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Xy=St&&St.__rest||function(t,i){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)i.indexOf(n[r])<0&&(e[n[r]]=t[n[r]]);return e};bo.__esModule=!0;var xi=Yt,In=Pn.exports,Si=xo.exports,qy=Gy,Yy=qy,Ju="autosize:resized",Zy=function(t){$y(i,t);function i(){var e=t!==null&&t.apply(this,arguments)||this;return e.state={lineHeight:null},e.textarea=null,e.onResize=function(n){e.props.onResize&&e.props.onResize(n)},e.updateLineHeight=function(){e.textarea&&e.setState({lineHeight:Yy(e.textarea)})},e.onChange=function(n){var r=e.props.onChange;e.currentValue=n.currentTarget.value,r&&r(n)},e}return i.prototype.componentDidMount=function(){var e=this,n=this.props,r=n.maxRows,o=n.async;typeof r=="number"&&this.updateLineHeight(),typeof r=="number"||o?setTimeout(function(){return e.textarea&&Si(e.textarea)}):this.textarea&&Si(this.textarea),this.textarea&&this.textarea.addEventListener(Ju,this.onResize)},i.prototype.componentWillUnmount=function(){this.textarea&&(this.textarea.removeEventListener(Ju,this.onResize),Si.destroy(this.textarea))},i.prototype.render=function(){var e=this,n=this,r=n.props;r.onResize;var o=r.maxRows;r.onChange;var s=r.style;r.innerRef;var a=r.children,l=Xy(r,["onResize","maxRows","onChange","style","innerRef","children"]),u=n.state.lineHeight,c=o&&u?u*o:null;return xi.createElement("textarea",_o({},l,{onChange:this.onChange,style:c?_o({},s,{maxHeight:c}):s,ref:function(h){e.textarea=h,typeof e.props.innerRef=="function"?e.props.innerRef(h):e.props.innerRef&&(e.props.innerRef.current=h)}}),a)},i.prototype.componentDidUpdate=function(){this.textarea&&Si.update(this.textarea)},i.defaultProps={rows:1,async:!1},i.propTypes={rows:In.number,maxRows:In.number,onResize:In.func,innerRef:In.any,async:In.bool},i}(xi.Component);bo.TextareaAutosize=xi.forwardRef(function(t,i){return xi.createElement(Zy,_o({},t,{innerRef:i}))}),function(t){t.__esModule=!0;var i=bo;t.default=i.TextareaAutosize}(Ku);var Ky=Rd(Ku);class Qu extends Ae{constructor(i){super(i),T(this,"onKeyDown",e=>{e.which===13&&e.ctrlKey&&this.props.onSaveAndClose()}),T(this,"onKeyUp",e=>{e.which===46&&e.stopPropagation()}),this.element=hr()}componentDidMount(){this.props.focus&&this.element.current&&this.element.current.focus({preventScroll:!0})}render(){return B.createElement(Ky,{ref:this.element,className:"r6o-editable-text",value:this.props.content,placeholder:this.props.placeholder||Ye.t("Add a comment..."),disabled:!this.props.editable,onChange:this.props.onChange,onKeyUp:this.onKeyUp,onKeyDown:this.onKeyDown})}}function ne(){return ne=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},ne.apply(this,arguments)}function Jy(t){if(t.sheet)return t.sheet;for(var i=0;i<document.styleSheets.length;i++)if(document.styleSheets[i].ownerNode===t)return document.styleSheets[i]}function Qy(t){var i=document.createElement("style");return i.setAttribute("data-emotion",t.key),t.nonce!==void 0&&i.setAttribute("nonce",t.nonce),i.appendChild(document.createTextNode("")),i.setAttribute("data-s",""),i}var e1=function(){function t(e){var n=this;this._insertTag=function(r){var o;n.tags.length===0?n.insertionPoint?o=n.insertionPoint.nextSibling:n.prepend?o=n.container.firstChild:o=n.before:o=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(r,o),n.tags.push(r)},this.isSpeedy=e.speedy===void 0?!0:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var i=t.prototype;return i.hydrate=function(e){e.forEach(this._insertTag)},i.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Qy(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var r=Jy(n);try{r.insertRule(e,r.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(e));this.ctr++},i.flush=function(){this.tags.forEach(function(e){return e.parentNode&&e.parentNode.removeChild(e)}),this.tags=[],this.ctr=0},t}(),Ue="-ms-",_i="-moz-",me="-webkit-",ec="comm",Co="rule",To="decl",t1="@import",tc="@keyframes",n1="@layer",i1=Math.abs,Ci=String.fromCharCode,r1=Object.assign;function o1(t,i){return Ie(t,0)^45?(((i<<2^Ie(t,0))<<2^Ie(t,1))<<2^Ie(t,2))<<2^Ie(t,3):0}function nc(t){return t.trim()}function s1(t,i){return(t=i.exec(t))?t[0]:t}function ve(t,i,e){return t.replace(i,e)}function Po(t,i){return t.indexOf(i)}function Ie(t,i){return t.charCodeAt(i)|0}function Ln(t,i,e){return t.slice(i,e)}function ut(t){return t.length}function Ao(t){return t.length}function Ti(t,i){return i.push(t),t}function a1(t,i){return t.map(i).join("")}var Pi=1,an=1,ic=0,We=0,Pe=0,ln="";function Ai(t,i,e,n,r,o,s){return{value:t,root:i,parent:e,type:n,props:r,children:o,line:Pi,column:an,length:s,return:""}}function Nn(t,i){return r1(Ai("",null,null,"",null,null,0),t,{length:-t.length},i)}function l1(){return Pe}function u1(){return Pe=We>0?Ie(ln,--We):0,an--,Pe===10&&(an=1,Pi--),Pe}function Ze(){return Pe=We<ic?Ie(ln,We++):0,an++,Pe===10&&(an=1,Pi++),Pe}function ct(){return Ie(ln,We)}function Di(){return We}function zn(t,i){return Ln(ln,t,i)}function Hn(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function rc(t){return Pi=an=1,ic=ut(ln=t),We=0,[]}function oc(t){return ln="",t}function Oi(t){return nc(zn(We-1,Do(t===91?t+2:t===40?t+1:t)))}function c1(t){for(;(Pe=ct())&&Pe<33;)Ze();return Hn(t)>2||Hn(Pe)>3?"":" "}function h1(t,i){for(;--i&&Ze()&&!(Pe<48||Pe>102||Pe>57&&Pe<65||Pe>70&&Pe<97););return zn(t,Di()+(i<6&&ct()==32&&Ze()==32))}function Do(t){for(;Ze();)switch(Pe){case t:return We;case 34:case 39:t!==34&&t!==39&&Do(Pe);break;case 40:t===41&&Do(t);break;case 92:Ze();break}return We}function d1(t,i){for(;Ze()&&t+Pe!==47+10&&!(t+Pe===42+42&&ct()===47););return"/*"+zn(i,We-1)+"*"+Ci(t===47?t:Ze())}function p1(t){for(;!Hn(ct());)Ze();return zn(t,We)}function f1(t){return oc(Ri("",null,null,null,[""],t=rc(t),0,[0],t))}function Ri(t,i,e,n,r,o,s,a,l){for(var u=0,c=0,h=s,d=0,g=0,y=0,S=1,E=1,C=1,p=0,x="",A=r,P=o,D=n,O=x;E;)switch(y=p,p=Ze()){case 40:if(y!=108&&Ie(O,h-1)==58){Po(O+=ve(Oi(p),"&","&\f"),"&\f")!=-1&&(C=-1);break}case 34:case 39:case 91:O+=Oi(p);break;case 9:case 10:case 13:case 32:O+=c1(y);break;case 92:O+=h1(Di()-1,7);continue;case 47:switch(ct()){case 42:case 47:Ti(g1(d1(Ze(),Di()),i,e),l);break;default:O+="/"}break;case 123*S:a[u++]=ut(O)*C;case 125*S:case 59:case 0:switch(p){case 0:case 125:E=0;case 59+c:C==-1&&(O=ve(O,/\f/g,"")),g>0&&ut(O)-h&&Ti(g>32?ac(O+";",n,e,h-1):ac(ve(O," ","")+";",n,e,h-2),l);break;case 59:O+=";";default:if(Ti(D=sc(O,i,e,u,c,r,a,x,A=[],P=[],h),o),p===123)if(c===0)Ri(O,i,D,D,A,o,h,a,P);else switch(d===99&&Ie(O,3)===110?100:d){case 100:case 108:case 109:case 115:Ri(t,D,D,n&&Ti(sc(t,D,D,0,0,r,a,x,r,A=[],h),P),r,P,h,a,n?A:P);break;default:Ri(O,D,D,D,[""],P,0,a,P)}}u=c=g=0,S=C=1,x=O="",h=s;break;case 58:h=1+ut(O),g=y;default:if(S<1){if(p==123)--S;else if(p==125&&S++==0&&u1()==125)continue}switch(O+=Ci(p),p*S){case 38:C=c>0?1:(O+="\f",-1);break;case 44:a[u++]=(ut(O)-1)*C,C=1;break;case 64:ct()===45&&(O+=Oi(Ze())),d=ct(),c=h=ut(x=O+=p1(Di())),p++;break;case 45:y===45&&ut(O)==2&&(S=0)}}return o}function sc(t,i,e,n,r,o,s,a,l,u,c){for(var h=r-1,d=r===0?o:[""],g=Ao(d),y=0,S=0,E=0;y<n;++y)for(var C=0,p=Ln(t,h+1,h=i1(S=s[y])),x=t;C<g;++C)(x=nc(S>0?d[C]+" "+p:ve(p,/&\f/g,d[C])))&&(l[E++]=x);return Ai(t,i,e,r===0?Co:a,l,u,c)}function g1(t,i,e){return Ai(t,i,e,ec,Ci(l1()),Ln(t,2,-2),0)}function ac(t,i,e,n){return Ai(t,i,e,To,Ln(t,0,n),Ln(t,n+1,-1),n)}function un(t,i){for(var e="",n=Ao(t),r=0;r<n;r++)e+=i(t[r],r,t,i)||"";return e}function m1(t,i,e,n){switch(t.type){case n1:if(t.children.length)break;case t1:case To:return t.return=t.return||t.value;case ec:return"";case tc:return t.return=t.value+"{"+un(t.children,n)+"}";case Co:t.value=t.props.join(",")}return ut(e=un(t.children,n))?t.return=t.value+"{"+e+"}":""}function v1(t){var i=Ao(t);return function(e,n,r,o){for(var s="",a=0;a<i;a++)s+=t[a](e,n,r,o)||"";return s}}function y1(t){return function(i){i.root||(i=i.return)&&t(i)}}function w1(t){var i=Object.create(null);return function(e){return i[e]===void 0&&(i[e]=t(e)),i[e]}}var E1=function(t,i,e){for(var n=0,r=0;n=r,r=ct(),n===38&&r===12&&(i[e]=1),!Hn(r);)Ze();return zn(t,We)},b1=function(t,i){var e=-1,n=44;do switch(Hn(n)){case 0:n===38&&ct()===12&&(i[e]=1),t[e]+=E1(We-1,i,e);break;case 2:t[e]+=Oi(n);break;case 4:if(n===44){t[++e]=ct()===58?"&\f":"",i[e]=t[e].length;break}default:t[e]+=Ci(n)}while(n=Ze());return t},x1=function(t,i){return oc(b1(rc(t),i))},lc=new WeakMap,S1=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var i=t.value,e=t.parent,n=t.column===e.column&&t.line===e.line;e.type!=="rule";)if(e=e.parent,!e)return;if(!(t.props.length===1&&i.charCodeAt(0)!==58&&!lc.get(e))&&!n){lc.set(t,!0);for(var r=[],o=x1(i,r),s=e.props,a=0,l=0;a<o.length;a++)for(var u=0;u<s.length;u++,l++)t.props[l]=r[a]?o[a].replace(/&\f/g,s[u]):s[u]+" "+o[a]}}},_1=function(t){if(t.type==="decl"){var i=t.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(t.return="",t.value="")}};function uc(t,i){switch(o1(t,i)){case 5103:return me+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return me+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return me+t+_i+t+Ue+t+t;case 6828:case 4268:return me+t+Ue+t+t;case 6165:return me+t+Ue+"flex-"+t+t;case 5187:return me+t+ve(t,/(\w+).+(:[^]+)/,me+"box-$1$2"+Ue+"flex-$1$2")+t;case 5443:return me+t+Ue+"flex-item-"+ve(t,/flex-|-self/,"")+t;case 4675:return me+t+Ue+"flex-line-pack"+ve(t,/align-content|flex-|-self/,"")+t;case 5548:return me+t+Ue+ve(t,"shrink","negative")+t;case 5292:return me+t+Ue+ve(t,"basis","preferred-size")+t;case 6060:return me+"box-"+ve(t,"-grow","")+me+t+Ue+ve(t,"grow","positive")+t;case 4554:return me+ve(t,/([^-])(transform)/g,"$1"+me+"$2")+t;case 6187:return ve(ve(ve(t,/(zoom-|grab)/,me+"$1"),/(image-set)/,me+"$1"),t,"")+t;case 5495:case 3959:return ve(t,/(image-set\([^]*)/,me+"$1$`$1");case 4968:return ve(ve(t,/(.+:)(flex-)?(.*)/,me+"box-pack:$3"+Ue+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+me+t+t;case 4095:case 3583:case 4068:case 2532:return ve(t,/(.+)-inline(.+)/,me+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ut(t)-1-i>6)switch(Ie(t,i+1)){case 109:if(Ie(t,i+4)!==45)break;case 102:return ve(t,/(.+:)(.+)-([^]+)/,"$1"+me+"$2-$3$1"+_i+(Ie(t,i+3)==108?"$3":"$2-$3"))+t;case 115:return~Po(t,"stretch")?uc(ve(t,"stretch","fill-available"),i)+t:t}break;case 4949:if(Ie(t,i+1)!==115)break;case 6444:switch(Ie(t,ut(t)-3-(~Po(t,"!important")&&10))){case 107:return ve(t,":",":"+me)+t;case 101:return ve(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+me+(Ie(t,14)===45?"inline-":"")+"box$3$1"+me+"$2$3$1"+Ue+"$2box$3")+t}break;case 5936:switch(Ie(t,i+11)){case 114:return me+t+Ue+ve(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return me+t+Ue+ve(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return me+t+Ue+ve(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return me+t+Ue+t+t}return t}var C1=function(t,i,e,n){if(t.length>-1&&!t.return)switch(t.type){case To:t.return=uc(t.value,t.length);break;case tc:return un([Nn(t,{value:ve(t.value,"@","@"+me)})],n);case Co:if(t.length)return a1(t.props,function(r){switch(s1(r,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return un([Nn(t,{props:[ve(r,/:(read-\w+)/,":"+_i+"$1")]})],n);case"::placeholder":return un([Nn(t,{props:[ve(r,/:(plac\w+)/,":"+me+"input-$1")]}),Nn(t,{props:[ve(r,/:(plac\w+)/,":"+_i+"$1")]}),Nn(t,{props:[ve(r,/:(plac\w+)/,Ue+"input-$1")]})],n)}return""})}},T1=[C1],P1=function(t){var i=t.key;if(i==="css"){var e=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(e,function(y){var S=y.getAttribute("data-emotion");S.indexOf(" ")!==-1&&(document.head.appendChild(y),y.setAttribute("data-s",""))})}var n=t.stylisPlugins||T1,r={},o,s=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(y){for(var S=y.getAttribute("data-emotion").split(" "),E=1;E<S.length;E++)r[S[E]]=!0;s.push(y)});var a,l=[S1,_1];{var u,c=[m1,y1(function(y){u.insert(y)})],h=v1(l.concat(n,c)),d=function(y){return un(f1(y),h)};a=function(y,S,E,C){u=E,d(y?y+"{"+S.styles+"}":S.styles),C&&(g.inserted[S.name]=!0)}}var g={key:i,sheet:new e1({key:i,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:r,registered:{},insert:a};return g.sheet.hydrate(s),g},cc={exports:{}},we={};/** @license React v16.13.1
* react-is.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var ke=typeof Symbol=="function"&&Symbol.for,Oo=ke?Symbol.for("react.element"):60103,Ro=ke?Symbol.for("react.portal"):60106,ki=ke?Symbol.for("react.fragment"):60107,Bi=ke?Symbol.for("react.strict_mode"):60108,Mi=ke?Symbol.for("react.profiler"):60114,Fi=ke?Symbol.for("react.provider"):60109,Ii=ke?Symbol.for("react.context"):60110,ko=ke?Symbol.for("react.async_mode"):60111,Li=ke?Symbol.for("react.concurrent_mode"):60111,Ni=ke?Symbol.for("react.forward_ref"):60112,zi=ke?Symbol.for("react.suspense"):60113,A1=ke?Symbol.for("react.suspense_list"):60120,Hi=ke?Symbol.for("react.memo"):60115,ji=ke?Symbol.for("react.lazy"):60116,D1=ke?Symbol.for("react.block"):60121,O1=ke?Symbol.for("react.fundamental"):60117,R1=ke?Symbol.for("react.responder"):60118,k1=ke?Symbol.for("react.scope"):60119;function Ke(t){if(typeof t=="object"&&t!==null){var i=t.$$typeof;switch(i){case Oo:switch(t=t.type,t){case ko:case Li:case ki:case Mi:case Bi:case zi:return t;default:switch(t=t&&t.$$typeof,t){case Ii:case Ni:case ji:case Hi:case Fi:return t;default:return i}}case Ro:return i}}}function hc(t){return Ke(t)===Li}we.AsyncMode=ko,we.ConcurrentMode=Li,we.ContextConsumer=Ii,we.ContextProvider=Fi,we.Element=Oo,we.ForwardRef=Ni,we.Fragment=ki,we.Lazy=ji,we.Memo=Hi,we.Portal=Ro,we.Profiler=Mi,we.StrictMode=Bi,we.Suspense=zi,we.isAsyncMode=function(t){return hc(t)||Ke(t)===ko},we.isConcurrentMode=hc,we.isContextConsumer=function(t){return Ke(t)===Ii},we.isContextProvider=function(t){return Ke(t)===Fi},we.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Oo},we.isForwardRef=function(t){return Ke(t)===Ni},we.isFragment=function(t){return Ke(t)===ki},we.isLazy=function(t){return Ke(t)===ji},we.isMemo=function(t){return Ke(t)===Hi},we.isPortal=function(t){return Ke(t)===Ro},we.isProfiler=function(t){return Ke(t)===Mi},we.isStrictMode=function(t){return Ke(t)===Bi},we.isSuspense=function(t){return Ke(t)===zi},we.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===ki||t===Li||t===Mi||t===Bi||t===zi||t===A1||typeof t=="object"&&t!==null&&(t.$$typeof===ji||t.$$typeof===Hi||t.$$typeof===Fi||t.$$typeof===Ii||t.$$typeof===Ni||t.$$typeof===O1||t.$$typeof===R1||t.$$typeof===k1||t.$$typeof===D1)},we.typeOf=Ke,cc.exports=we;var dc=cc.exports,B1={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},M1={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},pc={};pc[dc.ForwardRef]=B1,pc[dc.Memo]=M1;var F1=!0;function fc(t,i,e){var n="";return e.split(" ").forEach(function(r){t[r]!==void 0?i.push(t[r]+";"):n+=r+" "}),n}var Bo=function(t,i,e){var n=t.key+"-"+i.name;(e===!1||F1===!1)&&t.registered[n]===void 0&&(t.registered[n]=i.styles)},gc=function(t,i,e){Bo(t,i,e);var n=t.key+"-"+i.name;if(t.inserted[i.name]===void 0){var r=i;do t.insert(i===r?"."+n:"",r,t.sheet,!0),r=r.next;while(r!==void 0)}};function I1(t){for(var i=0,e,n=0,r=t.length;r>=4;++n,r-=4)e=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,e=(e&65535)*1540483477+((e>>>16)*59797<<16),e^=e>>>24,i=(e&65535)*1540483477+((e>>>16)*59797<<16)^(i&65535)*1540483477+((i>>>16)*59797<<16);switch(r){case 3:i^=(t.charCodeAt(n+2)&255)<<16;case 2:i^=(t.charCodeAt(n+1)&255)<<8;case 1:i^=t.charCodeAt(n)&255,i=(i&65535)*1540483477+((i>>>16)*59797<<16)}return i^=i>>>13,i=(i&65535)*1540483477+((i>>>16)*59797<<16),((i^i>>>15)>>>0).toString(36)}var L1={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},N1=/[A-Z]|^ms/g,z1=/_EMO_([^_]+?)_([^]*?)_EMO_/g,mc=function(t){return t.charCodeAt(1)===45},vc=function(t){return t!=null&&typeof t!="boolean"},Mo=w1(function(t){return mc(t)?t:t.replace(N1,"-$&").toLowerCase()}),yc=function(t,i){switch(t){case"animation":case"animationName":if(typeof i=="string")return i.replace(z1,function(e,n,r){return ht={name:n,styles:r,next:ht},n})}return L1[t]!==1&&!mc(t)&&typeof i=="number"&&i!==0?i+"px":i};function jn(t,i,e){if(e==null)return"";if(e.__emotion_styles!==void 0)return e;switch(typeof e){case"boolean":return"";case"object":{if(e.anim===1)return ht={name:e.name,styles:e.styles,next:ht},e.name;if(e.styles!==void 0){var n=e.next;if(n!==void 0)for(;n!==void 0;)ht={name:n.name,styles:n.styles,next:ht},n=n.next;var r=e.styles+";";return r}return H1(t,i,e)}case"function":{if(t!==void 0){var o=ht,s=e(t);return ht=o,jn(t,i,s)}break}}if(i==null)return e;var a=i[e];return a!==void 0?a:e}function H1(t,i,e){var n="";if(Array.isArray(e))for(var r=0;r<e.length;r++)n+=jn(t,i,e[r])+";";else for(var o in e){var s=e[o];if(typeof s!="object")i!=null&&i[s]!==void 0?n+=o+"{"+i[s]+"}":vc(s)&&(n+=Mo(o)+":"+yc(o,s)+";");else if(Array.isArray(s)&&typeof s[0]=="string"&&(i==null||i[s[0]]===void 0))for(var a=0;a<s.length;a++)vc(s[a])&&(n+=Mo(o)+":"+yc(o,s[a])+";");else{var l=jn(t,i,s);switch(o){case"animation":case"animationName":{n+=Mo(o)+":"+l+";";break}default:n+=o+"{"+l+"}"}}}return n}var wc=/label:\s*([^\s;\n{]+)\s*(;|$)/g,ht,Fo=function(t,i,e){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,r="";ht=void 0;var o=t[0];o==null||o.raw===void 0?(n=!1,r+=jn(e,i,o)):r+=o[0];for(var s=1;s<t.length;s++)r+=jn(e,i,t[s]),n&&(r+=o[s]);wc.lastIndex=0;for(var a="",l;(l=wc.exec(r))!==null;)a+="-"+l[1];var u=I1(r)+a;return{name:u,styles:r,next:ht}},j1=function(t){return t()},V1=Sr.useInsertionEffect?Sr.useInsertionEffect:!1,Ec=V1||j1,Io={}.hasOwnProperty,bc=Sn(typeof HTMLElement<"u"?P1({key:"css"}):null);bc.Provider;var xc=function(t){return Er(function(i,e){var n=_n(bc);return t(i,n,e)})},Sc=Sn({}),Lo="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",U1=function(t,i){var e={};for(var n in i)Io.call(i,n)&&(e[n]=i[n]);return e[Lo]=t,e},W1=function(t){var i=t.cache,e=t.serialized,n=t.isStringTag;return Bo(i,e,n),Ec(function(){return gc(i,e,n)}),null},G1=xc(function(t,i,e){var n=t.css;typeof n=="string"&&i.registered[n]!==void 0&&(n=i.registered[n]);var r=t[Lo],o=[n],s="";typeof t.className=="string"?s=fc(i.registered,o,t.className):t.className!=null&&(s=t.className+" ");var a=Fo(o,void 0,_n(Sc));s+=i.key+"-"+a.name;var l={};for(var u in t)Io.call(t,u)&&u!=="css"&&u!==Lo&&(l[u]=t[u]);return l.ref=e,l.className=s,Oe(et,null,Oe(W1,{cache:i,serialized:a,isStringTag:typeof r=="string"}),Oe(r,l))}),$1=G1,ie=function(t,i){var e=arguments;if(i==null||!Io.call(i,"css"))return Oe.apply(void 0,e);var n=e.length,r=new Array(n);r[0]=$1,r[1]=U1(t,i);for(var o=2;o<n;o++)r[o]=e[o];return Oe.apply(null,r)};function No(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return Fo(i)}var X1=function(){var t=No.apply(void 0,arguments),i="animation-"+t.name;return{name:i,styles:"@keyframes "+i+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},q1=function t(i){for(var e=i.length,n=0,r="";n<e;n++){var o=i[n];if(o!=null){var s=void 0;switch(typeof o){case"boolean":break;case"object":{if(Array.isArray(o))s=t(o);else{s="";for(var a in o)o[a]&&a&&(s&&(s+=" "),s+=a)}break}default:s=o}s&&(r&&(r+=" "),r+=s)}}return r};function Y1(t,i,e){var n=[],r=fc(t,n,e);return n.length<2?e:r+i(n)}var Z1=function(t){var i=t.cache,e=t.serializedArr;return Ec(function(){for(var n=0;n<e.length;n++)gc(i,e[n],!1)}),null},K1=xc(function(t,i){var e=[],n=function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];var c=Fo(l,i.registered);return e.push(c),Bo(i,c,!1),i.key+"-"+c.name},r=function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Y1(i.registered,n,q1(l))},o={css:n,cx:r,theme:_n(Sc)},s=t.children(o);return Oe(et,null,Oe(Z1,{cache:i,serializedArr:e}),s)});function J1(t,i){return i||(i=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(i)}}))}function zo(t,i){if(t==null)return{};var e={},n=Object.keys(t),r,o;for(o=0;o<n.length;o++)r=n[o],!(i.indexOf(r)>=0)&&(e[r]=t[r]);return e}function cn(t,i){if(t==null)return{};var e=zo(t,i),n,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],!(i.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function hn(t){return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},hn(t)}var _c={};Object.defineProperty(_c,"__esModule",{value:!0});var Ho=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Cc=function(){function t(i,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),Tc=Yt,Vn=Pc(Tc),Q1=Pn.exports,De=Pc(Q1);function Pc(t){return t&&t.__esModule?t:{default:t}}function ew(t,i){var e={};for(var n in t)i.indexOf(n)>=0||!Object.prototype.hasOwnProperty.call(t,n)||(e[n]=t[n]);return e}function tw(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function nw(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i&&(typeof i=="object"||typeof i=="function")?i:t}function iw(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}var Ac={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},rw=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],ow=function(t){return rw.forEach(function(i){return delete t[i]}),t},Dc=function(t,i){i.style.fontSize=t.fontSize,i.style.fontFamily=t.fontFamily,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.letterSpacing=t.letterSpacing,i.style.textTransform=t.textTransform},Oc=typeof window<"u"&&window.navigator?/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent):!1,Rc=function(){return Oc?"_"+Math.random().toString(36).substr(2,12):void 0},jo=function(t){iw(i,t),Cc(i,null,[{key:"getDerivedStateFromProps",value:function(e,n){var r=e.id;return r!==n.prevId?{inputId:r||Rc(),prevId:r}:null}}]);function i(e){tw(this,i);var n=nw(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return n.inputRef=function(r){n.input=r,typeof n.props.inputRef=="function"&&n.props.inputRef(r)},n.placeHolderSizerRef=function(r){n.placeHolderSizer=r},n.sizerRef=function(r){n.sizer=r},n.state={inputWidth:e.minWidth,inputId:e.id||Rc(),prevId:e.id},n}return Cc(i,[{key:"componentDidMount",value:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}},{key:"componentDidUpdate",value:function(e,n){n.inputWidth!==this.state.inputWidth&&typeof this.props.onAutosize=="function"&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"copyInputStyles",value:function(){if(!(!this.mounted||!window.getComputedStyle)){var e=this.input&&window.getComputedStyle(this.input);!e||(Dc(e,this.sizer),this.placeHolderSizer&&Dc(e,this.placeHolderSizer))}}},{key:"updateInputWidth",value:function(){if(!(!this.mounted||!this.sizer||typeof this.sizer.scrollWidth>"u")){var e=void 0;this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?e=Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:e=this.sizer.scrollWidth+2;var n=this.props.type==="number"&&this.props.extraWidth===void 0?16:parseInt(this.props.extraWidth)||0;e+=n,e<this.props.minWidth&&(e=this.props.minWidth),e!==this.state.inputWidth&&this.setState({inputWidth:e})}}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"select",value:function(){this.input.select()}},{key:"renderStyles",value:function(){var e=this.props.injectStyles;return Oc&&e?Vn.default.createElement("style",{dangerouslySetInnerHTML:{__html:"input#"+this.state.inputId+"::-ms-clear {display: none;}"}}):null}},{key:"render",value:function(){var e=[this.props.defaultValue,this.props.value,""].reduce(function(s,a){return s??a}),n=Ho({},this.props.style);n.display||(n.display="inline-block");var r=Ho({boxSizing:"content-box",width:this.state.inputWidth+"px"},this.props.inputStyle),o=ew(this.props,[]);return ow(o),o.className=this.props.inputClassName,o.id=this.state.inputId,o.style=r,Vn.default.createElement("div",{className:this.props.className,style:n},this.renderStyles(),Vn.default.createElement("input",Ho({},o,{ref:this.inputRef})),Vn.default.createElement("div",{ref:this.sizerRef,style:Ac},e),this.props.placeholder?Vn.default.createElement("div",{ref:this.placeHolderSizerRef,style:Ac},this.props.placeholder):null)}}]),i}(Tc.Component);jo.propTypes={className:De.default.string,defaultValue:De.default.any,extraWidth:De.default.oneOfType([De.default.number,De.default.string]),id:De.default.string,injectStyles:De.default.bool,inputClassName:De.default.string,inputRef:De.default.func,inputStyle:De.default.object,minWidth:De.default.oneOfType([De.default.number,De.default.string]),onAutosize:De.default.func,onChange:De.default.func,placeholder:De.default.string,placeholderIsMinWidth:De.default.bool,style:De.default.object,value:De.default.any},jo.defaultProps={minWidth:1,injectStyles:!0};var sw=_c.default=jo;function Vi(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function aw(t,i){if(hn(t)!=="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,i||"default");if(hn(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(t)}function kc(t){var i=aw(t,"string");return hn(i)==="symbol"?i:String(i)}function Bc(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kc(n.key),n)}}function Ui(t,i,e){return i&&Bc(t.prototype,i),e&&Bc(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wi(t,i){return Wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},Wi(t,i)}function Gi(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&Wi(t,i)}function Et(t,i,e){return i=kc(i),i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function lw(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function Mc(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,n)}return e}function Le(t){for(var i=1;i<arguments.length;i++){var e=arguments[i]!=null?arguments[i]:{};i%2?Mc(Object(e),!0).forEach(function(n){lw(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Mc(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function $i(t){return $i=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},$i(t)}function uw(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function cw(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hw(t,i){return i&&(typeof i=="object"||typeof i=="function")?i:cw(t)}function Xi(t){var i=uw();return function(){var e=$i(t),n;if(i){var r=$i(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return hw(this,n)}}var qi=function(){};function dw(t,i){return i?i[0]==="-"?t+i:t+"__"+i:t}function pw(t,i,e){var n=[e];if(i&&t)for(var r in i)i.hasOwnProperty(r)&&i[r]&&n.push("".concat(dw(t,r)));return n.filter(function(o){return o}).map(function(o){return String(o).trim()}).join(" ")}var Fc=function(t){return Array.isArray(t)?t.filter(Boolean):hn(t)==="object"&&t!==null?[t]:[]},Ic=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var i=cn(t,["className","clearValue","cx","getStyles","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"]);return Le({},i)};function Vo(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function Lc(t){return Vo(t)?window.pageYOffset:t.scrollTop}function Yi(t,i){if(Vo(t)){window.scrollTo(0,i);return}t.scrollTop=i}function fw(t){var i=getComputedStyle(t),e=i.position==="absolute",n=/(auto|scroll)/,r=document.documentElement;if(i.position==="fixed")return r;for(var o=t;o=o.parentElement;)if(i=getComputedStyle(o),!(e&&i.position==="static")&&n.test(i.overflow+i.overflowY+i.overflowX))return o;return r}function gw(t,i,e,n){return e*((t=t/n-1)*t*t+1)+i}function Zi(t,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:qi,r=Lc(t),o=i-r,s=10,a=0;function l(){a+=s;var u=gw(a,r,o,e);Yi(t,u),a<e?window.requestAnimationFrame(l):n(t)}l()}function mw(t,i){var e=t.getBoundingClientRect(),n=i.getBoundingClientRect(),r=i.offsetHeight/3;n.bottom+r>e.bottom?Yi(t,Math.min(i.offsetTop+i.clientHeight-t.offsetHeight+r,t.scrollHeight)):n.top-r<e.top&&Yi(t,Math.max(i.offsetTop-r,0))}function vw(t){var i=t.getBoundingClientRect();return{bottom:i.bottom,height:i.height,left:i.left,right:i.right,top:i.top,width:i.width}}function Nc(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function yw(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var zc=!1,ww={get passive(){return zc=!0}},Ki=typeof window<"u"?window:{};Ki.addEventListener&&Ki.removeEventListener&&(Ki.addEventListener("p",qi,ww),Ki.removeEventListener("p",qi,!1));var Ew=zc;function bw(t){var i=t.maxHeight,e=t.menuEl,n=t.minHeight,r=t.placement,o=t.shouldScroll,s=t.isFixedPosition,a=t.theme,l=a.spacing,u=fw(e),c={placement:"bottom",maxHeight:i};if(!e||!e.offsetParent)return c;var h=u.getBoundingClientRect(),d=h.height,g=e.getBoundingClientRect(),y=g.bottom,S=g.height,E=g.top,C=e.offsetParent.getBoundingClientRect(),p=C.top,x=window.innerHeight,A=Lc(u),P=parseInt(getComputedStyle(e).marginBottom,10),D=parseInt(getComputedStyle(e).marginTop,10),O=p-D,I=x-E,N=O+A,W=d-A-E,q=y-x+A+P,G=A+E-D,J=160;switch(r){case"auto":case"bottom":if(I>=S)return{placement:"bottom",maxHeight:i};if(W>=S&&!s)return o&&Zi(u,q,J),{placement:"bottom",maxHeight:i};if(!s&&W>=n||s&&I>=n){o&&Zi(u,q,J);var K=s?I-P:W-P;return{placement:"bottom",maxHeight:K}}if(r==="auto"||s){var oe=i,re=s?O:N;return re>=n&&(oe=Math.min(re-P-l.controlHeight,i)),{placement:"top",maxHeight:oe}}if(r==="bottom")return o&&Yi(u,q),{placement:"bottom",maxHeight:i};break;case"top":if(O>=S)return{placement:"top",maxHeight:i};if(N>=S&&!s)return o&&Zi(u,G,J),{placement:"top",maxHeight:i};if(!s&&N>=n||s&&O>=n){var ae=i;return(!s&&N>=n||s&&O>=n)&&(ae=s?O-D:N-D),o&&Zi(u,G,J),{placement:"top",maxHeight:ae}}return{placement:"bottom",maxHeight:i};default:throw new Error('Invalid placement provided "'.concat(r,'".'))}return c}function xw(t){var i={bottom:"top",top:"bottom"};return t?i[t]:"bottom"}var Uo=function(t){return t==="auto"?"bottom":t},Sw=function(t){var i,e=t.placement,n=t.theme,r=n.borderRadius,o=n.spacing,s=n.colors;return i={label:"menu"},Et(i,xw(e),"100%"),Et(i,"backgroundColor",s.neutral0),Et(i,"borderRadius",r),Et(i,"boxShadow","0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)"),Et(i,"marginBottom",o.menuGutter),Et(i,"marginTop",o.menuGutter),Et(i,"position","absolute"),Et(i,"width","100%"),Et(i,"zIndex",1),i},Hc=Sn({getPortalPlacement:null}),jc=function(t){Gi(e,t);var i=Xi(e);function e(){var n;Vi(this,e);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return n=i.call.apply(i,[this].concat(o)),n.state={maxHeight:n.props.maxMenuHeight,placement:null},n.getPlacement=function(a){var l=n.props,u=l.minMenuHeight,c=l.maxMenuHeight,h=l.menuPlacement,d=l.menuPosition,g=l.menuShouldScrollIntoView,y=l.theme;if(a){var S=d==="fixed",E=g&&!S,C=bw({maxHeight:c,menuEl:a,minHeight:u,placement:h,shouldScroll:E,isFixedPosition:S,theme:y}),p=n.context.getPortalPlacement;p&&p(C),n.setState(C)}},n.getUpdatedProps=function(){var a=n.props.menuPlacement,l=n.state.placement||Uo(a);return Le(Le({},n.props),{},{placement:l,maxHeight:n.state.maxHeight})},n}return Ui(e,[{key:"render",value:function(){var n=this.props.children;return n({ref:this.getPlacement,placerProps:this.getUpdatedProps()})}}]),e}(Ae);jc.contextType=Hc;var _w=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerRef,s=t.innerProps;return ie("div",ne({css:r("menu",t),className:n({menu:!0},e),ref:o},s),i)},Cw=function(t){var i=t.maxHeight,e=t.theme.spacing.baseUnit;return{maxHeight:i,overflowY:"auto",paddingBottom:e,paddingTop:e,position:"relative",WebkitOverflowScrolling:"touch"}},Tw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps,s=t.innerRef,a=t.isMulti;return ie("div",ne({css:r("menuList",t),className:n({"menu-list":!0,"menu-list--is-multi":a},e),ref:s},o),i)},Vc=function(t){var i=t.theme,e=i.spacing.baseUnit,n=i.colors;return{color:n.neutral40,padding:"".concat(e*2,"px ").concat(e*3,"px"),textAlign:"center"}},Pw=Vc,Aw=Vc,Uc=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps;return ie("div",ne({css:r("noOptionsMessage",t),className:n({"menu-notice":!0,"menu-notice--no-options":!0},e)},o),i)};Uc.defaultProps={children:"No options"};var Wc=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps;return ie("div",ne({css:r("loadingMessage",t),className:n({"menu-notice":!0,"menu-notice--loading":!0},e)},o),i)};Wc.defaultProps={children:"Loading..."};var Dw=function(t){var i=t.rect,e=t.offset,n=t.position;return{left:i.left,position:n,top:e,width:i.width,zIndex:1}},Ow=function(t){Gi(e,t);var i=Xi(e);function e(){var n;Vi(this,e);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return n=i.call.apply(i,[this].concat(o)),n.state={placement:null},n.getPortalPlacement=function(a){var l=a.placement,u=Uo(n.props.menuPlacement);l!==u&&n.setState({placement:l})},n}return Ui(e,[{key:"render",value:function(){var n=this.props,r=n.appendTo,o=n.children,s=n.className,a=n.controlElement,l=n.cx,u=n.innerProps,c=n.menuPlacement,h=n.menuPosition,d=n.getStyles,g=h==="fixed";if(!r&&!g||!a)return null;var y=this.state.placement||Uo(c),S=vw(a),E=g?0:window.pageYOffset,C=S[y]+E,p={offset:C,position:h,rect:S},x=ie("div",ne({css:d("menuPortal",p),className:l({"menu-portal":!0},s)},u),o);return ie(Hc.Provider,{value:{getPortalPlacement:this.getPortalPlacement}},r?br(x,r):x)}}]),e}(Ae),Rw=function(t){var i=t.isDisabled,e=t.isRtl;return{label:"container",direction:e?"rtl":null,pointerEvents:i?"none":null,position:"relative"}},kw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps,s=t.isDisabled,a=t.isRtl;return ie("div",ne({css:r("container",t),className:n({"--is-disabled":s,"--is-rtl":a},e)},o),i)},Bw=function(t){var i=t.theme.spacing;return{alignItems:"center",display:"flex",flex:1,flexWrap:"wrap",padding:"".concat(i.baseUnit/2,"px ").concat(i.baseUnit*2,"px"),WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"}},Mw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.innerProps,o=t.isMulti,s=t.getStyles,a=t.hasValue;return ie("div",ne({css:s("valueContainer",t),className:n({"value-container":!0,"value-container--is-multi":o,"value-container--has-value":a},e)},r),i)},Fw=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Iw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.innerProps,o=t.getStyles;return ie("div",ne({css:o("indicatorsContainer",t),className:n({indicators:!0},e)},r),i)},Gc,Lw={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},$c=function(t){var i=t.size,e=cn(t,["size"]);return ie("svg",ne({height:i,width:i,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Lw},e))},Wo=function(t){return ie($c,ne({size:20},t),ie("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Xc=function(t){return ie($c,ne({size:20},t),ie("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},qc=function(t){var i=t.isFocused,e=t.theme,n=e.spacing.baseUnit,r=e.colors;return{label:"indicatorContainer",color:i?r.neutral60:r.neutral20,display:"flex",padding:n*2,transition:"color 150ms",":hover":{color:i?r.neutral80:r.neutral40}}},Nw=qc,zw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps;return ie("div",ne({css:r("dropdownIndicator",t),className:n({indicator:!0,"dropdown-indicator":!0},e)},o),i||ie(Xc,null))},Hw=qc,jw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps;return ie("div",ne({css:r("clearIndicator",t),className:n({indicator:!0,"clear-indicator":!0},e)},o),i||ie(Wo,null))},Vw=function(t){var i=t.isDisabled,e=t.theme,n=e.spacing.baseUnit,r=e.colors;return{label:"indicatorSeparator",alignSelf:"stretch",backgroundColor:i?r.neutral10:r.neutral20,marginBottom:n*2,marginTop:n*2,width:1}},Uw=function(t){var i=t.className,e=t.cx,n=t.getStyles,r=t.innerProps;return ie("span",ne({},r,{css:n("indicatorSeparator",t),className:e({"indicator-separator":!0},i)}))},Ww=X1(Gc||(Gc=J1([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),Gw=function(t){var i=t.isFocused,e=t.size,n=t.theme,r=n.colors,o=n.spacing.baseUnit;return{label:"loadingIndicator",color:i?r.neutral60:r.neutral20,display:"flex",padding:o*2,transition:"color 150ms",alignSelf:"center",fontSize:e,lineHeight:1,marginRight:e,textAlign:"center",verticalAlign:"middle"}},Go=function(t){var i=t.delay,e=t.offset;return ie("span",{css:No({animation:"".concat(Ww," 1s ease-in-out ").concat(i,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:e?"1em":null,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Yc=function(t){var i=t.className,e=t.cx,n=t.getStyles,r=t.innerProps,o=t.isRtl;return ie("div",ne({css:n("loadingIndicator",t),className:e({indicator:!0,"loading-indicator":!0},i)},r),ie(Go,{delay:0,offset:o}),ie(Go,{delay:160,offset:!0}),ie(Go,{delay:320,offset:!o}))};Yc.defaultProps={size:4};var $w=function(t){var i=t.isDisabled,e=t.isFocused,n=t.theme,r=n.colors,o=n.borderRadius,s=n.spacing;return{label:"control",alignItems:"center",backgroundColor:i?r.neutral5:r.neutral0,borderColor:i?r.neutral10:e?r.primary:r.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:e?"0 0 0 1px ".concat(r.primary):null,cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:s.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms","&:hover":{borderColor:e?r.primary:r.neutral30}}},Xw=function(t){var i=t.children,e=t.cx,n=t.getStyles,r=t.className,o=t.isDisabled,s=t.isFocused,a=t.innerRef,l=t.innerProps,u=t.menuIsOpen;return ie("div",ne({ref:a,css:n("control",t),className:e({control:!0,"control--is-disabled":o,"control--is-focused":s,"control--menu-is-open":u},r)},l),i)},qw=function(t){var i=t.theme.spacing;return{paddingBottom:i.baseUnit*2,paddingTop:i.baseUnit*2}},Yw=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.Heading,s=t.headingProps,a=t.innerProps,l=t.label,u=t.theme,c=t.selectProps;return ie("div",ne({css:r("group",t),className:n({group:!0},e)},a),ie(o,ne({},s,{selectProps:c,theme:u,getStyles:r,cx:n}),l),ie("div",null,i))},Zw=function(t){var i=t.theme.spacing;return{label:"group",color:"#999",cursor:"default",display:"block",fontSize:"75%",fontWeight:"500",marginBottom:"0.25em",paddingLeft:i.baseUnit*3,paddingRight:i.baseUnit*3,textTransform:"uppercase"}},Kw=function(t){var i=t.getStyles,e=t.cx,n=t.className,r=Ic(t);r.data;var o=cn(r,["data"]);return ie("div",ne({css:i("groupHeading",t),className:e({"group-heading":!0},n)},o))},Jw=function(t){var i=t.isDisabled,e=t.theme,n=e.spacing,r=e.colors;return{margin:n.baseUnit/2,paddingBottom:n.baseUnit/2,paddingTop:n.baseUnit/2,visibility:i?"hidden":"visible",color:r.neutral80}},Qw=function(t){return{label:"input",background:0,border:0,fontSize:"inherit",opacity:t?0:1,outline:0,padding:0,color:"inherit"}},eE=function(t){var i=t.className,e=t.cx,n=t.getStyles,r=Ic(t),o=r.innerRef,s=r.isDisabled,a=r.isHidden,l=cn(r,["innerRef","isDisabled","isHidden"]);return ie("div",{css:n("input",t)},ie(sw,ne({className:e({input:!0},i),inputRef:o,inputStyle:Qw(a),disabled:s},l)))},tE=function(t){var i=t.theme,e=i.spacing,n=i.borderRadius,r=i.colors;return{label:"multiValue",backgroundColor:r.neutral10,borderRadius:n/2,display:"flex",margin:e.baseUnit/2,minWidth:0}},nE=function(t){var i=t.theme,e=i.borderRadius,n=i.colors,r=t.cropWithEllipsis;return{borderRadius:e/2,color:n.neutral80,fontSize:"85%",overflow:"hidden",padding:3,paddingLeft:6,textOverflow:r?"ellipsis":null,whiteSpace:"nowrap"}},iE=function(t){var i=t.theme,e=i.spacing,n=i.borderRadius,r=i.colors,o=t.isFocused;return{alignItems:"center",borderRadius:n/2,backgroundColor:o&&r.dangerLight,display:"flex",paddingLeft:e.baseUnit,paddingRight:e.baseUnit,":hover":{backgroundColor:r.dangerLight,color:r.danger}}},Zc=function(t){var i=t.children,e=t.innerProps;return ie("div",e,i)},rE=Zc,oE=Zc;function sE(t){var i=t.children,e=t.innerProps;return ie("div",e,i||ie(Wo,{size:14}))}var Kc=function(t){var i=t.children,e=t.className,n=t.components,r=t.cx,o=t.data,s=t.getStyles,a=t.innerProps,l=t.isDisabled,u=t.removeProps,c=t.selectProps,h=n.Container,d=n.Label,g=n.Remove;return ie(K1,null,function(y){var S=y.css,E=y.cx;return ie(h,{data:o,innerProps:Le({className:E(S(s("multiValue",t)),r({"multi-value":!0,"multi-value--is-disabled":l},e))},a),selectProps:c},ie(d,{data:o,innerProps:{className:E(S(s("multiValueLabel",t)),r({"multi-value__label":!0},e))},selectProps:c},i),ie(g,{data:o,innerProps:Le({className:E(S(s("multiValueRemove",t)),r({"multi-value__remove":!0},e))},u),selectProps:c}))})};Kc.defaultProps={cropWithEllipsis:!0};var aE=function(t){var i=t.isDisabled,e=t.isFocused,n=t.isSelected,r=t.theme,o=r.spacing,s=r.colors;return{label:"option",backgroundColor:n?s.primary:e?s.primary25:"transparent",color:i?s.neutral20:n?s.neutral0:"inherit",cursor:"default",display:"block",fontSize:"inherit",padding:"".concat(o.baseUnit*2,"px ").concat(o.baseUnit*3,"px"),width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",":active":{backgroundColor:!i&&(n?s.primary:s.primary50)}}},lE=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.isDisabled,s=t.isFocused,a=t.isSelected,l=t.innerRef,u=t.innerProps;return ie("div",ne({css:r("option",t),className:n({option:!0,"option--is-disabled":o,"option--is-focused":s,"option--is-selected":a},e),ref:l},u),i)},uE=function(t){var i=t.theme,e=i.spacing,n=i.colors;return{label:"placeholder",color:n.neutral50,marginLeft:e.baseUnit/2,marginRight:e.baseUnit/2,position:"absolute",top:"50%",transform:"translateY(-50%)"}},cE=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.innerProps;return ie("div",ne({css:r("placeholder",t),className:n({placeholder:!0},e)},o),i)},hE=function(t){var i=t.isDisabled,e=t.theme,n=e.spacing,r=e.colors;return{label:"singleValue",color:i?r.neutral40:r.neutral80,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2,maxWidth:"calc(100% - ".concat(n.baseUnit*2,"px)"),overflow:"hidden",position:"absolute",textOverflow:"ellipsis",whiteSpace:"nowrap",top:"50%",transform:"translateY(-50%)"}},dE=function(t){var i=t.children,e=t.className,n=t.cx,r=t.getStyles,o=t.isDisabled,s=t.innerProps;return ie("div",ne({css:r("singleValue",t),className:n({"single-value":!0,"single-value--is-disabled":o},e)},s),i)},pE={ClearIndicator:jw,Control:Xw,DropdownIndicator:zw,DownChevron:Xc,CrossIcon:Wo,Group:Yw,GroupHeading:Kw,IndicatorsContainer:Iw,IndicatorSeparator:Uw,Input:eE,LoadingIndicator:Yc,Menu:_w,MenuList:Tw,MenuPortal:Ow,LoadingMessage:Wc,NoOptionsMessage:Uc,MultiValue:Kc,MultiValueContainer:rE,MultiValueLabel:oE,MultiValueRemove:sE,Option:lE,Placeholder:cE,SelectContainer:kw,SingleValue:dE,ValueContainer:Mw},fE=function(t){return Le(Le({},pE),t.components)};function $o(t,i){(i==null||i>t.length)&&(i=t.length);for(var e=0,n=new Array(i);e<i;e++)n[e]=t[e];return n}function gE(t){if(Array.isArray(t))return $o(t)}function mE(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vE(t,i){if(t){if(typeof t=="string")return $o(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $o(t,i)}}function yE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jc(t){return gE(t)||mE(t)||vE(t)||yE()}var Qc=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function wE(t,i){return!!(t===i||Qc(t)&&Qc(i))}function EE(t,i){if(t.length!==i.length)return!1;for(var e=0;e<t.length;e++)if(!wE(t[e],i[e]))return!1;return!0}function bE(t,i){i===void 0&&(i=EE);var e,n=[],r,o=!1;function s(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];return o&&e===this&&i(a,n)||(r=t.apply(this,a),o=!0,e=this,n=a),r}return s}for(var xE={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},SE=function(t){return ie("span",ne({css:xE},t))},_E={guidance:function(t){var i=t.isSearchable,e=t.isMulti,n=t.isDisabled,r=t.tabSelectsValue,o=t.context;switch(o){case"menu":return"Use Up and Down to choose options".concat(n?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(r?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(t["aria-label"]||"Select"," is focused ").concat(i?",type to refine list":"",", press Down to open the menu, ").concat(e?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var i=t.action,e=t.label,n=e===void 0?"":e,r=t.isDisabled;switch(i){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"select-option":return r?"option ".concat(n," is disabled. Select another option."):"option ".concat(n,", selected.");default:return""}},onFocus:function(t){var i=t.context,e=t.focused,n=e===void 0?{}:e,r=t.options,o=t.label,s=o===void 0?"":o,a=t.selectValue,l=t.isDisabled,u=t.isSelected,c=function(g,y){return g&&g.length?"".concat(g.indexOf(y)+1," of ").concat(g.length):""};if(i==="value"&&a)return"value ".concat(s," focused, ").concat(c(a,n),".");if(i==="menu"){var h=l?" disabled":"",d="".concat(u?"selected":"focused").concat(h);return"option ".concat(s," ").concat(d,", ").concat(c(r,n),".")}return""},onFilter:function(t){var i=t.inputValue,e=t.resultsMessage;return"".concat(e).concat(i?" for search term "+i:"",".")}},CE=function(t){var i=t.ariaSelection,e=t.focusedOption,n=t.focusedValue,r=t.focusableOptions,o=t.isFocused,s=t.selectValue,a=t.selectProps,l=a.ariaLiveMessages,u=a.getOptionLabel,c=a.inputValue,h=a.isMulti,d=a.isOptionDisabled,g=a.isSearchable,y=a.menuIsOpen,S=a.options,E=a.screenReaderStatus,C=a.tabSelectsValue,p=a["aria-label"],x=a["aria-live"],A=vt(function(){return Le(Le({},_E),l||{})},[l]),P=vt(function(){var W="";if(i&&A.onChange){var q=i.option,G=i.removedValue,J=i.value,K=function(ae){return Array.isArray(ae)?null:ae},oe=G||q||K(J),re=Le({isDisabled:oe&&d(oe),label:oe?u(oe):""},i);W=A.onChange(re)}return W},[i,d,u,A]),D=vt(function(){var W="",q=e||n,G=!!(e&&s&&s.includes(e));if(q&&A.onFocus){var J={focused:q,label:u(q),isDisabled:d(q),isSelected:G,options:S,context:q===e?"menu":"value",selectValue:s};W=A.onFocus(J)}return W},[e,n,u,d,A,S,s]),O=vt(function(){var W="";if(y&&S.length&&A.onFilter){var q=E({count:r.length});W=A.onFilter({inputValue:c,resultsMessage:q})}return W},[r,c,y,A,S,E]),I=vt(function(){var W="";if(A.guidance){var q=n?"value":y?"menu":"input";W=A.guidance({"aria-label":p,context:q,isDisabled:e&&d(e),isMulti:h,isSearchable:g,tabSelectsValue:C})}return W},[p,e,n,h,d,g,y,A,C]),N="".concat(D," ").concat(O," ").concat(I);return ie(SE,{"aria-live":x,"aria-atomic":"false","aria-relevant":"additions text"},o&&ie(B.Fragment,null,ie("span",{id:"aria-selection"},P),ie("span",{id:"aria-context"},N)))},Xo=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],TE=new RegExp("["+Xo.map(function(t){return t.letters}).join("")+"]","g"),eh={},qo=0;qo<Xo.length;qo++)for(var Yo=Xo[qo],Zo=0;Zo<Yo.letters.length;Zo++)eh[Yo.letters[Zo]]=Yo.base;var th=function(t){return t.replace(TE,function(i){return eh[i]})},PE=bE(th),nh=function(t){return t.replace(/^\s+|\s+$/g,"")},AE=function(t){return"".concat(t.label," ").concat(t.value)},DE=function(t){return function(i,e){var n=Le({ignoreCase:!0,ignoreAccents:!0,stringify:AE,trim:!0,matchFrom:"any"},t),r=n.ignoreCase,o=n.ignoreAccents,s=n.stringify,a=n.trim,l=n.matchFrom,u=a?nh(e):e,c=a?nh(s(i)):s(i);return r&&(u=u.toLowerCase(),c=c.toLowerCase()),o&&(u=PE(u),c=th(c)),l==="start"?c.substr(0,u.length)===u:c.indexOf(u)>-1}};function OE(t){t.in,t.out,t.onExited,t.appear,t.enter,t.exit;var i=t.innerRef;t.emotion;var e=cn(t,["in","out","onExited","appear","enter","exit","innerRef","emotion"]);return ie("input",ne({ref:i},e,{css:No({label:"dummyInput",background:0,border:0,fontSize:"inherit",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(0)"},"","")}))}var RE=function(t){t.preventDefault(),t.stopPropagation()};function kE(t){var i=t.isEnabled,e=t.onBottomArrive,n=t.onBottomLeave,r=t.onTopArrive,o=t.onTopLeave,s=rt(!1),a=rt(!1),l=rt(0),u=rt(null),c=ot(function(E,C){if(u.current!==null){var p=u.current,x=p.scrollTop,A=p.scrollHeight,P=p.clientHeight,D=u.current,O=C>0,I=A-P-x,N=!1;I>C&&s.current&&(n&&n(E),s.current=!1),O&&a.current&&(o&&o(E),a.current=!1),O&&C>I?(e&&!s.current&&e(E),D.scrollTop=A,N=!0,s.current=!0):!O&&-C>x&&(r&&!a.current&&r(E),D.scrollTop=0,N=!0,a.current=!0),N&&RE(E)}},[]),h=ot(function(E){c(E,E.deltaY)},[c]),d=ot(function(E){l.current=E.changedTouches[0].clientY},[]),g=ot(function(E){var C=l.current-E.changedTouches[0].clientY;c(E,C)},[c]),y=ot(function(E){if(E){var C=Ew?{passive:!1}:!1;typeof E.addEventListener=="function"&&E.addEventListener("wheel",h,C),typeof E.addEventListener=="function"&&E.addEventListener("touchstart",d,C),typeof E.addEventListener=="function"&&E.addEventListener("touchmove",g,C)}},[g,d,h]),S=ot(function(E){!E||(typeof E.removeEventListener=="function"&&E.removeEventListener("wheel",h,!1),typeof E.removeEventListener=="function"&&E.removeEventListener("touchstart",d,!1),typeof E.removeEventListener=="function"&&E.removeEventListener("touchmove",g,!1))},[g,d,h]);return Bt(function(){if(i){var E=u.current;return y(E),function(){S(E)}}},[i,y,S]),function(E){u.current=E}}var ih=["boxSizing","height","overflow","paddingRight","position"],rh={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function oh(t){t.preventDefault()}function sh(t){t.stopPropagation()}function ah(){var t=this.scrollTop,i=this.scrollHeight,e=t+this.offsetHeight;t===0?this.scrollTop=1:e===i&&(this.scrollTop=t-1)}function lh(){return"ontouchstart"in window||navigator.maxTouchPoints}var uh=!!(typeof window<"u"&&window.document&&window.document.createElement),Un=0,dn={capture:!1,passive:!1};function BE(t){var i=t.isEnabled,e=t.accountForScrollbars,n=e===void 0?!0:e,r=rt({}),o=rt(null),s=ot(function(l){if(uh){var u=document.body,c=u&&u.style;if(n&&ih.forEach(function(y){var S=c&&c[y];r.current[y]=S}),n&&Un<1){var h=parseInt(r.current.paddingRight,10)||0,d=document.body?document.body.clientWidth:0,g=window.innerWidth-d+h||0;Object.keys(rh).forEach(function(y){var S=rh[y];c&&(c[y]=S)}),c&&(c.paddingRight="".concat(g,"px"))}u&&lh()&&(u.addEventListener("touchmove",oh,dn),l&&(l.addEventListener("touchstart",ah,dn),l.addEventListener("touchmove",sh,dn))),Un+=1}},[]),a=ot(function(l){if(uh){var u=document.body,c=u&&u.style;Un=Math.max(Un-1,0),n&&Un<1&&ih.forEach(function(h){var d=r.current[h];c&&(c[h]=d)}),u&&lh()&&(u.removeEventListener("touchmove",oh,dn),l&&(l.removeEventListener("touchstart",ah,dn),l.removeEventListener("touchmove",sh,dn)))}},[]);return Bt(function(){if(i){var l=o.current;return s(l),function(){a(l)}}},[i,s,a]),function(l){o.current=l}}var ME=function(){return document.activeElement&&document.activeElement.blur()},FE={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function IE(t){var i=t.children,e=t.lockEnabled,n=t.captureEnabled,r=n===void 0?!0:n,o=t.onBottomArrive,s=t.onBottomLeave,a=t.onTopArrive,l=t.onTopLeave,u=kE({isEnabled:r,onBottomArrive:o,onBottomLeave:s,onTopArrive:a,onTopLeave:l}),c=BE({isEnabled:e}),h=function(d){u(d),c(d)};return ie(B.Fragment,null,e&&ie("div",{onClick:ME,css:FE}),i(h))}var LE=function(t){return t.label},NE=function(t){return t.label},zE=function(t){return t.value},HE=function(t){return!!t.isDisabled},jE={clearIndicator:Hw,container:Rw,control:$w,dropdownIndicator:Nw,group:qw,groupHeading:Zw,indicatorsContainer:Fw,indicatorSeparator:Vw,input:Jw,loadingIndicator:Gw,loadingMessage:Aw,menu:Sw,menuList:Cw,menuPortal:Dw,multiValue:tE,multiValueLabel:nE,multiValueRemove:iE,noOptionsMessage:Pw,option:aE,placeholder:uE,singleValue:hE,valueContainer:Bw},VE={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},UE=4,ch=4,WE=38,GE=ch*2,$E={baseUnit:ch,controlHeight:WE,menuGutter:GE},Ko={borderRadius:UE,colors:VE,spacing:$E},XE={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Nc(),captureMenuScroll:!Nc(),closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:DE(),formatGroupLabel:LE,getOptionLabel:NE,getOptionValue:zE,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:HE,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!yw(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var i=t.count;return"".concat(i," result").concat(i!==1?"s":""," available")},styles:{},tabIndex:"0",tabSelectsValue:!0};function hh(t,i,e,n){var r=mh(t,i,e),o=vh(t,i,e),s=gh(t,i),a=Ji(t,i);return{type:"option",data:i,isDisabled:r,isSelected:o,label:s,value:a,index:n}}function dh(t,i){return t.options.map(function(e,n){if(e.options){var r=e.options.map(function(s,a){return hh(t,s,i,a)}).filter(function(s){return fh(t,s)});return r.length>0?{type:"group",data:e,options:r,index:n}:void 0}var o=hh(t,e,i,n);return fh(t,o)?o:void 0}).filter(function(e){return!!e})}function ph(t){return t.reduce(function(i,e){return e.type==="group"?i.push.apply(i,Jc(e.options.map(function(n){return n.data}))):i.push(e.data),i},[])}function qE(t,i){return ph(dh(t,i))}function fh(t,i){var e=t.inputValue,n=e===void 0?"":e,r=i.data,o=i.isSelected,s=i.label,a=i.value;return(!wh(t)||!o)&&yh(t,{label:s,value:a,data:r},n)}function YE(t,i){var e=t.focusedValue,n=t.selectValue,r=n.indexOf(e);if(r>-1){var o=i.indexOf(e);if(o>-1)return e;if(r<i.length)return i[r]}return null}function ZE(t,i){var e=t.focusedOption;return e&&i.indexOf(e)>-1?e:i[0]}var gh=function(t,i){return t.getOptionLabel(i)},Ji=function(t,i){return t.getOptionValue(i)};function mh(t,i,e){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(i,e):!1}function vh(t,i,e){if(e.indexOf(i)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(i,e);var n=Ji(t,i);return e.some(function(r){return Ji(t,r)===n})}function yh(t,i,e){return t.filterOption?t.filterOption(i,e):!0}var wh=function(t){var i=t.hideSelectedOptions,e=t.isMulti;return i===void 0?e:i},KE=1,Eh=function(t){Gi(e,t);var i=Xi(e);function e(n){var r;return Vi(this,e),r=i.call(this,n),r.state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},r.blockOptionHover=!1,r.isComposing=!1,r.commonProps=void 0,r.initialTouchX=0,r.initialTouchY=0,r.instancePrefix="",r.openAfterFocus=!1,r.scrollToFocusedOptionOnUpdate=!1,r.userIsDragging=void 0,r.controlRef=null,r.getControlRef=function(o){r.controlRef=o},r.focusedOptionRef=null,r.getFocusedOptionRef=function(o){r.focusedOptionRef=o},r.menuListRef=null,r.getMenuListRef=function(o){r.menuListRef=o},r.inputRef=null,r.getInputRef=function(o){r.inputRef=o},r.focus=r.focusInput,r.blur=r.blurInput,r.onChange=function(o,s){var a=r.props,l=a.onChange,u=a.name;s.name=u,r.ariaOnChange(o,s),l(o,s)},r.setValue=function(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set-value",a=arguments.length>2?arguments[2]:void 0,l=r.props,u=l.closeMenuOnSelect,c=l.isMulti;r.onInputChange("",{action:"set-value"}),u&&(r.setState({inputIsHiddenAfterUpdate:!c}),r.onMenuClose()),r.setState({clearFocusValueOnUpdate:!0}),r.onChange(o,{action:s,option:a})},r.selectOption=function(o){var s=r.props,a=s.blurInputOnSelect,l=s.isMulti,u=s.name,c=r.state.selectValue,h=l&&r.isOptionSelected(o,c),d=r.isOptionDisabled(o,c);if(h){var g=r.getOptionValue(o);r.setValue(c.filter(function(y){return r.getOptionValue(y)!==g}),"deselect-option",o)}else if(!d)l?r.setValue([].concat(Jc(c),[o]),"select-option",o):r.setValue(o,"select-option");else{r.ariaOnChange(o,{action:"select-option",name:u});return}a&&r.blurInput()},r.removeValue=function(o){var s=r.props.isMulti,a=r.state.selectValue,l=r.getOptionValue(o),u=a.filter(function(h){return r.getOptionValue(h)!==l}),c=s?u:u[0]||null;r.onChange(c,{action:"remove-value",removedValue:o}),r.focusInput()},r.clearValue=function(){var o=r.state.selectValue;r.onChange(r.props.isMulti?[]:null,{action:"clear",removedValues:o})},r.popValue=function(){var o=r.props.isMulti,s=r.state.selectValue,a=s[s.length-1],l=s.slice(0,s.length-1),u=o?l:l[0]||null;r.onChange(u,{action:"pop-value",removedValue:a})},r.getValue=function(){return r.state.selectValue},r.cx=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return pw.apply(void 0,[r.props.classNamePrefix].concat(s))},r.getOptionLabel=function(o){return gh(r.props,o)},r.getOptionValue=function(o){return Ji(r.props,o)},r.getStyles=function(o,s){var a=jE[o](s);a.boxSizing="border-box";var l=r.props.styles[o];return l?l(a,s):a},r.getElementId=function(o){return"".concat(r.instancePrefix,"-").concat(o)},r.getComponents=function(){return fE(r.props)},r.buildCategorizedOptions=function(){return dh(r.props,r.state.selectValue)},r.getCategorizedOptions=function(){return r.props.menuIsOpen?r.buildCategorizedOptions():[]},r.buildFocusableOptions=function(){return ph(r.buildCategorizedOptions())},r.getFocusableOptions=function(){return r.props.menuIsOpen?r.buildFocusableOptions():[]},r.ariaOnChange=function(o,s){r.setState({ariaSelection:Le({value:o},s)})},r.onMenuMouseDown=function(o){o.button===0&&(o.stopPropagation(),o.preventDefault(),r.focusInput())},r.onMenuMouseMove=function(o){r.blockOptionHover=!1},r.onControlMouseDown=function(o){var s=r.props.openMenuOnClick;r.state.isFocused?r.props.menuIsOpen?o.target.tagName!=="INPUT"&&o.target.tagName!=="TEXTAREA"&&r.onMenuClose():s&&r.openMenu("first"):(s&&(r.openAfterFocus=!0),r.focusInput()),o.target.tagName!=="INPUT"&&o.target.tagName!=="TEXTAREA"&&o.preventDefault()},r.onDropdownIndicatorMouseDown=function(o){if(!(o&&o.type==="mousedown"&&o.button!==0)&&!r.props.isDisabled){var s=r.props,a=s.isMulti,l=s.menuIsOpen;r.focusInput(),l?(r.setState({inputIsHiddenAfterUpdate:!a}),r.onMenuClose()):r.openMenu("first"),o.preventDefault(),o.stopPropagation()}},r.onClearIndicatorMouseDown=function(o){o&&o.type==="mousedown"&&o.button!==0||(r.clearValue(),o.stopPropagation(),r.openAfterFocus=!1,o.type==="touchend"?r.focusInput():setTimeout(function(){return r.focusInput()}))},r.onScroll=function(o){typeof r.props.closeMenuOnScroll=="boolean"?o.target instanceof HTMLElement&&Vo(o.target)&&r.props.onMenuClose():typeof r.props.closeMenuOnScroll=="function"&&r.props.closeMenuOnScroll(o)&&r.props.onMenuClose()},r.onCompositionStart=function(){r.isComposing=!0},r.onCompositionEnd=function(){r.isComposing=!1},r.onTouchStart=function(o){var s=o.touches,a=s&&s.item(0);!a||(r.initialTouchX=a.clientX,r.initialTouchY=a.clientY,r.userIsDragging=!1)},r.onTouchMove=function(o){var s=o.touches,a=s&&s.item(0);if(a){var l=Math.abs(a.clientX-r.initialTouchX),u=Math.abs(a.clientY-r.initialTouchY),c=5;r.userIsDragging=l>c||u>c}},r.onTouchEnd=function(o){r.userIsDragging||(r.controlRef&&!r.controlRef.contains(o.target)&&r.menuListRef&&!r.menuListRef.contains(o.target)&&r.blurInput(),r.initialTouchX=0,r.initialTouchY=0)},r.onControlTouchEnd=function(o){r.userIsDragging||r.onControlMouseDown(o)},r.onClearIndicatorTouchEnd=function(o){r.userIsDragging||r.onClearIndicatorMouseDown(o)},r.onDropdownIndicatorTouchEnd=function(o){r.userIsDragging||r.onDropdownIndicatorMouseDown(o)},r.handleInputChange=function(o){var s=o.currentTarget.value;r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange(s,{action:"input-change"}),r.props.menuIsOpen||r.onMenuOpen()},r.onInputFocus=function(o){r.props.onFocus&&r.props.onFocus(o),r.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(r.openAfterFocus||r.props.openMenuOnFocus)&&r.openMenu("first"),r.openAfterFocus=!1},r.onInputBlur=function(o){if(r.menuListRef&&r.menuListRef.contains(document.activeElement)){r.inputRef.focus();return}r.props.onBlur&&r.props.onBlur(o),r.onInputChange("",{action:"input-blur"}),r.onMenuClose(),r.setState({focusedValue:null,isFocused:!1})},r.onOptionHover=function(o){r.blockOptionHover||r.state.focusedOption===o||r.setState({focusedOption:o})},r.shouldHideSelectedOptions=function(){return wh(r.props)},r.onKeyDown=function(o){var s=r.props,a=s.isMulti,l=s.backspaceRemovesValue,u=s.escapeClearsValue,c=s.inputValue,h=s.isClearable,d=s.isDisabled,g=s.menuIsOpen,y=s.onKeyDown,S=s.tabSelectsValue,E=s.openMenuOnFocus,C=r.state,p=C.focusedOption,x=C.focusedValue,A=C.selectValue;if(!d&&!(typeof y=="function"&&(y(o),o.defaultPrevented))){switch(r.blockOptionHover=!0,o.key){case"ArrowLeft":if(!a||c)return;r.focusValue("previous");break;case"ArrowRight":if(!a||c)return;r.focusValue("next");break;case"Delete":case"Backspace":if(c)return;if(x)r.removeValue(x);else{if(!l)return;a?r.popValue():h&&r.clearValue()}break;case"Tab":if(r.isComposing||o.shiftKey||!g||!S||!p||E&&r.isOptionSelected(p,A))return;r.selectOption(p);break;case"Enter":if(o.keyCode===229)break;if(g){if(!p||r.isComposing)return;r.selectOption(p);break}return;case"Escape":g?(r.setState({inputIsHiddenAfterUpdate:!1}),r.onInputChange("",{action:"menu-close"}),r.onMenuClose()):h&&u&&r.clearValue();break;case" ":if(c)return;if(!g){r.openMenu("first");break}if(!p)return;r.selectOption(p);break;case"ArrowUp":g?r.focusOption("up"):r.openMenu("last");break;case"ArrowDown":g?r.focusOption("down"):r.openMenu("first");break;case"PageUp":if(!g)return;r.focusOption("pageup");break;case"PageDown":if(!g)return;r.focusOption("pagedown");break;case"Home":if(!g)return;r.focusOption("first");break;case"End":if(!g)return;r.focusOption("last");break;default:return}o.preventDefault()}},r.instancePrefix="react-select-"+(r.props.instanceId||++KE),r.state.selectValue=Fc(n.value),r}return Ui(e,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput()}},{key:"componentDidUpdate",value:function(n){var r=this.props,o=r.isDisabled,s=r.menuIsOpen,a=this.state.isFocused;(a&&!o&&n.isDisabled||a&&s&&!n.menuIsOpen)&&this.focusInput(),a&&o&&!n.isDisabled&&this.setState({isFocused:!1},this.onMenuClose),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(mw(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close"}),this.props.onMenuClose()}},{key:"onInputChange",value:function(n,r){this.props.onInputChange(n,r)}},{key:"focusInput",value:function(){!this.inputRef||this.inputRef.focus()}},{key:"blurInput",value:function(){!this.inputRef||this.inputRef.blur()}},{key:"openMenu",value:function(n){var r=this,o=this.state,s=o.selectValue,a=o.isFocused,l=this.buildFocusableOptions(),u=n==="first"?0:l.length-1;if(!this.props.isMulti){var c=l.indexOf(s[0]);c>-1&&(u=c)}this.scrollToFocusedOptionOnUpdate=!(a&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:l[u]},function(){return r.onMenuOpen()})}},{key:"focusValue",value:function(n){var r=this.state,o=r.selectValue,s=r.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var a=o.indexOf(s);s||(a=-1);var l=o.length-1,u=-1;if(o.length){switch(n){case"previous":a===0?u=0:a===-1?u=l:u=a-1;break;case"next":a>-1&&a<l&&(u=a+1);break}this.setState({inputIsHidden:u!==-1,focusedValue:o[u]})}}}},{key:"focusOption",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",r=this.props.pageSize,o=this.state.focusedOption,s=this.getFocusableOptions();if(s.length){var a=0,l=s.indexOf(o);o||(l=-1),n==="up"?a=l>0?l-1:s.length-1:n==="down"?a=(l+1)%s.length:n==="pageup"?(a=l-r,a<0&&(a=0)):n==="pagedown"?(a=l+r,a>s.length-1&&(a=s.length-1)):n==="last"&&(a=s.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:s[a],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Ko):Le(Le({},Ko),this.props.theme):Ko}},{key:"getCommonProps",value:function(){var n=this.clearValue,r=this.cx,o=this.getStyles,s=this.getValue,a=this.selectOption,l=this.setValue,u=this.props,c=u.isMulti,h=u.isRtl,d=u.options,g=this.hasValue();return{clearValue:n,cx:r,getStyles:o,getValue:s,hasValue:g,isMulti:c,isRtl:h,options:d,selectOption:a,selectProps:u,setValue:l,theme:this.getTheme()}}},{key:"hasValue",value:function(){var n=this.state.selectValue;return n.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var n=this.props,r=n.isClearable,o=n.isMulti;return r===void 0?o:r}},{key:"isOptionDisabled",value:function(n,r){return mh(this.props,n,r)}},{key:"isOptionSelected",value:function(n,r){return vh(this.props,n,r)}},{key:"filterOption",value:function(n,r){return yh(this.props,n,r)}},{key:"formatOptionLabel",value:function(n,r){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,s=this.state.selectValue;return this.props.formatOptionLabel(n,{context:r,inputValue:o,selectValue:s})}else return this.getOptionLabel(n)}},{key:"formatGroupLabel",value:function(n){return this.props.formatGroupLabel(n)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var n=this.props,r=n.isDisabled,o=n.isSearchable,s=n.inputId,a=n.inputValue,l=n.tabIndex,u=n.form,c=this.getComponents(),h=c.Input,d=this.state.inputIsHidden,g=this.commonProps,y=s||this.getElementId("input"),S={"aria-autocomplete":"list","aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"]};return o?B.createElement(h,ne({},g,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:y,innerRef:this.getInputRef,isDisabled:r,isHidden:d,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:l,form:u,type:"text",value:a},S)):B.createElement(OE,ne({id:y,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:qi,onFocus:this.onInputFocus,readOnly:!0,disabled:r,tabIndex:l,form:u,value:""},S))}},{key:"renderPlaceholderOrValue",value:function(){var n=this,r=this.getComponents(),o=r.MultiValue,s=r.MultiValueContainer,a=r.MultiValueLabel,l=r.MultiValueRemove,u=r.SingleValue,c=r.Placeholder,h=this.commonProps,d=this.props,g=d.controlShouldRenderValue,y=d.isDisabled,S=d.isMulti,E=d.inputValue,C=d.placeholder,p=this.state,x=p.selectValue,A=p.focusedValue,P=p.isFocused;if(!this.hasValue()||!g)return E?null:B.createElement(c,ne({},h,{key:"placeholder",isDisabled:y,isFocused:P}),C);if(S){var D=x.map(function(I,N){var W=I===A;return B.createElement(o,ne({},h,{components:{Container:s,Label:a,Remove:l},isFocused:W,isDisabled:y,key:"".concat(n.getOptionValue(I)).concat(N),index:N,removeProps:{onClick:function(){return n.removeValue(I)},onTouchEnd:function(){return n.removeValue(I)},onMouseDown:function(q){q.preventDefault(),q.stopPropagation()}},data:I}),n.formatOptionLabel(I,"value"))});return D}if(E)return null;var O=x[0];return B.createElement(u,ne({},h,{data:O,isDisabled:y}),this.formatOptionLabel(O,"value"))}},{key:"renderClearIndicator",value:function(){var n=this.getComponents(),r=n.ClearIndicator,o=this.commonProps,s=this.props,a=s.isDisabled,l=s.isLoading,u=this.state.isFocused;if(!this.isClearable()||!r||a||!this.hasValue()||l)return null;var c={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return B.createElement(r,ne({},o,{innerProps:c,isFocused:u}))}},{key:"renderLoadingIndicator",value:function(){var n=this.getComponents(),r=n.LoadingIndicator,o=this.commonProps,s=this.props,a=s.isDisabled,l=s.isLoading,u=this.state.isFocused;if(!r||!l)return null;var c={"aria-hidden":"true"};return B.createElement(r,ne({},o,{innerProps:c,isDisabled:a,isFocused:u}))}},{key:"renderIndicatorSeparator",value:function(){var n=this.getComponents(),r=n.DropdownIndicator,o=n.IndicatorSeparator;if(!r||!o)return null;var s=this.commonProps,a=this.props.isDisabled,l=this.state.isFocused;return B.createElement(o,ne({},s,{isDisabled:a,isFocused:l}))}},{key:"renderDropdownIndicator",value:function(){var n=this.getComponents(),r=n.DropdownIndicator;if(!r)return null;var o=this.commonProps,s=this.props.isDisabled,a=this.state.isFocused,l={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return B.createElement(r,ne({},o,{innerProps:l,isDisabled:s,isFocused:a}))}},{key:"renderMenu",value:function(){var n=this,r=this.getComponents(),o=r.Group,s=r.GroupHeading,a=r.Menu,l=r.MenuList,u=r.MenuPortal,c=r.LoadingMessage,h=r.NoOptionsMessage,d=r.Option,g=this.commonProps,y=this.state.focusedOption,S=this.props,E=S.captureMenuScroll,C=S.inputValue,p=S.isLoading,x=S.loadingMessage,A=S.minMenuHeight,P=S.maxMenuHeight,D=S.menuIsOpen,O=S.menuPlacement,I=S.menuPosition,N=S.menuPortalTarget,W=S.menuShouldBlockScroll,q=S.menuShouldScrollIntoView,G=S.noOptionsMessage,J=S.onMenuScrollToTop,K=S.onMenuScrollToBottom;if(!D)return null;var oe=function(le,M){var H=le.type,V=le.data,j=le.isDisabled,U=le.isSelected,Q=le.label,ye=le.value,Se=y===V,de=j?void 0:function(){return n.onOptionHover(V)},nt=j?void 0:function(){return n.selectOption(V)},Ge="".concat(n.getElementId("option"),"-").concat(M),Je={id:Ge,onClick:nt,onMouseMove:de,onMouseOver:de,tabIndex:-1};return B.createElement(d,ne({},g,{innerProps:Je,data:V,isDisabled:j,isSelected:U,key:Ge,label:Q,type:H,value:ye,isFocused:Se,innerRef:Se?n.getFocusedOptionRef:void 0}),n.formatOptionLabel(le.data,"menu"))},re;if(this.hasOptions())re=this.getCategorizedOptions().map(function(le){if(le.type==="group"){var M=le.data,H=le.options,V=le.index,j="".concat(n.getElementId("group"),"-").concat(V),U="".concat(j,"-heading");return B.createElement(o,ne({},g,{key:j,data:M,options:H,Heading:s,headingProps:{id:U,data:le.data},label:n.formatGroupLabel(le.data)}),le.options.map(function(Q){return oe(Q,"".concat(V,"-").concat(Q.index))}))}else if(le.type==="option")return oe(le,"".concat(le.index))});else if(p){var ae=x({inputValue:C});if(ae===null)return null;re=B.createElement(c,g,ae)}else{var pe=G({inputValue:C});if(pe===null)return null;re=B.createElement(h,g,pe)}var Ee={minMenuHeight:A,maxMenuHeight:P,menuPlacement:O,menuPosition:I,menuShouldScrollIntoView:q},$=B.createElement(jc,ne({},g,Ee),function(le){var M=le.ref,H=le.placerProps,V=H.placement,j=H.maxHeight;return B.createElement(a,ne({},g,Ee,{innerRef:M,innerProps:{onMouseDown:n.onMenuMouseDown,onMouseMove:n.onMenuMouseMove},isLoading:p,placement:V}),B.createElement(IE,{captureEnabled:E,onTopArrive:J,onBottomArrive:K,lockEnabled:W},function(U){return B.createElement(l,ne({},g,{innerRef:function(Q){n.getMenuListRef(Q),U(Q)},isLoading:p,maxHeight:j,focusedOption:y}),re)}))});return N||I==="fixed"?B.createElement(u,ne({},g,{appendTo:N,controlElement:this.controlRef,menuPlacement:O,menuPosition:I}),$):$}},{key:"renderFormField",value:function(){var n=this,r=this.props,o=r.delimiter,s=r.isDisabled,a=r.isMulti,l=r.name,u=this.state.selectValue;if(!(!l||s))if(a)if(o){var c=u.map(function(g){return n.getOptionValue(g)}).join(o);return B.createElement("input",{name:l,type:"hidden",value:c})}else{var h=u.length>0?u.map(function(g,y){return B.createElement("input",{key:"i-".concat(y),name:l,type:"hidden",value:n.getOptionValue(g)})}):B.createElement("input",{name:l,type:"hidden"});return B.createElement("div",null,h)}else{var d=u[0]?this.getOptionValue(u[0]):"";return B.createElement("input",{name:l,type:"hidden",value:d})}}},{key:"renderLiveRegion",value:function(){var n=this.commonProps,r=this.state,o=r.ariaSelection,s=r.focusedOption,a=r.focusedValue,l=r.isFocused,u=r.selectValue,c=this.getFocusableOptions();return B.createElement(CE,ne({},n,{ariaSelection:o,focusedOption:s,focusedValue:a,isFocused:l,selectValue:u,focusableOptions:c}))}},{key:"render",value:function(){var n=this.getComponents(),r=n.Control,o=n.IndicatorsContainer,s=n.SelectContainer,a=n.ValueContainer,l=this.props,u=l.className,c=l.id,h=l.isDisabled,d=l.menuIsOpen,g=this.state.isFocused,y=this.commonProps=this.getCommonProps();return B.createElement(s,ne({},y,{className:u,innerProps:{id:c,onKeyDown:this.onKeyDown},isDisabled:h,isFocused:g}),this.renderLiveRegion(),B.createElement(r,ne({},y,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:h,isFocused:g,menuIsOpen:d}),B.createElement(a,ne({},y,{isDisabled:h}),this.renderPlaceholderOrValue(),this.renderInput()),B.createElement(o,ne({},y,{isDisabled:h}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(n,r){var o=r.prevProps,s=r.clearFocusValueOnUpdate,a=r.inputIsHiddenAfterUpdate,l=n.options,u=n.value,c=n.menuIsOpen,h=n.inputValue,d={};if(o&&(u!==o.value||l!==o.options||c!==o.menuIsOpen||h!==o.inputValue)){var g=Fc(u),y=c?qE(n,g):[],S=s?YE(r,g):null,E=ZE(r,y);d={selectValue:g,focusedOption:E,focusedValue:S,clearFocusValueOnUpdate:!1}}var C=a!=null&&n!==o?{inputIsHidden:a,inputIsHiddenAfterUpdate:void 0}:{};return Le(Le(Le({},d),C),{},{prevProps:n})}}]),e}(Ae);Eh.defaultProps=XE;var JE={defaultInputValue:"",defaultMenuIsOpen:!1,defaultValue:null},QE=function(t){var i,e;return e=i=function(n){Gi(o,n);var r=Xi(o);function o(){var s;Vi(this,o);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return s=r.call.apply(r,[this].concat(l)),s.select=void 0,s.state={inputValue:s.props.inputValue!==void 0?s.props.inputValue:s.props.defaultInputValue,menuIsOpen:s.props.menuIsOpen!==void 0?s.props.menuIsOpen:s.props.defaultMenuIsOpen,value:s.props.value!==void 0?s.props.value:s.props.defaultValue},s.onChange=function(c,h){s.callProp("onChange",c,h),s.setState({value:c})},s.onInputChange=function(c,h){var d=s.callProp("onInputChange",c,h);s.setState({inputValue:d!==void 0?d:c})},s.onMenuOpen=function(){s.callProp("onMenuOpen"),s.setState({menuIsOpen:!0})},s.onMenuClose=function(){s.callProp("onMenuClose"),s.setState({menuIsOpen:!1})},s}return Ui(o,[{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"getProp",value:function(s){return this.props[s]!==void 0?this.props[s]:this.state[s]}},{key:"callProp",value:function(s){if(typeof this.props[s]=="function"){for(var a,l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];return(a=this.props)[s].apply(a,u)}}},{key:"render",value:function(){var s=this,a=this.props;a.defaultInputValue,a.defaultMenuIsOpen,a.defaultValue;var l=cn(a,["defaultInputValue","defaultMenuIsOpen","defaultValue"]);return B.createElement(t,ne({},l,{ref:function(u){s.select=u},inputValue:this.getProp("inputValue"),menuIsOpen:this.getProp("menuIsOpen"),onChange:this.onChange,onInputChange:this.onInputChange,onMenuClose:this.onMenuClose,onMenuOpen:this.onMenuOpen,value:this.getProp("value")}))}}]),o}(Ae),i.defaultProps=JE,e},eb=QE(Eh),tb=eb;const Jo=[{value:"assessing",label:"Assessing"},{value:"bookmarking",label:"Bookmarking"},{value:"classifying",label:"Classifying"},{value:"commenting",label:"Commenting"},{value:"describing",label:"Describing"},{value:"editing",label:"Editing"},{value:"highlighting",label:"Highlighting"},{value:"identifying",label:"Identifying"},{value:"linking",label:"Linking"},{value:"moderating",label:"Moderating"},{value:"questioning",label:"Questioning"},{value:"replying",label:"Replying"},{value:"supplementing",label:"Transcription"}];var bh=t=>{const i=t.content?Jo.find(e=>e.value===t.content):null;return B.createElement("div",{className:"r6o-purposedropdown"},B.createElement(tb,{value:i,onChange:t.onChange,options:Jo,isDisabled:!t.editable}))};const nb=t=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 940",width:t.width},B.createElement("metadata",null,"IcoFont Icons"),B.createElement("title",null,"simple-down"),B.createElement("glyph",{glyphName:"simple-down",unicode:"",horizAdvX:"1000"}),B.createElement("path",{fill:"currentColor",d:"M200 392.6l300 300 300-300-85.10000000000002-85.10000000000002-214.89999999999998 214.79999999999995-214.89999999999998-214.89999999999998-85.10000000000002 85.20000000000005z"})),ib=t=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"180 150 700 800",width:t.width},B.createElement("metadata",null,"IcoFont Icons"),B.createElement("title",null,"close"),B.createElement("glyph",{glyphName:"close",unicode:"",horizAdvX:"1000"}),B.createElement("path",{fill:"currentColor",d:"M709.8 206.6c-64.39999999999998 65.50000000000003-128.89999999999998 131.20000000000002-194.19999999999993 197.6-8.600000000000023 8.699999999999989-22.400000000000034 8.800000000000011-31 0-65-66-129.70000000000005-131.8-194.5-197.6-8.600000000000023-8.699999999999989-22.400000000000034-8.599999999999994-30.900000000000034 0.09999999999999432-15.699999999999989 16.200000000000017-31.099999999999994 32.30000000000001-47.099999999999994 48.80000000000001-8.5 8.800000000000011-8.299999999999983 23 0.20000000000001705 31.69999999999999 63.099999999999966 64.19999999999999 127.89999999999998 130.10000000000002 193.59999999999997 197 8.600000000000023 8.699999999999989 8.5 22.80000000000001 0 31.599999999999966-65.19999999999999 66.40000000000009-130.2 132.5-194.7 198.10000000000002-8.5 8.700000000000045-8.5 22.800000000000068 0.20000000000001705 31.399999999999977l47.79999999999998 47.90000000000009c8.600000000000023 8.599999999999909 22.600000000000023 8.599999999999909 31.100000000000023-0.10000000000002274l194.2-197.30000000000007c8.600000000000023-8.699999999999932 22.399999999999977-8.699999999999932 31 0 64.70000000000005 65.80000000000007 129.20000000000005 131.4000000000001 194.20000000000005 197.5 8.599999999999909 8.700000000000045 22.5 8.800000000000068 31 0.10000000000002274 16-16.199999999999932 31.699999999999932-32.19999999999993 47.59999999999991-48.299999999999955 8.600000000000023-8.700000000000045 8.600000000000023-22.899999999999977 0.10000000000002274-31.600000000000023-63.799999999999955-65-128.5-130.89999999999998-194.19999999999993-197.79999999999995-8.600000000000023-8.700000000000045-8.600000000000023-22.900000000000034 0-31.600000000000023 65.19999999999993-66.40000000000003 130.0999999999999-132.5 194.5-198.20000000000005 8.599999999999909-8.699999999999989 8.5-22.799999999999955-0.10000000000002274-31.49999999999997l-47.80000000000007-48.099999999999994c-8.5-8.5-22.399999999999977-8.400000000000006-31 0.29999999999998295z"})),rb=t=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:t.width},B.createElement("path",{fill:"currentColor",d:"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"}));var ob=t=>{const[i,e]=mt(!1),[n,r]=mt(!1),o=h=>{e(!0),r(!1)},s=h=>{t.onDelete(t.body),r(!1)},a=h=>t.onUpdate(t.body,{...t.body,value:h.target.value}),l=h=>t.onUpdate(t.body,{...t.body,purpose:h.value}),u=t.body.modified||t.body.created,c=t.body.creator&&B.createElement("div",{className:"r6o-lastmodified"},B.createElement("span",{className:"r6o-lastmodified-by"},t.body.creator.name||t.body.creator.id),t.body.created&&B.createElement("span",{className:"r6o-lastmodified-at"},B.createElement(Vp,{datetime:t.env.toClientTime(u),locale:Ye.locale()})));return t.readOnly?B.createElement("div",{className:"r6o-widget comment"},B.createElement("div",{className:"r6o-readonly-comment"},t.body.value),c):B.createElement("div",{className:i?"r6o-widget comment editable":"r6o-widget comment"},B.createElement(Qu,{editable:i,content:t.body.value,onChange:a,onSaveAndClose:t.onSaveAndClose}),!i&&c,t.purposeSelector&&B.createElement(bh,{editable:i,content:t.body.purpose,onChange:l,onSaveAndClose:t.onSaveAndClose}),B.createElement("div",{className:n?"r6o-icon r6o-arrow-down r6o-menu-open":"r6o-icon r6o-arrow-down",onClick:()=>r(!n)},B.createElement(nb,{width:12})),n&&B.createElement(jy,{onEdit:o,onDelete:s,onClickOutside:()=>r(!1)}))};const sb=Jo.map(t=>t.value),xh=(t,i)=>{const e=i?sb.indexOf(t.purpose)>-1:t.purpose=="commenting"||t.purpose=="replying";return t.type==="TextualBody"&&(!Object.prototype.hasOwnProperty.call(t,"purpose")||e)},Sh=(t,i)=>{var e,n;if(i.editable===!0)return!1;if(i.editable===!1)return!0;if(i.editable==="MINE_ONLY"){const r=(e=t.creator)==null?void 0:e.id;return((n=i.env.user)==null?void 0:n.id)!==r}return i.readOnly},ab=(t,i)=>t||{type:"TextualBody",value:"",purpose:i?"replying":"commenting",draft:!0},_h=t=>{const i=t.annotation?t.annotation.bodies.filter(l=>xh(l,t.purposeSelector)):[],e=ab(i.find(l=>l.draft==!0),i.length>1),n=i.filter(l=>l!=e),r=l=>{const u=e.value,c=l.target.value;u.length===0&&c.length>0?t.onAppendBody({...e,value:c}):u.length>0&&c.length===0?t.onRemoveBody(e):t.onUpdateBody(e,{...e,value:c})},o=l=>t.onUpdateBody(e,{...e,purpose:l.value}),s=!t.readOnly&&t.annotation,a=n.length===0||!t.disableReply;return B.createElement(B.Fragment,null,n.map((l,u)=>B.createElement(ob,{key:u,env:t.env,purposeSelector:t.purposeSelector,readOnly:Sh(l,t),body:l,onUpdate:t.onUpdateBody,onDelete:t.onRemoveBody,onSaveAndClose:t.onSaveAndClose})),s&&a&&B.createElement("div",{className:"r6o-widget comment editable"},B.createElement(Qu,{focus:t.focus,content:e.value,editable:!0,placeholder:n.length>0?Ye.t("Add a reply..."):t.textPlaceHolder||Ye.t("Add a comment..."),onChange:r,onSaveAndClose:()=>t.onSaveAndClose()}),t.purposeSelector&&e.value.length>0&&B.createElement(bh,{editable:!0,content:e.purpose,onChange:o,onSaveAndClose:()=>t.onSaveAndClose()})))};_h.disableDelete=(t,i)=>t.bodies.filter(e=>xh(e,i.purposeSelector)).some(e=>Sh(e,i));var Ch=_h;function Th(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,Wi(t,i)}function lb(t,i){return t.classList?!!i&&t.classList.contains(i):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+i+" ")!==-1}function ub(t,i){t.classList?t.classList.add(i):lb(t,i)||(typeof t.className=="string"?t.className=t.className+" "+i:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+i))}function Ph(t,i){return t.replace(new RegExp("(^|\\s)"+i+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function cb(t,i){t.classList?t.classList.remove(i):typeof t.className=="string"?t.className=Ph(t.className,i):t.setAttribute("class",Ph(t.className&&t.className.baseVal||"",i))}var Ah={disabled:!1},Dh=B.createContext(null),Oh=function(t){return t.scrollTop},Wn="unmounted",Ht="exited",jt="entering",pn="entered",Qo="exiting",bt=function(t){Th(i,t);function i(n,r){var o;o=t.call(this,n,r)||this;var s=r,a=s&&!s.isMounting?n.enter:n.appear,l;return o.appearStatus=null,n.in?a?(l=Ht,o.appearStatus=jt):l=pn:n.unmountOnExit||n.mountOnEnter?l=Wn:l=Ht,o.state={status:l},o.nextCallback=null,o}i.getDerivedStateFromProps=function(n,r){var o=n.in;return o&&r.status===Wn?{status:Ht}:null};var e=i.prototype;return e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},e.componentDidUpdate=function(n){var r=null;if(n!==this.props){var o=this.state.status;this.props.in?o!==jt&&o!==pn&&(r=jt):(o===jt||o===pn)&&(r=Qo)}this.updateStatus(!1,r)},e.componentWillUnmount=function(){this.cancelNextCallback()},e.getTimeouts=function(){var n=this.props.timeout,r,o,s;return r=o=s=n,n!=null&&typeof n!="number"&&(r=n.exit,o=n.enter,s=n.appear!==void 0?n.appear:o),{exit:r,enter:o,appear:s}},e.updateStatus=function(n,r){if(n===void 0&&(n=!1),r!==null)if(this.cancelNextCallback(),r===jt){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:B.findDOMNode(this);o&&Oh(o)}this.performEnter(n)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ht&&this.setState({status:Wn})},e.performEnter=function(n){var r=this,o=this.props.enter,s=this.context?this.context.isMounting:n,a=this.props.nodeRef?[s]:[B.findDOMNode(this),s],l=a[0],u=a[1],c=this.getTimeouts(),h=s?c.appear:c.enter;if(!n&&!o||Ah.disabled){this.safeSetState({status:pn},function(){r.props.onEntered(l)});return}this.props.onEnter(l,u),this.safeSetState({status:jt},function(){r.props.onEntering(l,u),r.onTransitionEnd(h,function(){r.safeSetState({status:pn},function(){r.props.onEntered(l,u)})})})},e.performExit=function(){var n=this,r=this.props.exit,o=this.getTimeouts(),s=this.props.nodeRef?void 0:B.findDOMNode(this);if(!r||Ah.disabled){this.safeSetState({status:Ht},function(){n.props.onExited(s)});return}this.props.onExit(s),this.safeSetState({status:Qo},function(){n.props.onExiting(s),n.onTransitionEnd(o.exit,function(){n.safeSetState({status:Ht},function(){n.props.onExited(s)})})})},e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},e.safeSetState=function(n,r){r=this.setNextCallback(r),this.setState(n,r)},e.setNextCallback=function(n){var r=this,o=!0;return this.nextCallback=function(s){o&&(o=!1,r.nextCallback=null,n(s))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},e.onTransitionEnd=function(n,r){this.setNextCallback(r);var o=this.props.nodeRef?this.props.nodeRef.current:B.findDOMNode(this),s=n==null&&!this.props.addEndListener;if(!o||s){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],l=a[0],u=a[1];this.props.addEndListener(l,u)}n!=null&&setTimeout(this.nextCallback,n)},e.render=function(){var n=this.state.status;if(n===Wn)return null;var r=this.props,o=r.children;r.in,r.mountOnEnter,r.unmountOnExit,r.appear,r.enter,r.exit,r.timeout,r.addEndListener,r.onEnter,r.onEntering,r.onEntered,r.onExit,r.onExiting,r.onExited,r.nodeRef;var s=zo(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return B.createElement(Dh.Provider,{value:null},typeof o=="function"?o(n,s):B.cloneElement(B.Children.only(o),s))},i}(B.Component);bt.contextType=Dh,bt.propTypes={};function fn(){}bt.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:fn,onEntering:fn,onEntered:fn,onExit:fn,onExiting:fn,onExited:fn},bt.UNMOUNTED=Wn,bt.EXITED=Ht,bt.ENTERING=jt,bt.ENTERED=pn,bt.EXITING=Qo;var hb=bt,db=function(t,i){return t&&i&&i.split(" ").forEach(function(e){return ub(t,e)})},es=function(t,i){return t&&i&&i.split(" ").forEach(function(e){return cb(t,e)})},ts=function(t){Th(i,t);function i(){for(var n,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o))||this,n.appliedClasses={appear:{},enter:{},exit:{}},n.onEnter=function(a,l){var u=n.resolveArguments(a,l),c=u[0],h=u[1];n.removeClasses(c,"exit"),n.addClass(c,h?"appear":"enter","base"),n.props.onEnter&&n.props.onEnter(a,l)},n.onEntering=function(a,l){var u=n.resolveArguments(a,l),c=u[0],h=u[1],d=h?"appear":"enter";n.addClass(c,d,"active"),n.props.onEntering&&n.props.onEntering(a,l)},n.onEntered=function(a,l){var u=n.resolveArguments(a,l),c=u[0],h=u[1],d=h?"appear":"enter";n.removeClasses(c,d),n.addClass(c,d,"done"),n.props.onEntered&&n.props.onEntered(a,l)},n.onExit=function(a){var l=n.resolveArguments(a),u=l[0];n.removeClasses(u,"appear"),n.removeClasses(u,"enter"),n.addClass(u,"exit","base"),n.props.onExit&&n.props.onExit(a)},n.onExiting=function(a){var l=n.resolveArguments(a),u=l[0];n.addClass(u,"exit","active"),n.props.onExiting&&n.props.onExiting(a)},n.onExited=function(a){var l=n.resolveArguments(a),u=l[0];n.removeClasses(u,"exit"),n.addClass(u,"exit","done"),n.props.onExited&&n.props.onExited(a)},n.resolveArguments=function(a,l){return n.props.nodeRef?[n.props.nodeRef.current,a]:[a,l]},n.getClassNames=function(a){var l=n.props.classNames,u=typeof l=="string",c=u&&l?l+"-":"",h=u?""+c+a:l[a],d=u?h+"-active":l[a+"Active"],g=u?h+"-done":l[a+"Done"];return{baseClassName:h,activeClassName:d,doneClassName:g}},n}var e=i.prototype;return e.addClass=function(n,r,o){var s=this.getClassNames(r)[o+"ClassName"],a=this.getClassNames("enter"),l=a.doneClassName;r==="appear"&&o==="done"&&l&&(s+=" "+l),o==="active"&&n&&Oh(n),s&&(this.appliedClasses[r][o]=s,db(n,s))},e.removeClasses=function(n,r){var o=this.appliedClasses[r],s=o.base,a=o.active,l=o.done;this.appliedClasses[r]={},s&&es(n,s),a&&es(n,a),l&&es(n,l)},e.render=function(){var n=this.props;n.classNames;var r=zo(n,["classNames"]);return B.createElement(hb,ne({},r,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},i}(B.Component);ts.defaultProps={classNames:""},ts.propTypes={};var pb=ts;const fb=(t,i)=>i.filter(e=>(e.label?e.label:e).toLowerCase().startsWith(t.toLowerCase())),gb=(t,i)=>i(t);var mb=t=>{const i=rt(),[e,n]=mt(t.initialValue||""),[r,o]=mt([]),[s,a]=mt(null);Bt(()=>{t.focus&&i.current.querySelector("input").focus({preventScroll:!0})},[]),Bt(()=>{t.onChange&&t.onChange(e)},[e]);const l=d=>{if(typeof t.vocabulary=="function"){const g=gb(d,t.vocabulary);g.then?g.then(o):o(g)}else{const g=fb(d,t.vocabulary);o(g)}},u=()=>{if(s!==null)t.onSubmit(r[s]);else{const d=e.trim();if(d){const g=Array.isArray(t.vocabulary)?t.vocabulary.find(y=>(y.label||y).toLowerCase()===d.toLowerCase()):null;g?t.onSubmit(g):t.onSubmit(d)}}n(""),o([]),a(null)},c=d=>{if(d.which===13)u();else if(d.which===27)t.onCancel&&t.onCancel();else if(r.length>0){if(d.which===38)if(s===null)a(0);else{const g=Math.max(0,s-1);a(g)}else if(d.which===40)if(s===null)a(0);else{const g=Math.min(r.length-1,s+1);a(g)}}else d.which===40&&Array.isArray(t.vocabulary)&&o(t.vocabulary)},h=d=>{const{value:g}=d.target;n(g),a(null),g?l(g):o([])};return B.createElement("div",{ref:i,className:"r6o-autocomplete"},B.createElement("div",null,B.createElement("input",{onKeyDown:c,onChange:h,value:e,placeholder:t.placeholder})),B.createElement("ul",null,r.length>0&&r.map((d,g)=>B.createElement("li",{key:`${d.label?d.label:d}${g}`,onClick:u,onMouseEnter:()=>a(g),style:s===g?{backgroundColor:"#bde4ff"}:{}},d.label?d.label:d))))};const vb=t=>t||{type:"TextualBody",value:"",purpose:"tagging",draft:!0};var Rh=t=>{const i=t.annotation?t.annotation.bodies.filter(h=>h.purpose==="tagging"):[],e=vb(i.slice().reverse().find(h=>h.draft)),n=i.filter(h=>h!=e),[r,o]=mt(!1),s=h=>d=>{o(r===h?!1:h)},a=h=>{const d=e.value.trim(),g=h.trim();d.length===0&&g.length>0?t.onAppendBody({...e,value:g}):d.length>0&&g.length===0?t.onRemoveBody(e):d!==g&&t.onUpdateBody(e,{...e,value:g})},l=h=>d=>{d.stopPropagation(),t.onRemoveBody(h)},u=h=>{const d=h.uri?{type:"SpecificResource",purpose:"tagging",source:{id:h.uri,label:h.label}}:{type:"TextualBody",purpose:"tagging",value:h.label||h};e.value.trim().length===0?t.onAppendBody(d):t.onUpdateBody(e,d)},c=h=>h.value||h.source.label;return B.createElement("div",{className:"r6o-widget r6o-tag"},n.length>0&&B.createElement("ul",{className:"r6o-taglist"},n.map(h=>B.createElement("li",{key:c(h),onClick:s(h)},B.createElement("span",{className:"r6o-label"},c(h)),!t.readOnly&&B.createElement(pb,{in:r===h,timeout:200,classNames:"r6o-delete"},B.createElement("span",{className:"r6o-delete-wrapper",onClick:l(h)},B.createElement("span",{className:"r6o-delete"},B.createElement(ib,{width:12}))))))),!t.readOnly&&B.createElement(mb,{focus:t.focus,placeholder:t.textPlaceHolder||Ye.t("Add tag..."),vocabulary:t.vocabulary||[],onChange:a,onSubmit:u}))};class kh extends Ae{constructor(i){super(i),this.element=B.createRef()}renderWidget(i){const e=this.props.widget({annotation:i.annotation,readOnly:i.readOnly,...i.config,onAppendBody:(n,r)=>i.onAppendBody(n,r),onUpdateBody:(n,r,o)=>i.onUpdateBody(n,r,o),onUpsertBody:(n,r,o)=>i.onUpsertBody(n,r,o),onRemoveBody:(n,r)=>i.onRemoveBody(n,r),onBatchModify:(n,r)=>i.onBatchModify(n,r),onSetProperty:(n,r)=>i.onSetProperty(n,r),onAddContext:n=>i.onAddContext(n),onSaveAndClose:()=>i.onSaveAndClose()});for(;this.element.current.firstChild;)this.element.current.removeChild(this.element.current.lastChild);this.element.current.appendChild(e)}componentDidMount(){this.renderWidget(this.props)}componentWillReceiveProps(i){this.element.current&&this.props.annotation!==i.annotation&&this.renderWidget(i)}render(){return B.createElement("div",{ref:this.element,className:"widget"})}}window.React=B,window.ReactDOM=B;const yb={COMMENT:Ch,TAG:Rh},wb=[B.createElement(Ch,null),B.createElement(Rh,null)],Eb=t=>{const i=n=>{var r;return typeof n=="function"&&!!((r=n.prototype)!=null&&r.isReactComponent)},e=n=>typeof n=="function"&&(String(n).match(/return .+\(['|"].+['|"],\s*\{/g)||String(n).match(/return .+preact_compat/)||String(n).match(/return .+\.createElement/g));return i(t)||e(t)},bb=t=>{const i=(e,n,r)=>{if(typeof e=="string"||e instanceof String)return B.createElement(yb[e],n);if((r==null?void 0:r.toLowerCase())==="react")return B.createElement(e,n);if((r==null?void 0:r.toLowerCase())==="plainjs")return B.createElement(kh,{widget:e,config:n});if(Eb(e))return B.createElement(e,n);if(typeof e=="function"||e instanceof Function)return B.createElement(kh,{widget:e,config:n});throw`${e} is not a valid plugin`};if(t.widget){const{widget:e,force:n,...r}=t;return i(e,r,n)}else return i(t)},Bh=14;var Mh=(t,i,e,n)=>{const r=t.getBoundingClientRect();i.className="r6o-editor r6o-arrow-top r6o-arrow-left";const{left:o,top:s,right:a,bottom:l}=e.getBoundingClientRect();if(i.style.top=`${l-r.top+Bh}px`,i.style.left=`${o-r.left}px`,n){const u=i.children[1].getBoundingClientRect(),{innerWidth:c,innerHeight:h}=t.ownerDocument.defaultView;if(u.right>c&&(i.classList.remove("r6o-arrow-left"),i.classList.add("r6o-arrow-right"),i.style.left=`${a-u.width-r.left}px`),u.bottom>h){i.classList.remove("r6o-arrow-top"),i.classList.add("r6o-arrow-bottom");const g=i.children[1].getBoundingClientRect().height;i.style.top=`${s-r.top-g-Bh}px`}const d=i.children[1].getBoundingClientRect();if(d.top<0){i.classList.add("pushed","down"),i.style.top=`${-r.top}px`;const g=l-r.top;d.height-r.top>g&&i.classList.remove("r6o-arrow-bottom")}d.left<0&&(i.classList.add("pushed","right"),i.style.left=`${-r.left}px`),requestAnimationFrame(()=>i.style.opacity=1)}};const Fh=t=>{const{top:i,left:e,width:n,height:r}=t.getBoundingClientRect();return`${i}, ${e}, ${n}, ${r}`};class xb extends Ae{constructor(i){super(i),T(this,"initResizeObserver",()=>{const e=this.props.autoPosition===void 0?!0:this.props.autoPosition;if(window!=null&&window.ResizeObserver){const n=new ResizeObserver(()=>{this.state.dragged||Mh(this.props.wrapperEl,this.element.current,this.props.selectedElement,e)});return n.observe(this.props.wrapperEl),()=>n.disconnect()}else this.state.dragged||Mh(this.props.wrapperEl,this.element.current,this.props.selectedElement,e)}),T(this,"creationMeta",e=>{const n={},{user:r}=this.props.env;return r&&(n.creator={},r.id&&(n.creator.id=r.id),r.displayName&&(n.creator.name=r.displayName),n[e.created?"modified":"created"]=this.props.env.getCurrentTimeAdjusted()),n}),T(this,"getCurrentAnnotation",()=>this.state.currentAnnotation.clone()),T(this,"hasChanges",()=>{var e;return!((e=this.props.annotation)!=null&&e.isEqual(this.state.currentAnnotation))}),T(this,"updateCurrentAnnotation",(e,n)=>{this.setState({currentAnnotation:this.state.currentAnnotation.clone(e)},()=>{n?this.onOk():this.props.onChanged&&this.props.onChanged()})}),T(this,"onAppendBody",(e,n)=>this.updateCurrentAnnotation({body:[...this.state.currentAnnotation.bodies,{...e,...this.creationMeta(e)}]},n)),T(this,"onUpdateBody",(e,n,r)=>this.updateCurrentAnnotation({body:this.state.currentAnnotation.bodies.map(o=>o===e?{...n,...this.creationMeta(n)}:o)},r)),T(this,"onRemoveBody",(e,n)=>this.updateCurrentAnnotation({body:this.state.currentAnnotation.bodies.filter(r=>r!==e)},n)),T(this,"onUpsertBody",(e,n,r)=>{if(e==null&&n!=null)this.onAppendBody(n,r);else if(e!=null&&n!=null)this.onUpdateBody(e,n,r);else if(e!=null&&n==null){const o=this.state.currentAnnotation.bodies.find(s=>s.purpose===e.purpose);o?this.onUpdateBody(o,e,r):this.onAppendBody(e,r)}}),T(this,"onBatchModify",(e,n)=>{const r=e.filter(u=>u.action==="upsert"&&u.body).map(u=>({previous:this.state.currentAnnotation.bodies.find(c=>c.purpose===u.body.purpose),updated:{...u.body,...this.creationMeta(u.body)}})),o=e.filter(u=>u.action==="remove").map(u=>u.body),s=[...e.filter(u=>u.action==="append"||u.action==="upsert"&&u.updated&&!u.previous).map(u=>({...u.body,...this.creationMeta(u.body)})),...r.filter(u=>!u.previous).map(u=>u.updated)],a=[...e.filter(u=>u.action==="update"||u.action==="upsert"&&u.updated&&u.previous).map(u=>({previous:u.previous,updated:{...u.updated,...this.creationMeta(u.updated)}})),...r.filter(u=>u.previous)],l=[...this.state.currentAnnotation.bodies.filter(u=>!o.includes(u)).map(u=>{const c=a.find(h=>h.previous===u);return c?c.updated:u}),...s];this.updateCurrentAnnotation({body:l},n)}),T(this,"onSetProperty",(e,n)=>{if(["@context","id","type","body","target"].includes(e))throw new Exception(`Cannot set ${e} - not allowed`);if(n)this.updateCurrentAnnotation({[e]:n});else{const r=this.currentAnnotation.clone();delete r[e],this.setState({currentAnnotation:r})}}),T(this,"onAddContext",e=>{const{currentAnnotation:n}=this.state,r=Array.isArray(n.context)?n.context:[n.context];r.indexOf(e)<0&&(r.push(e),this.updateCurrentAnnotation({"@context":r}))}),T(this,"onCancel",()=>this.props.onCancel(this.props.annotation)),T(this,"onOk",()=>{const e=r=>r.clone({body:r.bodies.map(({draft:o,...s})=>s)}),{currentAnnotation:n}=this.state;n.bodies.length===0&&!this.props.allowEmpty?n.isSelection?this.onCancel():this.props.onAnnotationDeleted(this.props.annotation):n.isSelection?this.props.onAnnotationCreated(e(n).toAnnotation()):this.props.onAnnotationUpdated(e(n),this.props.annotation)}),T(this,"onDelete",()=>this.props.onAnnotationDeleted(this.props.annotation)),this.element=B.createRef(),this.state={currentAnnotation:i.annotation,dragged:!1,selectionBounds:Fh(i.selectedElement)}}componentWillReceiveProps(i){var e;const{selectionBounds:n}=this.state,r=Fh(i.selectedElement);(e=this.props.annotation)!=null&&e.isEqual(i.annotation)?this.setState({selectionBounds:r}):this.setState({currentAnnotation:i.annotation,selectionBounds:r}),this.props.modifiedTarget!=i.modifiedTarget&&this.state.currentAnnotation&&this.updateCurrentAnnotation({target:this.props.modifiedTarget}),n!=r&&this.element.current&&(this.removeObserver&&this.removeObserver(),this.removeObserver=this.initResizeObserver())}componentDidMount(){this.removeObserver=this.initResizeObserver(),new MutationObserver(()=>{this.element.current&&(this.removeObserver&&this.removeObserver(),this.removeObserver=this.initResizeObserver())}).observe(this.element.current,{childList:!0,subtree:!0})}componentWillUnmount(){this.removeObserver&&this.removeObserver()}render(){const{currentAnnotation:i}=this.state,e=this.props.widgets?this.props.widgets.map(bb):wb,n=o=>o.type.disableDelete?o.type.disableDelete(i,{...o.props,readOnly:this.props.readOnly,env:this.props.env}):!1,r=i&&(i.bodies.length>0||this.props.allowEmpty)&&!this.props.readOnly&&!i.isSelection&&!e.some(n);return B.createElement(Dp,{disabled:!this.props.detachable,handle:".r6o-draggable",cancel:".r6o-btn, .r6o-btn *",onDrag:()=>this.setState({dragged:!0})},B.createElement("div",{ref:this.element,className:this.state.dragged?"r6o-editor dragged":"r6o-editor"},B.createElement("div",{className:"r6o-arrow"}),B.createElement("div",{className:"r6o-editor-inner"},e.map((o,s)=>B.cloneElement(o,{key:`${s}`,focus:s===0,annotation:i,readOnly:this.props.readOnly,env:this.props.env,onAppendBody:this.onAppendBody,onUpdateBody:this.onUpdateBody,onRemoveBody:this.onRemoveBody,onUpsertBody:this.onUpsertBody,onBatchModify:this.onBatchModify,onSetProperty:this.onSetProperty,onAddContext:this.onAddContext,onSaveAndClose:this.onOk})),this.props.readOnly?B.createElement("div",{className:"r6o-footer"},B.createElement("button",{className:"r6o-btn",onClick:this.onCancel},Ye.t("Close"))):B.createElement("div",{className:this.props.detachable?"r6o-footer r6o-draggable":"r6o-footer"},r&&B.createElement("button",{className:"r6o-btn left delete-annotation",title:Ye.t("Delete"),onClick:this.onDelete},B.createElement(rb,{width:12})),B.createElement("button",{className:"r6o-btn outline",onClick:this.onCancel},Ye.t("Cancel")),B.createElement("button",{className:"r6o-btn ",onClick:this.onOk},Ye.t("Ok"))))))}}var Qi,Sb=new Uint8Array(16);function _b(){if(!Qi&&(Qi=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Qi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qi(Sb)}var Cb=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Tb(t){return typeof t=="string"&&Cb.test(t)}for(var Ne=[],ns=0;ns<256;++ns)Ne.push((ns+256).toString(16).substr(1));function Pb(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(Ne[t[i+0]]+Ne[t[i+1]]+Ne[t[i+2]]+Ne[t[i+3]]+"-"+Ne[t[i+4]]+Ne[t[i+5]]+"-"+Ne[t[i+6]]+Ne[t[i+7]]+"-"+Ne[t[i+8]]+Ne[t[i+9]]+"-"+Ne[t[i+10]]+Ne[t[i+11]]+Ne[t[i+12]]+Ne[t[i+13]]+Ne[t[i+14]]+Ne[t[i+15]]).toLowerCase();if(!Tb(e))throw TypeError("Stringified UUID is invalid");return e}function Ih(t,i,e){t=t||{};var n=t.random||(t.rng||_b)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,i){e=e||0;for(var r=0;r<16;++r)i[e+r]=n[r];return i}return Pb(n)}var Ab=function t(i,e){if(i===e)return!0;if(i&&e&&typeof i=="object"&&typeof e=="object"){if(i.constructor!==e.constructor)return!1;var n,r,o;if(Array.isArray(i)){if(n=i.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!t(i[r],e[r]))return!1;return!0}if(i.constructor===RegExp)return i.source===e.source&&i.flags===e.flags;if(i.valueOf!==Object.prototype.valueOf)return i.valueOf()===e.valueOf();if(i.toString!==Object.prototype.toString)return i.toString()===e.toString();if(o=Object.keys(i),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){var s=o[r];if(!t(i[s],e[s]))return!1}return!0}return i!==i&&e!==e},Lh=Ab;const is=class{constructor(t,i){T(this,"clone",(e,n)=>new is({...this.underlying,...e},{...this.opts,...n})),T(this,"selector",e=>{const{target:n}=this.underlying;if(n.selector)return(Array.isArray(n.selector)?n.selector:[n.selector]).find(r=>r.type===e)}),this.underlying=t,this.opts=i}isEqual(t){return(t==null?void 0:t.type)!=="Annotation"?!1:this.underlying===t.underlying?!0:!this.underlying.id||!t.underlying.id?!1:Lh(this.underlying,t.underlying)}get readOnly(){var t;return(t=this.opts)==null?void 0:t.readOnly}get id(){return this.underlying.id}get context(){return this.underlying["@context"]}get type(){return this.underlying.type}get motivation(){return this.underlying.motivation}get body(){return this.underlying.body}get target(){return this.underlying.target}get bodies(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}set bodies(t){this.underlying.body=t}get targets(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}get quote(){var t;return(t=this.selector("TextQuoteSelector"))==null?void 0:t.exact}get start(){var t;return(t=this.selector("TextPositionSelector"))==null?void 0:t.start}get end(){var t;return(t=this.selector("TextPositionSelector"))==null?void 0:t.end}};let Vt=is;T(Vt,"create",t=>{const i={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:`#${Ih()}`,body:[]};return new is({...i,...t})});class Gn{constructor(i,e){T(this,"clone",n=>{const r=new Gn;return r.underlying=JSON.parse(JSON.stringify(this.underlying)),n&&(r.underlying={...r.underlying,...n}),r}),T(this,"selector",n=>{const{target:r}=this.underlying;if(r.selector)return(Array.isArray(r.selector)?r.selector:[r.selector]).find(o=>o.type===n)}),T(this,"toAnnotation",()=>{const n=Object.assign({},this.underlying,{type:"Annotation",id:`#${Ih()}`});return new Vt(n)}),this.underlying={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Selection",body:e||[],target:i}}get context(){return this.underlying["@context"]}get type(){return this.underlying.type}get body(){return this.underlying.body}get target(){return this.underlying.target}get targets(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}isEqual(i){return i?Lh(this.underlying,i.underlying):!1}get bodies(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}get quote(){var i;return(i=this.selector("TextQuoteSelector"))==null?void 0:i.exact}get isSelection(){return!0}}let rs=0;var Db=()=>({setServerTime:t=>{const i=Date.now();rs=t-i},getCurrentTimeAdjusted:()=>new Date(Date.now()+rs).toISOString(),toClientTime:t=>Date.parse(t)-rs});const Ob=(t,i)=>{if(t){const e=t==="auto"?window.navigator.userLanguage||window.navigator.language:t,n=e.split("-")[0].toLowerCase(),r=[e,n].find(o=>Hy.includes(o));r||console.warn(`Unsupported locale '${e}'. Falling back to default en.`),Ye.init(r,i)}else Ye.init(null,i)};var Nh={exports:{}};(function(t){//! openseadragon 3.0.0
//! Built on 2021-12-15
//! Git commit: v3.0.0-0-3eded36
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function i(e){return new i.Viewer(e)}(function(e){e.version={versionStr:"3.0.0",major:parseInt("3",10),minor:parseInt("0",10),revision:parseInt("0",10)};var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},r=Object.prototype.toString,o=Object.prototype.hasOwnProperty;e.isFunction=function(s){return e.type(s)==="function"},e.isArray=Array.isArray||function(s){return e.type(s)==="array"},e.isWindow=function(s){return s&&typeof s=="object"&&"setInterval"in s},e.type=function(s){return s==null?String(s):n[r.call(s)]||"object"},e.isPlainObject=function(s){if(!s||i.type(s)!=="object"||s.nodeType||e.isWindow(s)||s.constructor&&!o.call(s,"constructor")&&!o.call(s.constructor.prototype,"isPrototypeOf"))return!1;var a;for(var l in s)a=l;return a===void 0||o.call(s,a)},e.isEmptyObject=function(s){for(var a in s)return!1;return!0},e.freezeObject=function(s){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(a){return a},e.freezeObject(s)},e.supportsCanvas=function(){var s=document.createElement("canvas");return!!(e.isFunction(s.getContext)&&s.getContext("2d"))}(),e.isCanvasTainted=function(s){var a=!1;try{s.getContext("2d").getImageData(0,0,1,1)}catch{a=!0}return a},e.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),e.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),e.supportsEventListenerOptions=function(){var s=0;if(e.supportsAddEventListener)try{var a={get capture(){return s++,!1},get once(){return s++,!1},get passive(){return s++,!1}};window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch{s=0}return s>=3}(),e.getCurrentPixelDensityRatio=function(){if(e.supportsCanvas){var s=document.createElement("canvas").getContext("2d"),a=window.devicePixelRatio||1,l=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1;return Math.max(a,1)/l}else return 1},e.pixelDensityRatio=e.getCurrentPixelDensityRatio()})(i),function(e){e.extend=function(){var l,u,c,h,d,g,y=arguments[0]||{},S=arguments.length,E=!1,C=1;for(typeof y=="boolean"&&(E=y,y=arguments[1]||{},C=2),typeof y!="object"&&!i.isFunction(y)&&(y={}),S===C&&(y=this,--C);C<S;C++)if(l=arguments[C],l!==null||l!==void 0)for(u in l)c=y[u],h=l[u],y!==h&&(E&&h&&(i.isPlainObject(h)||(d=i.isArray(h)))?(d?(d=!1,g=c&&i.isArray(c)?c:[]):g=c&&i.isPlainObject(c)?c:{},y[u]=i.extend(E,g,h)):h!==void 0&&(y[u]=h));return y};var n=function(){if(typeof navigator!="object")return!1;var l=navigator.userAgent;return typeof l!="string"?!1:l.indexOf("iPhone")!==-1||l.indexOf("iPad")!==-1||l.indexOf("iPod")!==-1};e.extend(e,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:n(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(l,u){return function(){var c=arguments;return c===void 0&&(c=[]),u.apply(l,c)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},_viewers:new Map,getViewer:function(l){return e._viewers.get(this.getElement(l))},getElement:function(l){return typeof l=="string"&&(l=document.getElementById(l)),l},getElementPosition:function(l){var u=new e.Point,c,h;for(l=e.getElement(l),c=e.getElementStyle(l).position==="fixed",h=a(l,c);h;)u.x+=l.offsetLeft,u.y+=l.offsetTop,c&&(u=u.plus(e.getPageScroll())),l=h,c=e.getElementStyle(l).position==="fixed",h=a(l,c);return u},getElementOffset:function(l){l=e.getElement(l);var u=l&&l.ownerDocument,c,h,d={top:0,left:0};return u?(c=u.documentElement,typeof l.getBoundingClientRect<"u"&&(d=l.getBoundingClientRect()),h=u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1,new e.Point(d.left+(h.pageXOffset||c.scrollLeft)-(c.clientLeft||0),d.top+(h.pageYOffset||c.scrollTop)-(c.clientTop||0))):new e.Point},getElementSize:function(l){return l=e.getElement(l),new e.Point(l.clientWidth,l.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(l){return l=e.getElement(l),l.currentStyle}:function(l){return l=e.getElement(l),window.getComputedStyle(l,"")},getCssPropertyWithVendorPrefix:function(l){var u={};return e.getCssPropertyWithVendorPrefix=function(c){if(u[c]!==void 0)return u[c];var h=document.createElement("div").style,d=null;if(h[c]!==void 0)d=c;else for(var g=["Webkit","Moz","MS","O","webkit","moz","ms","o"],y=e.capitalizeFirstLetter(c),S=0;S<g.length;S++){var E=g[S]+y;if(h[E]!==void 0){d=E;break}}return u[c]=d,d},e.getCssPropertyWithVendorPrefix(l)},capitalizeFirstLetter:function(l){return l.charAt(0).toUpperCase()+l.slice(1)},positiveModulo:function(l,u){var c=l%u;return c<0&&(c+=u),c},pointInElement:function(l,u){l=e.getElement(l);var c=e.getElementOffset(l),h=e.getElementSize(l);return u.x>=c.x&&u.x<c.x+h.x&&u.y<c.y+h.y&&u.y>=c.y},getMousePosition:function(l){if(typeof l.pageX=="number")e.getMousePosition=function(u){var c=new e.Point;return c.x=u.pageX,c.y=u.pageY,c};else if(typeof l.clientX=="number")e.getMousePosition=function(u){var c=new e.Point;return c.x=u.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c.y=u.clientY+document.body.scrollTop+document.documentElement.scrollTop,c};else throw new Error("Unknown event mouse position, no known technique.");return e.getMousePosition(l)},getPageScroll:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.pageXOffset=="number")e.getPageScroll=function(){return new e.Point(window.pageXOffset,window.pageYOffset)};else if(u.scrollLeft||u.scrollTop)e.getPageScroll=function(){return new e.Point(document.body.scrollLeft,document.body.scrollTop)};else if(l.scrollLeft||l.scrollTop)e.getPageScroll=function(){return new e.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new e.Point(0,0);return e.getPageScroll()},setPageScroll:function(l){if(typeof window.scrollTo<"u")e.setPageScroll=function(h){window.scrollTo(h.x,h.y)};else{var u=e.getPageScroll();if(u.x===l.x&&u.y===l.y)return;document.body.scrollLeft=l.x,document.body.scrollTop=l.y;var c=e.getPageScroll();if(c.x!==u.x&&c.y!==u.y){e.setPageScroll=function(h){document.body.scrollLeft=h.x,document.body.scrollTop=h.y};return}if(document.documentElement.scrollLeft=l.x,document.documentElement.scrollTop=l.y,c=e.getPageScroll(),c.x!==u.x&&c.y!==u.y){e.setPageScroll=function(h){document.documentElement.scrollLeft=h.x,document.documentElement.scrollTop=h.y};return}e.setPageScroll=function(h){}}e.setPageScroll(l)},getWindowSize:function(){var l=document.documentElement||{},u=document.body||{};if(typeof window.innerWidth=="number")e.getWindowSize=function(){return new e.Point(window.innerWidth,window.innerHeight)};else if(l.clientWidth||l.clientHeight)e.getWindowSize=function(){return new e.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(u.clientWidth||u.clientHeight)e.getWindowSize=function(){return new e.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return e.getWindowSize()},makeCenteredNode:function(l){l=e.getElement(l);var u=[e.makeNeutralElement("div"),e.makeNeutralElement("div"),e.makeNeutralElement("div")];return e.extend(u[0].style,{display:"table",height:"100%",width:"100%"}),e.extend(u[1].style,{display:"table-row"}),e.extend(u[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),u[0].appendChild(u[1]),u[1].appendChild(u[2]),u[2].appendChild(l),u[0]},makeNeutralElement:function(l){var u=document.createElement(l),c=u.style;return c.background="transparent none",c.border="none",c.margin="0px",c.padding="0px",c.position="static",u},now:function(){return Date.now?e.now=Date.now:e.now=function(){return new Date().getTime()},e.now()},makeTransparentImage:function(l){var u=e.makeNeutralElement("img");return u.src=l,u},setElementOpacity:function(l,u,c){var h,d;l=e.getElement(l),c&&!e.Browser.alpha&&(u=Math.round(u)),e.Browser.opacity?l.style.opacity=u<1?u:"":u<1?(h=Math.round(100*u),d="alpha(opacity="+h+")",l.style.filter=d):l.style.filter=""},setElementTouchActionNone:function(l){l=e.getElement(l),typeof l.style.touchAction<"u"?l.style.touchAction="none":typeof l.style.msTouchAction<"u"&&(l.style.msTouchAction="none")},setElementPointerEvents:function(l,u){l=e.getElement(l),typeof l.style.pointerEvents<"u"&&(l.style.pointerEvents=u)},setElementPointerEventsNone:function(l){e.setElementPointerEvents(l,"none")},addClass:function(l,u){l=e.getElement(l),l.className?(" "+l.className+" ").indexOf(" "+u+" ")===-1&&(l.className+=" "+u):l.className=u},indexOf:function(l,u,c){return Array.prototype.indexOf?this.indexOf=function(h,d,g){return h.indexOf(d,g)}:this.indexOf=function(h,d,g){var y,S=g||0,E;if(!h)throw new TypeError;if(E=h.length,E===0||S>=E)return-1;for(S<0&&(S=E-Math.abs(S)),y=S;y<E;y++)if(h[y]===d)return y;return-1},this.indexOf(l,u,c)},removeClass:function(l,u){var c,h=[],d;for(l=e.getElement(l),c=l.className.split(/\s+/),d=0;d<c.length;d++)c[d]&&c[d]!==u&&h.push(c[d]);l.className=h.join(" ")},normalizeEventListenerOptions:function(l){var u;return typeof l<"u"?typeof l=="boolean"?u=e.supportsEventListenerOptions?{capture:l}:l:u=e.supportsEventListenerOptions?l:typeof l.capture<"u"?l.capture:!1:u=e.supportsEventListenerOptions?{capture:!1}:!1,u},addEvent:function(){if(e.supportsAddEventListener)return function(l,u,c,h){h=e.normalizeEventListenerOptions(h),l=e.getElement(l),l.addEventListener(u,c,h)};if(document.documentElement.attachEvent&&document.attachEvent)return function(l,u,c){l=e.getElement(l),l.attachEvent("on"+u,c)};throw new Error("No known event model.")}(),removeEvent:function(){if(e.supportsRemoveEventListener)return function(l,u,c,h){h=e.normalizeEventListenerOptions(h),l=e.getElement(l),l.removeEventListener(u,c,h)};if(document.documentElement.detachEvent&&document.detachEvent)return function(l,u,c){l=e.getElement(l),l.detachEvent("on"+u,c)};throw new Error("No known event model.")}(),cancelEvent:function(l){l.preventDefault()},eventIsCanceled:function(l){return l.defaultPrevented},stopEvent:function(l){l.stopPropagation()},createCallback:function(l,u){var c=[],h;for(h=2;h<arguments.length;h++)c.push(arguments[h]);return function(){var d=c.concat([]),g;for(g=0;g<arguments.length;g++)d.push(arguments[g]);return u.apply(l,d)}},getUrlParameter:function(l){var u=s[l];return u||null},getUrlProtocol:function(l){var u=l.match(/^([a-z]+:)\/\//i);return u===null?window.location.protocol:u[1].toLowerCase()},createAjaxRequest:function(l){var u;try{u=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{u=!1}if(u)window.XMLHttpRequest?e.createAjaxRequest=function(c){return c?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:e.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)e.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return e.createAjaxRequest(l)},makeAjaxRequest:function(l,u,c){var h,d,g;e.isPlainObject(l)&&(u=l.success,c=l.error,h=l.withCredentials,d=l.headers,g=l.responseType||null,l=l.url);var y=e.getUrlProtocol(l),S=e.createAjaxRequest(y==="file:");if(!e.isFunction(u))throw new Error("makeAjaxRequest requires a success callback");S.onreadystatechange=function(){S.readyState===4&&(S.onreadystatechange=function(){},S.status>=200&&S.status<300||S.status===0&&y!=="http:"&&y!=="https:"?u(S):(e.console.log("AJAX request returned %d: %s",S.status,l),e.isFunction(c)&&c(S)))};try{if(S.open("GET",l,!0),g&&(S.responseType=g),d)for(var E in d)Object.prototype.hasOwnProperty.call(d,E)&&d[E]&&S.setRequestHeader(E,d[E]);h&&(S.withCredentials=!0),S.send(null)}catch(C){e.console.log("%s while making AJAX request: %s",C.name,C.message),S.onreadystatechange=function(){},e.isFunction(c)&&c(S,C)}return S},jsonp:function(l){var u,c=l.url,h=document.head||document.getElementsByTagName("head")[0]||document.documentElement,d=l.callbackName||"openseadragon"+e.now(),g=window[d],y="$1"+d+"$2",S=l.param||"callback",E=l.callback;c=c.replace(/(=)\?(&|$)|\?\?/i,y),c+=(/\?/.test(c)?"&":"?")+S+"="+d,window[d]=function(C){if(g)window[d]=g;else try{delete window[d]}catch{}E&&e.isFunction(E)&&E(C)},u=document.createElement("script"),(l.async!==void 0||l.async!==!1)&&(u.async="async"),l.scriptCharset&&(u.charset=l.scriptCharset),u.src=c,u.onload=u.onreadystatechange=function(C,p){(p||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,h&&u.parentNode&&h.removeChild(u),u=void 0)},h.insertBefore(u,h.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(l){if(window.DOMParser)e.parseXml=function(u){var c=null,h;return h=new DOMParser,c=h.parseFromString(u,"text/xml"),c};else if(window.ActiveXObject)e.parseXml=function(u){var c=null;return c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(u),c};else throw new Error("Browser doesn't support XML DOM.");return e.parseXml(l)},parseJSON:function(l){return e.parseJSON=window.JSON.parse,e.parseJSON(l)},imageFormatSupported:function(l){return l=l||"",!!o[l.toLowerCase()]},setImageFormatsSupported:function(l){e.extend(o,l)}});var r=function(l){};e.console=window.console||{log:r,debug:r,info:r,warn:r,error:r,assert:r},e.Browser={vendor:e.BROWSERS.UNKNOWN,version:0,alpha:!0};var o={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},s={};(function(){var l=navigator.appVersion,u=navigator.userAgent,c;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(u.substring(u.indexOf("MSIE")+5,u.indexOf(";",u.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(u.indexOf("Edge")>=0?(e.Browser.vendor=e.BROWSERS.EDGE,e.Browser.version=parseFloat(u.substring(u.indexOf("Edge")+5))):u.indexOf("Edg")>=0?(e.Browser.vendor=e.BROWSERS.CHROMEEDGE,e.Browser.version=parseFloat(u.substring(u.indexOf("Edg")+4))):u.indexOf("Firefox")>=0?(e.Browser.vendor=e.BROWSERS.FIREFOX,e.Browser.version=parseFloat(u.substring(u.indexOf("Firefox")+8))):u.indexOf("Safari")>=0?(e.Browser.vendor=u.indexOf("Chrome")>=0?e.BROWSERS.CHROME:e.BROWSERS.SAFARI,e.Browser.version=parseFloat(u.substring(u.substring(0,u.indexOf("Safari")).lastIndexOf("/")+1,u.indexOf("Safari")))):(c=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),c.exec(u)!==null&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":e.Browser.vendor=e.BROWSERS.OPERA,e.Browser.version=parseFloat(l);break}var h=window.location.search.substring(1),d=h.split("&"),g,y,S;for(S=0;S<d.length;S++)if(g=d[S],y=g.indexOf("="),y>0){var E=g.substring(0,y),C=g.substring(y+1);try{s[E]=decodeURIComponent(C)}catch{e.console.error("Ignoring malformed URL parameter: %s=%s",E,C)}}e.Browser.alpha=!(e.Browser.vendor===e.BROWSERS.CHROME&&e.Browser.version<2),e.Browser.opacity=!0,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<11&&e.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(l){var u=l.requestAnimationFrame||l.mozRequestAnimationFrame||l.webkitRequestAnimationFrame||l.msRequestAnimationFrame,c=l.cancelAnimationFrame||l.mozCancelAnimationFrame||l.webkitCancelAnimationFrame||l.msCancelAnimationFrame;if(u&&c)e.requestAnimationFrame=function(){return u.apply(l,arguments)},e.cancelAnimationFrame=function(){return c.apply(l,arguments)};else{var h=[],d=[],g=0,y;e.requestAnimationFrame=function(S){return h.push([++g,S]),y||(y=setInterval(function(){if(h.length){var E=e.now(),C=d;for(d=h,h=C;d.length;)d.shift()[1](E)}else clearInterval(y),y=void 0},1e3/50)),g},e.cancelAnimationFrame=function(S){var E,C;for(E=0,C=h.length;E<C;E+=1)if(h[E][0]===S){h.splice(E,1);return}for(E=0,C=d.length;E<C;E+=1)if(d[E][0]===S){d.splice(E,1);return}}}}(window);function a(l,u){return u&&l!==document.body?document.body:l.offsetParent}}(i),function(e,n){t.exports?t.exports=n():e.OpenSeadragon=n()}(St,function(){return i}),function(e){var n={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.fullscreenElement},n.requestFullScreen=function(r){return r.requestFullscreen()},n.exitFullScreen=function(){document.exitFullscreen()},n.fullScreenEventName="fullscreenchange",n.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.msFullscreenElement},n.requestFullScreen=function(r){return r.msRequestFullscreen()},n.exitFullScreen=function(){document.msExitFullscreen()},n.fullScreenEventName="MSFullscreenChange",n.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitFullscreenElement},n.requestFullScreen=function(r){return r.webkitRequestFullscreen()},n.exitFullScreen=function(){document.webkitExitFullscreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},n.requestFullScreen=function(r){return r.webkitRequestFullScreen()},n.exitFullScreen=function(){document.webkitCancelFullScreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.mozFullScreenElement},n.requestFullScreen=function(r){return r.mozRequestFullScreen()},n.exitFullScreen=function(){document.mozCancelFullScreen()},n.fullScreenEventName="mozfullscreenchange",n.fullScreenErrorEventName="mozfullscreenerror"),n.isFullScreen=function(){return n.getFullScreenElement()!==null},n.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),n.exitFullScreen()},e.extend(e,n)}(i),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(n,r,o,s){var a=this;s=s||1;var l=0,u=function(c){l++,l===s&&a.removeHandler(n,u),r(c)};this.addHandler(n,u,o)},addHandler:function(n,r,o){var s=this.events[n];s||(this.events[n]=s=[]),r&&e.isFunction(r)&&(s[s.length]={handler:r,userData:o||null})},removeHandler:function(n,r){var o=this.events[n],s=[],a;if(o&&e.isArray(o)){for(a=0;a<o.length;a++)o[a].handler!==r&&s.push(o[a]);this.events[n]=s}},removeAllHandlers:function(n){if(n)this.events[n]=[];else for(var r in this.events)this.events[r]=[]},getHandler:function(n){var r=this.events[n];return!r||!r.length?null:(r=r.length===1?[r[0]]:Array.apply(null,r),function(o,s){var a,l=r.length;for(a=0;a<l;a++)r[a]&&(s.eventSource=o,s.userData=r[a].userData,r[a].handler(s))})},raiseEvent:function(n,r){var o=this.getHandler(n);o&&(r||(r={}),o(this,r))}}}(i),function(e){var n={};e.MouseTracker=function(v){var m=arguments;e.isPlainObject(v)||(v={element:m[0],clickTimeThreshold:m[1],clickDistThreshold:m[2]}),this.hash=Math.random(),this.element=e.getElement(v.element),this.clickTimeThreshold=v.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=v.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=v.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=v.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=v.userData||null,this.stopDelay=v.stopDelay||50,this.preProcessEventHandler=v.preProcessEventHandler||null,this.contextMenuHandler=v.contextMenuHandler||null,this.enterHandler=v.enterHandler||null,this.leaveHandler=v.leaveHandler||null,this.exitHandler=v.exitHandler||null,this.overHandler=v.overHandler||null,this.outHandler=v.outHandler||null,this.pressHandler=v.pressHandler||null,this.nonPrimaryPressHandler=v.nonPrimaryPressHandler||null,this.releaseHandler=v.releaseHandler||null,this.nonPrimaryReleaseHandler=v.nonPrimaryReleaseHandler||null,this.moveHandler=v.moveHandler||null,this.scrollHandler=v.scrollHandler||null,this.clickHandler=v.clickHandler||null,this.dblClickHandler=v.dblClickHandler||null,this.dragHandler=v.dragHandler||null,this.dragEndHandler=v.dragEndHandler||null,this.pinchHandler=v.pinchHandler||null,this.stopHandler=v.stopHandler||null,this.keyDownHandler=v.keyDownHandler||null,this.keyUpHandler=v.keyUpHandler||null,this.keyHandler=v.keyHandler||null,this.focusHandler=v.focusHandler||null,this.blurHandler=v.blurHandler||null;var w=this;n[this.hash]={click:function(b){x(w,b)},dblclick:function(b){A(w,b)},keydown:function(b){P(w,b)},keyup:function(b){D(w,b)},keypress:function(b){O(w,b)},focus:function(b){I(w,b)},blur:function(b){N(w,b)},contextmenu:function(b){W(w,b)},wheel:function(b){q(w,b)},mousewheel:function(b){G(w,b)},DOMMouseScroll:function(b){G(w,b)},MozMousePixelScroll:function(b){G(w,b)},losecapture:function(b){K(w,b)},mouseenter:function(b){H(w,b)},mouseleave:function(b){V(w,b)},mouseover:function(b){j(w,b)},mouseout:function(b){U(w,b)},mousedown:function(b){Q(w,b)},mouseup:function(b){ye(w,b)},mousemove:function(b){nt(w,b)},touchstart:function(b){oe(w,b)},touchend:function(b){re(w,b)},touchmove:function(b){ae(w,b)},touchcancel:function(b){pe(w,b)},gesturestart:function(b){Ee(w,b)},gesturechange:function(b){$(w,b)},gotpointercapture:function(b){le(w,b)},lostpointercapture:function(b){M(w,b)},pointerenter:function(b){H(w,b)},pointerleave:function(b){V(w,b)},pointerover:function(b){j(w,b)},pointerout:function(b){U(w,b)},pointerdown:function(b){Q(w,b)},pointerup:function(b){ye(w,b)},pointermove:function(b){nt(w,b)},pointercancel:function(b){f(w,b)},pointerupcaptured:function(b){Se(w,b)},pointermovecaptured:function(b){Ge(w,b)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,e.MouseTracker.havePointerEvents&&e.setElementPointerEvents(this.element,"auto"),this.exitHandler&&e.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),v.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){l(this),this.element=null,n[this.hash]=null,delete n[this.hash]},isTracking:function(){return n[this.hash].tracking},setTracking:function(v){return v?a(this):l(this),this},getActivePointersListByType:function(v){var m=n[this.hash],w,b=m.activePointersLists.length,k;for(w=0;w<b;w++)if(m.activePointersLists[w].type===v)return m.activePointersLists[w];return k=new e.MouseTracker.GesturePointList(v),m.activePointersLists.push(k),k},getActivePointerCount:function(){var v=n[this.hash],m,w=v.activePointersLists.length,b=0;for(m=0;m<w;m++)b+=v.activePointersLists[m].getLength();return b},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var r=function(){try{return window.self!==window.top}catch{return!0}}();function o(v){try{return v.addEventListener&&v.removeEventListener}catch{return!1}}e.MouseTracker.gesturePointVelocityTracker=function(){var v=[],m=0,w=0,b=function(be,te){return be.hash.toString()+te.type+te.id.toString()},k=function(){var be,te=v.length,Qe,Be,yn=e.now(),ad,ld,ud;for(ad=yn-w,w=yn,be=0;be<te;be++)Qe=v[be],Be=Qe.gPoint,Be.direction=Math.atan2(Be.currentPos.y-Qe.lastPos.y,Be.currentPos.x-Qe.lastPos.x),ld=Qe.lastPos.distanceTo(Be.currentPos),Qe.lastPos=Be.currentPos,ud=1e3*ld/(ad+1),Be.speed=.75*ud+.25*Be.speed},z=function(be,te){var Qe=b(be,te);v.push({guid:Qe,gPoint:te,lastPos:te.currentPos}),v.length===1&&(w=e.now(),m=window.setInterval(k,50))},ee=function(be,te){var Qe=b(be,te),Be,yn=v.length;for(Be=0;Be<yn;Be++)if(v[Be].guid===Qe){v.splice(Be,1),yn--,yn===0&&window.clearInterval(m);break}};return{addPoint:z,removePoint:ee}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",e.MouseTracker.wheelEventName],e.MouseTracker.wheelEventName==="DOMMouseScroll"&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.havePointerCapture=function(){var v=document.createElement("div");return e.isFunction(v.setPointerCapture)&&e.isFunction(v.releasePointerCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(e.MouseTracker.havePointerEvents=!1,e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.havePointerCapture=function(){var v=document.createElement("div");return e.isFunction(v.setCapture)&&e.isFunction(v.releaseCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),e.MouseTracker.GesturePointList=function(v){this._gPoints=[],this.type=v,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(v){return this._gPoints.push(v)},removeById:function(v){var m,w=this._gPoints.length;for(m=0;m<w;m++)if(this._gPoints[m].id===v){this._gPoints.splice(m,1);break}return this._gPoints.length},getByIndex:function(v){return v<this._gPoints.length?this._gPoints[v]:null},getById:function(v){var m,w=this._gPoints.length;for(m=0;m<w;m++)if(this._gPoints[m].id===v)return this._gPoints[m];return null},getPrimary:function(v){var m,w=this._gPoints.length;for(m=0;m<w;m++)if(this._gPoints[m].isPrimary)return this._gPoints[m];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(e.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(e.console.warn("GesturePointList.removeContact() Implausible contacts value"),this.contacts=0)}};function s(v){var m=n[v.hash],w,b,k,z,ee,be=m.activePointersLists.length;for(w=0;w<be;w++)if(k=m.activePointersLists[w],k.getLength()>0){for(ee=[],z=k.asArray(),b=0;b<z.length;b++)ee.push(z[b]);for(b=0;b<ee.length;b++)R(v,k,ee[b])}for(w=0;w<be;w++)m.activePointersLists.pop();m.sentDragEvent=!1}function a(v){var m=n[v.hash],w,b;if(!m.tracking){for(b=0;b<e.MouseTracker.subscribeEvents.length;b++)w=e.MouseTracker.subscribeEvents[b],e.addEvent(v.element,w,m[w],w===e.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);s(v),m.tracking=!0}}function l(v){var m=n[v.hash],w,b;if(m.tracking){for(b=0;b<e.MouseTracker.subscribeEvents.length;b++)w=e.MouseTracker.subscribeEvents[b],e.removeEvent(v.element,w,m[w],!1);s(v),m.tracking=!1}}function u(v,m){var w=n[v.hash];if(m==="pointerevent")return{upName:"pointerup",upHandler:w.pointerupcaptured,moveName:"pointermove",moveHandler:w.pointermovecaptured};if(m==="mouse")return{upName:"pointerup",upHandler:w.pointerupcaptured,moveName:"pointermove",moveHandler:w.pointermovecaptured};if(m==="touch")return{upName:"touchend",upHandler:w.touchendcaptured,moveName:"touchmove",moveHandler:w.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function c(v,m){var w;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents)try{v.element.setPointerCapture(m.id)}catch{e.console.warn("setPointerCapture() called on invalid pointer ID");return}else v.element.setCapture(!0);else w=u(v,e.MouseTracker.havePointerEvents?"pointerevent":m.type),r&&o(window.top)&&e.addEvent(window.top,w.upName,w.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,w.upName,w.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,w.moveName,w.moveHandler,!0);Y(v,m,!0)}function h(v,m){var w,b,k;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents){if(b=v.getActivePointersListByType(m.type),k=b.getById(m.id),!k||!k.captured)return;try{v.element.releasePointerCapture(m.id)}catch{}}else v.element.releaseCapture();else w=u(v,e.MouseTracker.havePointerEvents?"pointerevent":m.type),r&&o(window.top)&&e.removeEvent(window.top,w.upName,w.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,w.moveName,w.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,w.upName,w.upHandler,!0);Y(v,m,!1)}function d(v){return e.MouseTracker.havePointerEvents?v.pointerId:e.MouseTracker.mousePointerId}function g(v){return e.MouseTracker.havePointerEvents?v.pointerType||(e.Browser.vendor===e.BROWSERS.IE?"mouse":""):"mouse"}function y(v){return e.MouseTracker.havePointerEvents?v.isPrimary:!0}function S(v){return e.getMousePosition(v)}function E(v,m){return C(S(v),m)}function C(v,m){var w=e.getElementOffset(m);return v.minus(w)}function p(v,m){return new e.Point((v.x+m.x)/2,(v.y+m.y)/2)}function x(v,m){var w={originalEvent:m,eventType:"click",pointerType:"mouse",isEmulated:!1};F(v,w),w.preventDefault&&!w.defaultPrevented&&e.cancelEvent(m),w.stopPropagation&&e.stopEvent(m)}function A(v,m){var w={originalEvent:m,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};F(v,w),w.preventDefault&&!w.defaultPrevented&&e.cancelEvent(m),w.stopPropagation&&e.stopEvent(m)}function P(v,m){var w=null,b={originalEvent:m,eventType:"keydown",pointerType:"",isEmulated:!1};F(v,b),v.keyDownHandler&&!b.preventGesture&&!b.defaultPrevented&&(w={eventSource:v,keyCode:m.keyCode?m.keyCode:m.charCode,ctrl:m.ctrlKey,shift:m.shiftKey,alt:m.altKey,meta:m.metaKey,originalEvent:m,preventDefault:b.preventDefault||b.defaultPrevented,userData:v.userData},v.keyDownHandler(w)),(w&&w.preventDefault||b.preventDefault&&!b.defaultPrevented)&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function D(v,m){var w=null,b={originalEvent:m,eventType:"keyup",pointerType:"",isEmulated:!1};F(v,b),v.keyUpHandler&&!b.preventGesture&&!b.defaultPrevented&&(w={eventSource:v,keyCode:m.keyCode?m.keyCode:m.charCode,ctrl:m.ctrlKey,shift:m.shiftKey,alt:m.altKey,meta:m.metaKey,originalEvent:m,preventDefault:b.preventDefault||b.defaultPrevented,userData:v.userData},v.keyUpHandler(w)),(w&&w.preventDefault||b.preventDefault&&!b.defaultPrevented)&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function O(v,m){var w=null,b={originalEvent:m,eventType:"keypress",pointerType:"",isEmulated:!1};F(v,b),v.keyHandler&&!b.preventGesture&&!b.defaultPrevented&&(w={eventSource:v,keyCode:m.keyCode?m.keyCode:m.charCode,ctrl:m.ctrlKey,shift:m.shiftKey,alt:m.altKey,meta:m.metaKey,originalEvent:m,preventDefault:b.preventDefault||b.defaultPrevented,userData:v.userData},v.keyHandler(w)),(w&&w.preventDefault||b.preventDefault&&!b.defaultPrevented)&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function I(v,m){var w={originalEvent:m,eventType:"focus",pointerType:"",isEmulated:!1};F(v,w),v.focusHandler&&!w.preventGesture&&v.focusHandler({eventSource:v,originalEvent:m,userData:v.userData})}function N(v,m){var w={originalEvent:m,eventType:"blur",pointerType:"",isEmulated:!1};F(v,w),v.blurHandler&&!w.preventGesture&&v.blurHandler({eventSource:v,originalEvent:m,userData:v.userData})}function W(v,m){var w=null,b={originalEvent:m,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};F(v,b),v.contextMenuHandler&&!b.preventGesture&&!b.defaultPrevented&&(w={eventSource:v,position:C(S(m),v.element),originalEvent:b.originalEvent,preventDefault:b.preventDefault||b.defaultPrevented,userData:v.userData},v.contextMenuHandler(w)),(w&&w.preventDefault||b.preventDefault&&!b.defaultPrevented)&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function q(v,m){J(v,m,m)}function G(v,m){var w={target:m.target||m.srcElement,type:"wheel",shiftKey:m.shiftKey||!1,clientX:m.clientX,clientY:m.clientY,pageX:m.pageX?m.pageX:m.clientX,pageY:m.pageY?m.pageY:m.clientY,deltaMode:m.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};e.MouseTracker.wheelEventName==="mousewheel"?w.deltaY=-m.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:w.deltaY=m.detail,J(v,w,m)}function J(v,m,w){var b=0,k,z=null;b=m.deltaY<0?1:-1,k={originalEvent:m,eventType:"wheel",pointerType:"mouse",isEmulated:m!==w},F(v,k),v.scrollHandler&&!k.preventGesture&&!k.defaultPrevented&&(z={eventSource:v,pointerType:"mouse",position:E(m,v.element),scroll:b,shift:m.shiftKey,isTouchEvent:!1,originalEvent:w,preventDefault:k.preventDefault||k.defaultPrevented,userData:v.userData},v.scrollHandler(z)),k.stopPropagation&&e.stopEvent(w),(z&&z.preventDefault||k.preventDefault&&!k.defaultPrevented)&&e.cancelEvent(w)}function K(v,m){var w={id:e.MouseTracker.mousePointerId,type:"mouse"},b={originalEvent:m,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};F(v,b),m.target===v.element&&Y(v,w,!1),b.stopPropagation&&e.stopEvent(m)}function oe(v,m){var w,b,k=m.changedTouches.length,z,ee=v.getActivePointersListByType("touch");w=e.now(),ee.getLength()>m.touches.length-k&&e.console.warn("Tracked touch contact count doesn't match event.touches.length");var be={originalEvent:m,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(F(v,be),b=0;b<k;b++)z={id:m.changedTouches[b].identifier,type:"touch",isPrimary:ee.getLength()===0,currentPos:S(m.changedTouches[b]),currentTime:w},X(v,be,z),se(v,be,z,0),Y(v,z,!0);be.preventDefault&&!be.defaultPrevented&&e.cancelEvent(m),be.stopPropagation&&e.stopEvent(m)}function re(v,m){var w,b,k=m.changedTouches.length,z;w=e.now();var ee={originalEvent:m,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(F(v,ee),b=0;b<k;b++)z={id:m.changedTouches[b].identifier,type:"touch",currentPos:S(m.changedTouches[b]),currentTime:w},Te(v,ee,z,0),Y(v,z,!1),fe(v,ee,z);ee.preventDefault&&!ee.defaultPrevented&&e.cancelEvent(m),ee.stopPropagation&&e.stopEvent(m)}function ae(v,m){var w,b,k=m.changedTouches.length,z;w=e.now();var ee={originalEvent:m,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(F(v,ee),b=0;b<k;b++)z={id:m.changedTouches[b].identifier,type:"touch",currentPos:S(m.changedTouches[b]),currentTime:w},he(v,ee,z);ee.preventDefault&&!ee.defaultPrevented&&e.cancelEvent(m),ee.stopPropagation&&e.stopEvent(m)}function pe(v,m){var w=m.changedTouches.length,b,k,z={originalEvent:m,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(F(v,z),b=0;b<w;b++)k={id:m.changedTouches[b].identifier,type:"touch"},ze(v,z,k);z.stopPropagation&&e.stopEvent(m)}function Ee(v,m){return e.eventIsCanceled(m)||m.preventDefault(),!1}function $(v,m){return e.eventIsCanceled(m)||m.preventDefault(),!1}function le(v,m){var w={originalEvent:m,eventType:"gotpointercapture",pointerType:g(m),isEmulated:!1};F(v,w),m.target===v.element&&Y(v,{id:m.pointerId,type:g(m)},!0),w.stopPropagation&&e.stopEvent(m)}function M(v,m){var w={originalEvent:m,eventType:"lostpointercapture",pointerType:g(m),isEmulated:!1};F(v,w),m.target===v.element&&Y(v,{id:m.pointerId,type:g(m)},!1),w.stopPropagation&&e.stopEvent(m)}function H(v,m){var w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()},b={originalEvent:m,eventType:"pointerenter",pointerType:w.type,isEmulated:!1};F(v,b),X(v,b,w)}function V(v,m){var w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()},b={originalEvent:m,eventType:"pointerleave",pointerType:w.type,isEmulated:!1};F(v,b),fe(v,b,w)}function j(v,m){var w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()},b={originalEvent:m,eventType:"pointerover",pointerType:w.type,isEmulated:!1};F(v,b),xe(v,b,w),b.preventDefault&&!b.defaultPrevented&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function U(v,m){var w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()},b={originalEvent:m,eventType:"pointerout",pointerType:w.type,isEmulated:!1};F(v,b),ge(v,b,w),b.preventDefault&&!b.defaultPrevented&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function Q(v,m){var w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()},b=e.MouseTracker.havePointerEvents&&w.type==="touch"&&e.Browser.vendor!==e.BROWSERS.IE,k={originalEvent:m,eventType:"pointerdown",pointerType:w.type,isEmulated:!1};F(v,k),se(v,k,w,m.button),k.preventDefault&&!k.defaultPrevented&&e.cancelEvent(m),k.stopPropagation&&e.stopEvent(m),k.shouldCapture&&(b?Y(v,w,!0):c(v,w))}function ye(v,m){de(v,m)}function Se(v,m){var w=v.getActivePointersListByType(g(m));w.getById(m.pointerId)&&de(v,m),e.stopEvent(m)}function de(v,m){var w;w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()};var b={originalEvent:m,eventType:"pointerup",pointerType:w.type,isEmulated:!1};F(v,b),Te(v,b,w,m.button),b.preventDefault&&!b.defaultPrevented&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m),b.shouldReleaseCapture&&(m.target===v.element?h(v,w):Y(v,w,!1))}function nt(v,m){Je(v,m)}function Ge(v,m){var w=v.getActivePointersListByType(g(m));w.getById(m.pointerId)&&Je(v,m),e.stopEvent(m)}function Je(v,m){var w={id:d(m),type:g(m),isPrimary:y(m),currentPos:S(m),currentTime:e.now()},b={originalEvent:m,eventType:"pointermove",pointerType:w.type,isEmulated:!1};F(v,b),he(v,b,w),b.preventDefault&&!b.defaultPrevented&&e.cancelEvent(m),b.stopPropagation&&e.stopEvent(m)}function f(v,m){var w={id:m.pointerId,type:g(m)},b={originalEvent:m,eventType:"pointercancel",pointerType:w.type,isEmulated:!1};F(v,b),ze(v,b,w),b.stopPropagation&&e.stopEvent(m)}function _(v,m){return m.speed=0,m.direction=0,m.contactPos=m.currentPos,m.contactTime=m.currentTime,m.lastPos=m.currentPos,m.lastTime=m.currentTime,v.add(m)}function R(v,m,w){var b,k=m.getById(w.id);return k?(k.captured&&(e.console.warn("stopTrackingPointer() called on captured pointer"),h(v,k)),(m.type==="mouse"||m.type==="pen")&&m.contacts>0&&m.removeContact(),b=m.removeById(w.id)):b=m.getLength(),b}function L(v,m){switch(m.eventType){case"pointermove":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!1,m.preventGesture=!v.hasGestureHandlers,m.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!1,m.preventGesture=!1,m.stopPropagation=!1;break;case"pointerdown":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!1,m.preventGesture=!v.hasGestureHandlers,m.stopPropagation=!1;break;case"pointerup":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!1,m.preventGesture=!v.hasGestureHandlers,m.stopPropagation=!1;break;case"wheel":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!1,m.preventGesture=!v.hasScrollHandler,m.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":m.isStoppable=!0,m.isCancelable=!1,m.preventDefault=!1,m.preventGesture=!1,m.stopPropagation=!1;break;case"click":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!!v.clickHandler,m.preventGesture=!1,m.stopPropagation=!1;break;case"dblclick":m.isStoppable=!0,m.isCancelable=!0,m.preventDefault=!!v.dblClickHandler,m.preventGesture=!1,m.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:m.isStoppable=!1,m.isCancelable=!1,m.preventDefault=!1,m.preventGesture=!1,m.stopPropagation=!1;break}}function F(v,m){m.eventSource=v,m.eventPhase=m.originalEvent&&typeof m.originalEvent.eventPhase<"u"?m.originalEvent.eventPhase:0,m.defaultPrevented=e.eventIsCanceled(m.originalEvent),m.shouldCapture=!1,m.shouldReleaseCapture=!1,m.userData=v.userData,L(v,m),v.preProcessEventHandler&&v.preProcessEventHandler(m)}function Y(v,m,w){var b=v.getActivePointersListByType(m.type),k=b.getById(m.id);k?w&&!k.captured?(k.captured=!0,b.captureCount++):!w&&k.captured&&(k.captured=!1,b.captureCount--,b.captureCount<0&&(b.captureCount=0,e.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):e.console.warn("updatePointerCaptured() called on untracked pointer")}function X(v,m,w){var b=v.getActivePointersListByType(w.type),k;k=b.getById(w.id),k?(k.insideElement=!0,k.lastPos=k.currentPos,k.lastTime=k.currentTime,k.currentPos=w.currentPos,k.currentTime=w.currentTime,w=k):(w.captured=!1,w.insideElementPressed=!1,w.insideElement=!0,_(b,w)),v.enterHandler&&v.enterHandler({eventSource:v,pointerType:w.type,position:C(w.currentPos,v.element),buttons:b.buttons,pointers:v.getActivePointerCount(),insideElementPressed:w.insideElementPressed,buttonDownAny:b.buttons!==0,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData})}function fe(v,m,w){var b=v.getActivePointersListByType(w.type),k,z;k=b.getById(w.id),k?(k.captured?(k.insideElement=!1,k.lastPos=k.currentPos,k.lastTime=k.currentTime,k.currentPos=w.currentPos,k.currentTime=w.currentTime):R(v,b,k),w=k):(w.captured=!1,w.insideElementPressed=!1),(v.leaveHandler||v.exitHandler)&&(z={eventSource:v,pointerType:w.type,position:w.currentPos&&C(w.currentPos,v.element),buttons:b.buttons,pointers:v.getActivePointerCount(),insideElementPressed:w.insideElementPressed,buttonDownAny:b.buttons!==0,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData},v.leaveHandler&&v.leaveHandler(z),v.exitHandler&&v.exitHandler(z))}function xe(v,m,w){var b,k;b=v.getActivePointersListByType(w.type),k=b.getById(w.id),k?w=k:(w.captured=!1,w.insideElementPressed=!1),v.overHandler&&v.overHandler({eventSource:v,pointerType:w.type,position:C(w.currentPos,v.element),buttons:b.buttons,pointers:v.getActivePointerCount(),insideElementPressed:w.insideElementPressed,buttonDownAny:b.buttons!==0,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData})}function ge(v,m,w){var b,k;b=v.getActivePointersListByType(w.type),k=b.getById(w.id),k?w=k:(w.captured=!1,w.insideElementPressed=!1),v.outHandler&&v.outHandler({eventSource:v,pointerType:w.type,position:w.currentPos&&C(w.currentPos,v.element),buttons:b.buttons,pointers:v.getActivePointerCount(),insideElementPressed:w.insideElementPressed,buttonDownAny:b.buttons!==0,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData})}function se(v,m,w,b){var k=n[v.hash],z=v.getActivePointersListByType(w.type),ee;if(typeof m.originalEvent.buttons<"u"?z.buttons=m.originalEvent.buttons:b===0?z.buttons|=1:b===1?z.buttons|=4:b===2?z.buttons|=2:b===3?z.buttons|=8:b===4?z.buttons|=16:b===5&&(z.buttons|=32),b!==0){m.shouldCapture=!1,m.shouldReleaseCapture=!1,v.nonPrimaryPressHandler&&!m.preventGesture&&!m.defaultPrevented&&(m.preventDefault=!0,v.nonPrimaryPressHandler({eventSource:v,pointerType:w.type,position:C(w.currentPos,v.element),button:b,buttons:z.buttons,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData}));return}if(ee=z.getById(w.id),ee)ee.insideElementPressed=!0,ee.insideElement=!0,ee.originalTarget=m.originalEvent.target,ee.contactPos=w.currentPos,ee.contactTime=w.currentTime,ee.lastPos=ee.currentPos,ee.lastTime=ee.currentTime,ee.currentPos=w.currentPos,ee.currentTime=w.currentTime,w=ee;else{e.console.warn("pointerdown event on untracked pointer"),w.captured=!1,w.insideElementPressed=!0,w.insideElement=!0,w.originalTarget=m.originalEvent.target,_(z,w);return}z.addContact(),!m.preventGesture&&!m.defaultPrevented?(m.shouldCapture=!0,m.shouldReleaseCapture=!1,m.preventDefault=!0,(v.dragHandler||v.dragEndHandler||v.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(v,w),z.contacts===1?v.pressHandler&&!m.preventGesture&&v.pressHandler({eventSource:v,pointerType:w.type,position:C(w.contactPos,v.element),buttons:z.buttons,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData}):z.contacts===2&&v.pinchHandler&&w.type==="touch"&&(k.pinchGPoints=z.asArray(),k.lastPinchDist=k.currentPinchDist=k.pinchGPoints[0].currentPos.distanceTo(k.pinchGPoints[1].currentPos),k.lastPinchCenter=k.currentPinchCenter=p(k.pinchGPoints[0].currentPos,k.pinchGPoints[1].currentPos))):(m.shouldCapture=!1,m.shouldReleaseCapture=!1)}function Te(v,m,w,b){var k=n[v.hash],z=v.getActivePointersListByType(w.type),ee,be,te,Qe=!1,Be;if(typeof m.originalEvent.buttons<"u"?z.buttons=m.originalEvent.buttons:b===0?z.buttons^=-2:b===1?z.buttons^=-5:b===2?z.buttons^=-3:b===3?z.buttons^=-9:b===4?z.buttons^=-17:b===5&&(z.buttons^=-33),m.shouldCapture=!1,b!==0){m.shouldReleaseCapture=!1,v.nonPrimaryReleaseHandler&&!m.preventGesture&&!m.defaultPrevented&&(m.preventDefault=!0,v.nonPrimaryReleaseHandler({eventSource:v,pointerType:w.type,position:C(w.currentPos,v.element),button:b,buttons:z.buttons,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData}));return}te=z.getById(w.id),te?(z.removeContact(),te.captured&&(Qe=!0),te.lastPos=te.currentPos,te.lastTime=te.currentTime,te.currentPos=w.currentPos,te.currentTime=w.currentTime,te.insideElement||R(v,z,te),ee=te.currentPos,be=te.currentTime):(e.console.warn("updatePointerUp(): pointerup on untracked gPoint"),w.captured=!1,w.insideElementPressed=!1,w.insideElement=!0,_(z,w),te=w),!m.preventGesture&&!m.defaultPrevented&&(Qe?(m.shouldReleaseCapture=!0,m.preventDefault=!0,(v.dragHandler||v.dragEndHandler||v.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(v,te),z.contacts===0?(v.releaseHandler&&v.releaseHandler({eventSource:v,pointerType:te.type,position:C(ee,v.element),buttons:z.buttons,insideElementPressed:te.insideElementPressed,insideElementReleased:te.insideElement,isTouchEvent:te.type==="touch",originalEvent:m.originalEvent,userData:v.userData}),v.dragEndHandler&&k.sentDragEvent&&v.dragEndHandler({eventSource:v,pointerType:te.type,position:C(te.currentPos,v.element),speed:te.speed,direction:te.direction,shift:m.originalEvent.shiftKey,isTouchEvent:te.type==="touch",originalEvent:m.originalEvent,userData:v.userData}),k.sentDragEvent=!1,(v.clickHandler||v.dblClickHandler)&&te.insideElement&&(Be=be-te.contactTime<=v.clickTimeThreshold&&te.contactPos.distanceTo(ee)<=v.clickDistThreshold,v.clickHandler&&v.clickHandler({eventSource:v,pointerType:te.type,position:C(te.currentPos,v.element),quick:Be,shift:m.originalEvent.shiftKey,isTouchEvent:te.type==="touch",originalEvent:m.originalEvent,originalTarget:te.originalTarget,userData:v.userData}),v.dblClickHandler&&Be&&(z.clicks++,z.clicks===1?(k.lastClickPos=ee,k.dblClickTimeOut=setTimeout(function(){z.clicks=0},v.dblClickTimeThreshold)):z.clicks===2&&(clearTimeout(k.dblClickTimeOut),z.clicks=0,k.lastClickPos.distanceTo(ee)<=v.dblClickDistThreshold&&v.dblClickHandler({eventSource:v,pointerType:te.type,position:C(te.currentPos,v.element),shift:m.originalEvent.shiftKey,isTouchEvent:te.type==="touch",originalEvent:m.originalEvent,userData:v.userData}),k.lastClickPos=null)))):z.contacts===2&&v.pinchHandler&&te.type==="touch"&&(k.pinchGPoints=z.asArray(),k.lastPinchDist=k.currentPinchDist=k.pinchGPoints[0].currentPos.distanceTo(k.pinchGPoints[1].currentPos),k.lastPinchCenter=k.currentPinchCenter=p(k.pinchGPoints[0].currentPos,k.pinchGPoints[1].currentPos))):(m.shouldReleaseCapture=!1,v.releaseHandler&&(v.releaseHandler({eventSource:v,pointerType:te.type,position:C(ee,v.element),buttons:z.buttons,insideElementPressed:te.insideElementPressed,insideElementReleased:te.insideElement,isTouchEvent:te.type==="touch",originalEvent:m.originalEvent,userData:v.userData}),m.preventDefault=!0)))}function he(v,m,w){var b=n[v.hash],k=v.getActivePointersListByType(w.type),z,ee,be;if(typeof m.originalEvent.buttons<"u"&&(k.buttons=m.originalEvent.buttons),z=k.getById(w.id),z)z.lastPos=z.currentPos,z.lastTime=z.currentTime,z.currentPos=w.currentPos,z.currentTime=w.currentTime;else return;m.shouldCapture=!1,m.shouldReleaseCapture=!1,v.stopHandler&&w.type==="mouse"&&(clearTimeout(v.stopTimeOut),v.stopTimeOut=setTimeout(function(){Rt(v,m.originalEvent,w.type)},v.stopDelay)),k.contacts===0?v.moveHandler&&v.moveHandler({eventSource:v,pointerType:w.type,position:C(w.currentPos,v.element),buttons:k.buttons,isTouchEvent:w.type==="touch",originalEvent:m.originalEvent,userData:v.userData}):k.contacts===1?(v.moveHandler&&(z=k.asArray()[0],v.moveHandler({eventSource:v,pointerType:z.type,position:C(z.currentPos,v.element),buttons:k.buttons,isTouchEvent:z.type==="touch",originalEvent:m.originalEvent,userData:v.userData})),v.dragHandler&&!m.preventGesture&&!m.defaultPrevented&&(z=k.asArray()[0],be=z.currentPos.minus(z.lastPos),v.dragHandler({eventSource:v,pointerType:z.type,position:C(z.currentPos,v.element),buttons:k.buttons,delta:be,speed:z.speed,direction:z.direction,shift:m.originalEvent.shiftKey,isTouchEvent:z.type==="touch",originalEvent:m.originalEvent,userData:v.userData}),m.preventDefault=!0,b.sentDragEvent=!0)):k.contacts===2&&(v.moveHandler&&(ee=k.asArray(),v.moveHandler({eventSource:v,pointerType:ee[0].type,position:C(p(ee[0].currentPos,ee[1].currentPos),v.element),buttons:k.buttons,isTouchEvent:ee[0].type==="touch",originalEvent:m.originalEvent,userData:v.userData})),v.pinchHandler&&w.type==="touch"&&!m.preventGesture&&!m.defaultPrevented&&(be=b.pinchGPoints[0].currentPos.distanceTo(b.pinchGPoints[1].currentPos),be!==b.currentPinchDist&&(b.lastPinchDist=b.currentPinchDist,b.currentPinchDist=be,b.lastPinchCenter=b.currentPinchCenter,b.currentPinchCenter=p(b.pinchGPoints[0].currentPos,b.pinchGPoints[1].currentPos),v.pinchHandler({eventSource:v,pointerType:"touch",gesturePoints:b.pinchGPoints,lastCenter:C(b.lastPinchCenter,v.element),center:C(b.currentPinchCenter,v.element),lastDistance:b.lastPinchDist,distance:b.currentPinchDist,shift:m.originalEvent.shiftKey,originalEvent:m.originalEvent,userData:v.userData}),m.preventDefault=!0)))}function ze(v,m,w){var b=v.getActivePointersListByType(w.type),k;k=b.getById(w.id),k&&R(v,b,k)}function Rt(v,m,w){v.stopHandler&&v.stopHandler({eventSource:v,pointerType:w,position:E(m,v.element),buttons:v.getActivePointersListByType(w).buttons,isTouchEvent:w==="touch",originalEvent:m,userData:v.userData})}}(i),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(n,r,o){var s=n.parentNode;typeof r=="number"&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),r={anchor:r}),r.attachToViewer=typeof r.attachToViewer>"u"?!0:r.attachToViewer,this.autoFade=typeof r.autoFade>"u"?!0:r.autoFade,this.element=n,this.anchor=r.anchor,this.container=o,this.anchor===e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof r.top=="number"?r.top+"px":r.top,this.wrapper.style.left=typeof r.left=="number"?r.left+"px":r.left,this.wrapper.style.height=typeof r.height=="number"?r.height+"px":r.height,this.wrapper.style.width=typeof r.width=="number"?r.width+"px":r.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),r.attachToViewer?this.anchor===e.ControlAnchor.TOP_RIGHT||this.anchor===e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):s.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==e.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(n){this.wrapper.style.display=n?this.anchor===e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(n){this.element[e.SIGNAL]&&e.Browser.vendor===e.BROWSERS.IE?e.setElementOpacity(this.element,n,!0):e.setElementOpacity(this.wrapper,n,!0)}}}(i),function(e){e.ControlDock=function(r){var o=["topleft","topright","bottomright","bottomleft"],s,a;for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(Math.random()*1e6),container:e.makeNeutralElement("div"),controls:[]},r),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),a=0;a<o.length;a++)s=o[a],this.controls[s]=e.makeNeutralElement("div"),this.controls[s].style.position="absolute",s.match("left")&&(this.controls[s].style.left="0px"),s.match("right")&&(this.controls[s].style.right="0px"),s.match("top")&&(this.controls[s].style.top="0px"),s.match("bottom")&&(this.controls[s].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(r,o){r=e.getElement(r);var s=null;if(!(n(this,r)>=0)){switch(o.anchor){case e.ControlAnchor.TOP_RIGHT:s=this.controls.topright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:s=this.controls.bottomright,r.style.position="relative",r.style.paddingRight="0px",r.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:s=this.controls.bottomleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:s=this.controls.topleft,r.style.position="relative",r.style.paddingLeft="0px",r.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:s=this.container,r.style.margin="0px",r.style.padding="0px";break;default:case e.ControlAnchor.NONE:s=this.container,r.style.margin="0px",r.style.padding="0px";break}this.controls.push(new e.Control(r,o,s)),r.style.display="inline-block"}},removeControl:function(r){r=e.getElement(r);var o=n(this,r);return o>=0&&(this.controls[o].destroy(),this.controls.splice(o,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var r;for(r=this.controls.length-1;r>=0;r--)if(this.controls[r].isVisible())return!0;return!1},setControlsEnabled:function(r){var o;for(o=this.controls.length-1;o>=0;o--)this.controls[o].setVisible(r);return this}};function n(r,o){var s=r.controls,a;for(a=s.length-1;a>=0;a--)if(s[a].element===o)return a;return-1}}(i),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(i),function(e){var n={},r=1;e.Viewer=function(f){var _=arguments,R=this,L;if(e.isPlainObject(f)||(f={id:_[0],xmlPath:_.length>1?_[1]:void 0,prefixUrl:_.length>2?_[2]:void 0,controls:_.length>3?_[3]:void 0,overlays:_.length>4?_[4]:void 0}),f.config&&(e.extend(!0,f,f.config),delete f.config),e.extend(!0,this,{id:f.id,hash:f.hash||r++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},e.DEFAULT_SETTINGS,f),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof n[this.hash]<"u"&&e.console.warn("Hash "+this.hash+" has already been used."),n[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(F){var Y=e.getString("Errors.OpenFailed",F.eventSource,F.message);R._showMessage(Y)}),e.ControlDock.call(this,f),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(F){F.width="100%",F.height="100%",F.overflow="hidden",F.position="absolute",F.top="0px",F.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),f.tabIndex!==""&&(this.canvas.tabIndex=f.tabIndex===void 0?0:f.tabIndex),this.container.className="openseadragon-container",function(F){F.width="100%",F.height="100%",F.position="relative",F.overflow="hidden",F.left="0px",F.top="0px",F.textAlign="left"}(this.container.style),e.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:e.delegate(this,E),keyDownHandler:e.delegate(this,C),keyHandler:e.delegate(this,p),clickHandler:e.delegate(this,x),dblClickHandler:e.delegate(this,A),dragHandler:e.delegate(this,P),dragEndHandler:e.delegate(this,D),enterHandler:e.delegate(this,O),leaveHandler:e.delegate(this,I),pressHandler:e.delegate(this,N),releaseHandler:e.delegate(this,W),nonPrimaryPressHandler:e.delegate(this,q),nonPrimaryReleaseHandler:e.delegate(this,G),scrollHandler:e.delegate(this,K),pinchHandler:e.delegate(this,J)}),this.outerTracker=new e.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,oe),leaveHandler:e.delegate(this,re)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),n[this.hash].prevContainerSize=o(this.container),this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(F){R.source=R.world.getItemAt(0).source,n[R.hash].forceRedraw=!0,R._updateRequestId||(R._updateRequestId=u(R,ae))}),this.world.addHandler("remove-item",function(F){R.world.getItemCount()?R.source=R.world.getItemAt(0).source:R.source=null,n[R.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(F){R.viewport&&R.viewport._setContentBounds(R.world.getHomeBounds(),R.world.getContentFactor())}),this.world.addHandler("item-index-change",function(F){R.source=R.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:n[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:f.timeout}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(L=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(L,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(L=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(L,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new e.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),L=0;L<this.customControls.length;L++)this.addControl(this.customControls[L].id,{anchor:this.customControls[L].anchor});e.requestAnimationFrame(function(){h(R)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),e._viewers.set(this.element,this)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(f){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(f)},openTileSource:function(f){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(f)},open:function(f,_){var R=this;if(this.close(),!f)return this;if(this.sequenceMode&&e.isArray(f))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof _<"u"&&!isNaN(_)&&(this.initialPage=_),this.tileSources=f,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(e.isArray(f)||(f=[f]),!f.length)return this;this._opening=!0;for(var L=f.length,F=0,Y=0,X,fe=function(){if(F+Y===L)if(F){(R._firstOpen||!R.preserveViewport)&&(R.viewport.goHome(!0),R.viewport.update()),R._firstOpen=!1;var se=f[0];if(se.tileSource&&(se=se.tileSource),R.overlays&&!R.preserveOverlays)for(var Te=0;Te<R.overlays.length;Te++)R.currentOverlays[Te]=a(R,R.overlays[Te]);R._drawOverlays(),R._opening=!1,R.raiseEvent("open",{source:se})}else R._opening=!1,R.raiseEvent("open-failed",X)},xe=function(se){(!e.isPlainObject(se)||!se.tileSource)&&(se={tileSource:se}),se.index!==void 0&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete se.index),se.collectionImmediately===void 0&&(se.collectionImmediately=!0);var Te=se.success;se.success=function(ze){if(F++,se.tileSource.overlays)for(var Rt=0;Rt<se.tileSource.overlays.length;Rt++)R.addOverlay(se.tileSource.overlays[Rt]);Te&&Te(ze),fe()};var he=se.error;se.error=function(ze){Y++,X||(X=ze),he&&he(ze),fe()},R.addTiledImage(se)},ge=0;ge<f.length;ge++)xe(f[ge]);return this},close:function(){return n[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),n[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(n[this.hash]){if(this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),n[this.navigator.hash]=null,delete n[this.navigator.hash],this.navigator=null),this.removeAllHandlers(),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),n[this.hash]=null,delete n[this.hash],this.canvas=null,this.container=null,e._viewers.delete(this.element),this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(f){return this.innerTracker.setTracking(f),this.outerTracker.setTracking(f),this.raiseEvent("mouse-enabled",{enabled:f}),this},areControlsEnabled:function(){var f=this.controls.length,_;for(_=0;_<this.controls.length;_++)f=f&&this.controls[_].isVisible();return f},setControlsEnabled:function(f){return f?g(this):h(this),this.raiseEvent("controls-enabled",{enabled:f}),this},setDebugMode:function(f){for(var _=0;_<this.world.getItemCount();_++)this.world.getItemAt(_).debugMode=f;this.debugMode=f,this.forceRedraw()},isFullPage:function(){return n[this.hash].fullPage},setFullPage:function(f){var _=document.body,R=_.style,L=document.documentElement.style,F=this,Y,X;if(f===this.isFullPage())return this;var fe={fullPage:f,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",fe),fe.preventDefaultAction)return this;if(f){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=R.margin,this.docMargin=L.margin,R.margin="0",L.margin="0",this.bodyPadding=R.padding,this.docPadding=L.padding,R.padding="0",L.padding="0",this.bodyWidth=R.width,this.docWidth=L.width,R.width="100%",L.width="100%",this.bodyHeight=R.height,this.docHeight=L.height,R.height="100%",L.height="100%",this.bodyDisplay=R.display,R.display="block",this.previousBody=[],n[this.hash].prevElementParent=this.element.parentNode,n[this.hash].prevNextSibling=this.element.nextSibling,n[this.hash].prevElementWidth=this.element.style.width,n[this.hash].prevElementHeight=this.element.style.height,Y=_.childNodes.length,X=0;X<Y;X++)this.previousBody.push(_.childNodes[0]),_.removeChild(_.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,_.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),_.appendChild(this.element),this.element.style.height=e.getWindowSize().y+"px",this.element.style.width=e.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),n[this.hash].fullPage=!0,e.delegate(this,oe)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,R.margin=this.bodyMargin,L.margin=this.docMargin,R.padding=this.bodyPadding,L.padding=this.docPadding,R.width=this.bodyWidth,L.width=this.docWidth,R.height=this.bodyHeight,L.height=this.docHeight,R.display=this.bodyDisplay,_.removeChild(this.element),Y=this.previousBody.length,X=0;X<Y;X++)_.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),n[this.hash].prevElementParent.insertBefore(this.element,n[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(_.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=n[this.hash].prevElementWidth,this.element.style.height=n[this.hash].prevElementHeight;var xe=0,ge=function(){e.setPageScroll(F.pageScroll);var se=e.getPageScroll();xe++,xe<10&&(se.x!==F.pageScroll.x||se.y!==F.pageScroll.y)&&e.requestAnimationFrame(ge)};e.requestAnimationFrame(ge),n[this.hash].fullPage=!1,e.delegate(this,re)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:f}),this},setFullScreen:function(f){var _=this;if(!e.supportsFullScreen)return this.setFullPage(f);if(e.isFullScreen()===f)return this;var R={fullScreen:f,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",R),R.preventDefaultAction)return this;if(f){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var L=function(){var F=e.isFullScreen();F||(e.removeEvent(document,e.fullScreenEventName,L),e.removeEvent(document,e.fullScreenErrorEventName,L),_.setFullPage(!1),_.isFullPage()&&(_.element.style.width=_.fullPageStyleWidth,_.element.style.height=_.fullPageStyleHeight)),_.navigator&&_.viewport&&setTimeout(function(){_.navigator.update(_.viewport)}),_.raiseEvent("full-screen",{fullScreen:F})};e.addEvent(document,e.fullScreenEventName,L),e.addEvent(document,e.fullScreenErrorEventName,L),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},setVisible:function(f){return this.container.style.visibility=f?"":"hidden",this.raiseEvent("visible",{visible:f}),this},addTiledImage:function(f){e.console.assert(f,"[Viewer.addTiledImage] options is required"),e.console.assert(f.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!f.replace||f.index>-1&&f.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var _=this;f.replace&&(f.replaceItem=_.world.getItemAt(f.index)),this._hideMessage(),f.placeholderFillStyle===void 0&&(f.placeholderFillStyle=this.placeholderFillStyle),f.opacity===void 0&&(f.opacity=this.opacity),f.preload===void 0&&(f.preload=this.preload),f.compositeOperation===void 0&&(f.compositeOperation=this.compositeOperation),f.crossOriginPolicy===void 0&&(f.crossOriginPolicy=f.tileSource.crossOriginPolicy!==void 0?f.tileSource.crossOriginPolicy:this.crossOriginPolicy),f.ajaxWithCredentials===void 0&&(f.ajaxWithCredentials=this.ajaxWithCredentials),f.loadTilesWithAjax===void 0&&(f.loadTilesWithAjax=this.loadTilesWithAjax),f.ajaxHeaders===void 0||f.ajaxHeaders===null?f.ajaxHeaders=this.ajaxHeaders:e.isPlainObject(f.ajaxHeaders)&&e.isPlainObject(this.ajaxHeaders)&&(f.ajaxHeaders=e.extend({},this.ajaxHeaders,f.ajaxHeaders));var R={options:f};function L(X){for(var fe=0;fe<_._loadQueue.length;fe++)if(_._loadQueue[fe]===R){_._loadQueue.splice(fe,1);break}_._loadQueue.length===0&&F(R),_.raiseEvent("add-item-failed",X),f.error&&f.error(X)}function F(X){_.collectionMode&&(_.world.arrange({immediately:X.options.collectionImmediately,rows:_.collectionRows,columns:_.collectionColumns,layout:_.collectionLayout,tileSize:_.collectionTileSize,tileMargin:_.collectionTileMargin}),_.world.setAutoRefigureSizes(!0))}if(e.isArray(f.tileSource)){setTimeout(function(){L({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:f.tileSource,options:f})});return}this._loadQueue.push(R);function Y(){for(var X,fe,xe;_._loadQueue.length&&(X=_._loadQueue[0],!!X.tileSource);){if(_._loadQueue.splice(0,1),X.options.replace){var ge=_.world.getIndexOfItem(X.options.replaceItem);ge!==-1&&(X.options.index=ge),_.world.removeItem(X.options.replaceItem)}fe=new e.TiledImage({viewer:_,source:X.tileSource,viewport:_.viewport,drawer:_.drawer,tileCache:_.tileCache,imageLoader:_.imageLoader,x:X.options.x,y:X.options.y,width:X.options.width,height:X.options.height,fitBounds:X.options.fitBounds,fitBoundsPlacement:X.options.fitBoundsPlacement,clip:X.options.clip,placeholderFillStyle:X.options.placeholderFillStyle,opacity:X.options.opacity,preload:X.options.preload,degrees:X.options.degrees,flipped:X.options.flipped,compositeOperation:X.options.compositeOperation,springStiffness:_.springStiffness,animationTime:_.animationTime,minZoomImageRatio:_.minZoomImageRatio,wrapHorizontal:_.wrapHorizontal,wrapVertical:_.wrapVertical,immediateRender:_.immediateRender,blendTime:_.blendTime,alwaysBlend:_.alwaysBlend,minPixelRatio:_.minPixelRatio,smoothTileEdgesMinZoom:_.smoothTileEdgesMinZoom,iOSDevice:_.iOSDevice,crossOriginPolicy:X.options.crossOriginPolicy,ajaxWithCredentials:X.options.ajaxWithCredentials,loadTilesWithAjax:X.options.loadTilesWithAjax,ajaxHeaders:X.options.ajaxHeaders,debugMode:_.debugMode}),_.collectionMode&&_.world.setAutoRefigureSizes(!1),_.navigator&&(xe=e.extend({},X.options,{replace:!1,originalTiledImage:fe,tileSource:X.tileSource}),_.navigator.addTiledImage(xe)),_.world.addItem(fe,{index:X.options.index}),_._loadQueue.length===0&&F(X),_.world.getItemCount()===1&&!_.preserveViewport&&_.viewport.goHome(!0),X.options.success&&X.options.success({item:fe})}}s(this,f.tileSource,f,function(X){R.tileSource=X,Y()},function(X){X.options=f,L(X),Y()})},addSimpleImage:function(f){e.console.assert(f,"[Viewer.addSimpleImage] options is required"),e.console.assert(f.url,"[Viewer.addSimpleImage] options.url is required");var _=e.extend({},f,{tileSource:{type:"image",url:f.url}});delete _.url,this.addTiledImage(_)},addLayer:function(f){var _=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var R=e.extend({},f,{success:function(L){_.raiseEvent("add-layer",{options:f,drawer:L.item})},error:function(L){_.raiseEvent("add-layer-failed",L)}});return this.addTiledImage(R),this},getLayerAtLevel:function(f){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(f)},getLevelOfLayer:function(f){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(f)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(f,_){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(f,_)},removeLayer:function(f){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(f)},forceRedraw:function(){return n[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var f=e.delegate(this,y),_=e.delegate(this,S),R=e.delegate(this,this.goToNextPage),L=e.delegate(this,this.goToPreviousPage),F=this.navImages,Y=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(Y=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:$(this.prefixUrl,F.previous.REST),srcGroup:$(this.prefixUrl,F.previous.GROUP),srcHover:$(this.prefixUrl,F.previous.HOVER),srcDown:$(this.prefixUrl,F.previous.DOWN),onRelease:L,onFocus:f,onBlur:_}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:$(this.prefixUrl,F.next.REST),srcGroup:$(this.prefixUrl,F.next.GROUP),srcHover:$(this.prefixUrl,F.next.HOVER),srcDown:$(this.prefixUrl,F.next.DOWN),onRelease:R,onFocus:f,onBlur:_}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),Y&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var f=e.delegate(this,le),_=e.delegate(this,H),R=e.delegate(this,U),L=e.delegate(this,M),F=e.delegate(this,Q),Y=e.delegate(this,Se),X=e.delegate(this,de),fe=e.delegate(this,nt),xe=e.delegate(this,Ge),ge=e.delegate(this,Je),se=e.delegate(this,y),Te=e.delegate(this,S),he=this.navImages,ze=[],Rt=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(Rt=!1),this.showZoomControl&&(ze.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:$(this.prefixUrl,he.zoomIn.REST),srcGroup:$(this.prefixUrl,he.zoomIn.GROUP),srcHover:$(this.prefixUrl,he.zoomIn.HOVER),srcDown:$(this.prefixUrl,he.zoomIn.DOWN),onPress:f,onRelease:_,onClick:R,onEnter:f,onExit:_,onFocus:se,onBlur:Te})),ze.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:$(this.prefixUrl,he.zoomOut.REST),srcGroup:$(this.prefixUrl,he.zoomOut.GROUP),srcHover:$(this.prefixUrl,he.zoomOut.HOVER),srcDown:$(this.prefixUrl,he.zoomOut.DOWN),onPress:L,onRelease:_,onClick:F,onEnter:L,onExit:_,onFocus:se,onBlur:Te}))),this.showHomeControl&&ze.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:$(this.prefixUrl,he.home.REST),srcGroup:$(this.prefixUrl,he.home.GROUP),srcHover:$(this.prefixUrl,he.home.HOVER),srcDown:$(this.prefixUrl,he.home.DOWN),onRelease:Y,onFocus:se,onBlur:Te})),this.showFullPageControl&&ze.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:$(this.prefixUrl,he.fullpage.REST),srcGroup:$(this.prefixUrl,he.fullpage.GROUP),srcHover:$(this.prefixUrl,he.fullpage.HOVER),srcDown:$(this.prefixUrl,he.fullpage.DOWN),onRelease:X,onFocus:se,onBlur:Te})),this.showRotationControl&&(ze.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:$(this.prefixUrl,he.rotateleft.REST),srcGroup:$(this.prefixUrl,he.rotateleft.GROUP),srcHover:$(this.prefixUrl,he.rotateleft.HOVER),srcDown:$(this.prefixUrl,he.rotateleft.DOWN),onRelease:fe,onFocus:se,onBlur:Te})),ze.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:$(this.prefixUrl,he.rotateright.REST),srcGroup:$(this.prefixUrl,he.rotateright.GROUP),srcHover:$(this.prefixUrl,he.rotateright.HOVER),srcDown:$(this.prefixUrl,he.rotateright.DOWN),onRelease:xe,onFocus:se,onBlur:Te}))),this.showFlipControl&&ze.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:$(this.prefixUrl,he.flip.REST),srcGroup:$(this.prefixUrl,he.flip.GROUP),srcHover:$(this.prefixUrl,he.flip.HOVER),srcDown:$(this.prefixUrl,he.flip.DOWN),onRelease:ge,onFocus:se,onBlur:Te})),Rt?(this.buttonGroup=new e.ButtonGroup({buttons:ze,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",e.delegate(this,ye)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT})):this.customButtons=ze),this},currentPage:function(){return this._sequenceIndex},goToPage:function(f){return this.tileSources&&f>=0&&f<this.tileSources.length&&(this._sequenceIndex=f,this._updateSequenceButtons(f),this.open(this.tileSources[f]),this.referenceStrip&&this.referenceStrip.setFocus(f),this.raiseEvent("page",{page:f})),this},addOverlay:function(f,_,R,L){var F;if(e.isPlainObject(f)?F=f:F={element:f,location:_,placement:R,onDraw:L},f=e.getElement(F.element),l(this.currentOverlays,f)>=0)return this;var Y=a(this,F);return this.currentOverlays.push(Y),Y.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:f,location:F.location,placement:F.placement}),this},updateOverlay:function(f,_,R){var L;return f=e.getElement(f),L=l(this.currentOverlays,f),L>=0&&(this.currentOverlays[L].update(_,R),n[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:f,location:_,placement:R})),this},removeOverlay:function(f){var _;return f=e.getElement(f),_=l(this.currentOverlays,f),_>=0&&(this.currentOverlays[_].destroy(),this.currentOverlays.splice(_,1),n[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:f})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return n[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(f){var _;return f=e.getElement(f),_=l(this.currentOverlays,f),_>=0?this.currentOverlays[_]:null},_updateSequenceButtons:function(f){this.nextButton&&(!this.tileSources||this.tileSources.length-1===f?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(f>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(f){this._hideMessage();var _=e.makeNeutralElement("div");_.appendChild(document.createTextNode(f)),this.messageDiv=e.makeCenteredNode(_),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var f=this.messageDiv;f&&(f.parentNode.removeChild(f),delete this.messageDiv)},gestureSettingsByDeviceType:function(f){switch(f){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var f,_=this.currentOverlays.length;for(f=0;f<_;f++)this.currentOverlays[f].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),e.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){e.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var f=e.pixelDensityRatio,_=e.getCurrentPixelDensityRatio();f!==_&&(e.pixelDensityRatio=_,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var f=this._sequenceIndex-1;this.navPrevNextWrap&&f<0&&(f+=this.tileSources.length),this.goToPage(f)},goToNextPage:function(){var f=this._sequenceIndex+1;this.navPrevNextWrap&&f>=this.tileSources.length&&(f=0),this.goToPage(f)}});function o(f){return f=e.getElement(f),new e.Point(f.clientWidth===0?1:f.clientWidth,f.clientHeight===0?1:f.clientHeight)}function s(f,_,R,L,F){var Y=f;if(e.type(_)==="string"){if(_.match(/^\s*<.*>\s*$/))_=e.parseXml(_);else if(_.match(/^\s*[{[].*[}\]]\s*$/))try{var X=e.parseJSON(_);_=X}catch{}}function fe(xe,ge){xe.ready?L(xe):(xe.addHandler("ready",function(){L(xe)}),xe.addHandler("open-failed",function(se){F({message:se.message,source:ge})}))}setTimeout(function(){if(e.type(_)==="string")_=new e.TileSource({url:_,crossOriginPolicy:R.crossOriginPolicy!==void 0?R.crossOriginPolicy:f.crossOriginPolicy,ajaxWithCredentials:f.ajaxWithCredentials,ajaxHeaders:R.ajaxHeaders?R.ajaxHeaders:f.ajaxHeaders,useCanvas:f.useCanvas,success:function(Te){L(Te.tileSource)}}),_.addHandler("open-failed",function(Te){F(Te)});else if(e.isPlainObject(_)||_.nodeType)if(_.crossOriginPolicy===void 0&&(R.crossOriginPolicy!==void 0||f.crossOriginPolicy!==void 0)&&(_.crossOriginPolicy=R.crossOriginPolicy!==void 0?R.crossOriginPolicy:f.crossOriginPolicy),_.ajaxWithCredentials===void 0&&(_.ajaxWithCredentials=f.ajaxWithCredentials),_.useCanvas===void 0&&(_.useCanvas=f.useCanvas),e.isFunction(_.getTileUrl)){var xe=new e.TileSource(_);xe.getTileUrl=_.getTileUrl,L(xe)}else{var ge=e.TileSource.determineType(Y,_);if(!ge){F({message:"Unable to load TileSource",source:_});return}var se=ge.prototype.configure.apply(Y,[_]);fe(new ge(se),_)}else fe(_,_)})}function a(f,_){if(_ instanceof e.Overlay)return _;var R=null;if(_.element)R=e.getElement(_.element);else{var L=_.id?_.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);R=e.getElement(_.id),R||(R=document.createElement("a"),R.href="#/overlay/"+L),R.id=L,e.addClass(R,_.className?_.className:"openseadragon-overlay")}var F=_.location,Y=_.width,X=_.height;if(!F){var fe=_.x,xe=_.y;if(_.px!==void 0){var ge=f.viewport.imageToViewportRectangle(new e.Rect(_.px,_.py,Y||0,X||0));fe=ge.x,xe=ge.y,Y=Y!==void 0?ge.width:void 0,X=X!==void 0?ge.height:void 0}F=new e.Point(fe,xe)}var se=_.placement;return se&&e.type(se)==="string"&&(se=e.Placement[_.placement.toUpperCase()]),new e.Overlay({element:R,location:F,placement:se,onDraw:_.onDraw,checkResize:_.checkResize,width:Y,height:X,rotationMode:_.rotationMode})}function l(f,_){var R;for(R=f.length-1;R>=0;R--)if(f[R].element===_)return R;return-1}function u(f,_){return e.requestAnimationFrame(function(){_(f)})}function c(f){e.requestAnimationFrame(function(){d(f)})}function h(f){!f.autoHideControls||(f.controlsShouldFade=!0,f.controlsFadeBeginTime=e.now()+f.controlsFadeDelay,window.setTimeout(function(){c(f)},f.controlsFadeDelay))}function d(f){var _,R,L,F;if(f.controlsShouldFade){for(_=e.now(),R=_-f.controlsFadeBeginTime,L=1-R/f.controlsFadeLength,L=Math.min(1,L),L=Math.max(0,L),F=f.controls.length-1;F>=0;F--)f.controls[F].autoFade&&f.controls[F].setOpacity(L);L>0&&c(f)}}function g(f){var _;for(f.controlsShouldFade=!1,_=f.controls.length-1;_>=0;_--)f.controls[_].setOpacity(1)}function y(){g(this)}function S(){h(this)}function E(f){var _={tracker:f.eventSource,position:f.position,originalEvent:f.originalEvent,preventDefault:f.preventDefault};this.raiseEvent("canvas-contextmenu",_),f.preventDefault=_.preventDefault}function C(f){var _={originalEvent:f.originalEvent,preventDefaultAction:!1,preventVerticalPan:f.preventVerticalPan,preventHorizontalPan:f.preventHorizontalPan};if(this.raiseEvent("canvas-key",_),!_.preventDefaultAction&&!f.ctrl&&!f.alt&&!f.meta)switch(f.keyCode){case 38:_.preventVerticalPan||(f.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 40:_.preventVerticalPan||(f.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 37:_.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 39:_.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;default:f.preventDefault=!1;break}else f.preventDefault=!1}function p(f){var _={originalEvent:f.originalEvent,preventDefaultAction:!1,preventVerticalPan:f.preventVerticalPan,preventHorizontalPan:f.preventHorizontalPan};if(this.raiseEvent("canvas-key",_),!_.preventDefaultAction&&!f.ctrl&&!f.alt&&!f.meta)switch(f.keyCode){case 43:case 61:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 45:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 119:case 87:_.preventVerticalPan||(f.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 115:case 83:_.preventVerticalPan||(f.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 97:_.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 100:_.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),f.preventDefault=!0;break;case 114:this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 82:this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),f.preventDefault=!0;break;case 102:this.viewport.toggleFlip(),f.preventDefault=!0;break;case 106:this.goToPreviousPage();break;case 107:this.goToNextPage();break;default:f.preventDefault=!1;break}else f.preventDefault=!1}function x(f){var _,R=document.activeElement===this.canvas;R||this.canvas.focus(),this.viewport.flipped&&(f.position.x=this.viewport.getContainerSize().x-f.position.x);var L={tracker:f.eventSource,position:f.position,quick:f.quick,shift:f.shift,originalEvent:f.originalEvent,originalTarget:f.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",L),!L.preventDefaultAction&&this.viewport&&f.quick&&(_=this.gestureSettingsByDeviceType(f.pointerType),_.clickToZoom&&(this.viewport.zoomBy(f.shift?1/this.zoomPerClick:this.zoomPerClick,_.zoomToRefPoint?this.viewport.pointFromPixel(f.position,!0):null),this.viewport.applyConstraints()))}function A(f){var _,R={tracker:f.eventSource,position:f.position,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",R),!R.preventDefaultAction&&this.viewport&&(_=this.gestureSettingsByDeviceType(f.pointerType),_.dblClickToZoom&&(this.viewport.zoomBy(f.shift?1/this.zoomPerClick:this.zoomPerClick,_.zoomToRefPoint?this.viewport.pointFromPixel(f.position,!0):null),this.viewport.applyConstraints()))}function P(f){var _,R={tracker:f.eventSource,pointerType:f.pointerType,position:f.position,delta:f.delta,speed:f.speed,direction:f.direction,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",R),_=this.gestureSettingsByDeviceType(f.pointerType),_.dragToPan&&!R.preventDefaultAction&&this.viewport){if(this.panHorizontal||(f.delta.x=0),this.panVertical||(f.delta.y=0),this.viewport.flipped&&(f.delta.x=-f.delta.x),this.constrainDuringPan){var L=this.viewport.deltaPointsFromPixels(f.delta.negate());this.viewport.centerSpringX.target.value+=L.x,this.viewport.centerSpringY.target.value+=L.y;var F=this.viewport.getBounds(),Y=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=L.x,this.viewport.centerSpringY.target.value-=L.y,F.x!==Y.x&&(f.delta.x=0),F.y!==Y.y&&(f.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(f.delta.negate()),_.flickEnabled&&!this.constrainDuringPan)}}function D(f){var _={tracker:f.eventSource,pointerType:f.pointerType,position:f.position,speed:f.speed,direction:f.direction,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",_),!_.preventDefaultAction&&this.viewport){var R=this.gestureSettingsByDeviceType(f.pointerType);if(R.flickEnabled&&f.speed>=R.flickMinSpeed){var L=0;this.panHorizontal&&(L=R.flickMomentum*f.speed*Math.cos(f.direction));var F=0;this.panVertical&&(F=R.flickMomentum*f.speed*Math.sin(f.direction));var Y=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),X=this.viewport.pointFromPixel(new e.Point(Y.x-L,Y.y-F));this.viewport.panTo(X,!1)}this.viewport.applyConstraints()}}function O(f){this.raiseEvent("canvas-enter",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function I(f){this.raiseEvent("canvas-exit",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function N(f){this.raiseEvent("canvas-press",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,insideElementPressed:f.insideElementPressed,insideElementReleased:f.insideElementReleased,originalEvent:f.originalEvent})}function W(f){this.raiseEvent("canvas-release",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,insideElementPressed:f.insideElementPressed,insideElementReleased:f.insideElementReleased,originalEvent:f.originalEvent})}function q(f){this.raiseEvent("canvas-nonprimary-press",{tracker:f.eventSource,position:f.position,pointerType:f.pointerType,button:f.button,buttons:f.buttons,originalEvent:f.originalEvent})}function G(f){this.raiseEvent("canvas-nonprimary-release",{tracker:f.eventSource,position:f.position,pointerType:f.pointerType,button:f.button,buttons:f.buttons,originalEvent:f.originalEvent})}function J(f){var _,R,L,F,Y={tracker:f.eventSource,pointerType:f.pointerType,gesturePoints:f.gesturePoints,lastCenter:f.lastCenter,center:f.center,lastDistance:f.lastDistance,distance:f.distance,shift:f.shift,originalEvent:f.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",Y),this.viewport&&(_=this.gestureSettingsByDeviceType(f.pointerType),_.pinchToZoom&&(!Y.preventDefaultPanAction||!Y.preventDefaultZoomAction)&&(R=this.viewport.pointFromPixel(f.center,!0),Y.preventDefaultZoomAction||this.viewport.zoomBy(f.distance/f.lastDistance,R,!0),_.zoomToRefPoint&&!Y.preventDefaultPanAction&&(L=this.viewport.pointFromPixel(f.lastCenter,!0),F=L.minus(R),this.panHorizontal||(F.x=0),this.panVertical||(F.y=0),this.viewport.panBy(F,!0)),this.viewport.applyConstraints()),_.pinchRotate&&!Y.preventDefaultRotateAction)){var X=Math.atan2(f.gesturePoints[0].currentPos.y-f.gesturePoints[1].currentPos.y,f.gesturePoints[0].currentPos.x-f.gesturePoints[1].currentPos.x),fe=Math.atan2(f.gesturePoints[0].lastPos.y-f.gesturePoints[1].lastPos.y,f.gesturePoints[0].lastPos.x-f.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(X-fe)*(180/Math.PI))}}function K(f){var _,R,L,F,Y;F=e.now(),Y=F-this._lastScrollTime,Y>this.minScrollDeltaTime?(this._lastScrollTime=F,_={tracker:f.eventSource,position:f.position,scroll:f.scroll,shift:f.shift,originalEvent:f.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",_),!_.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(f.position.x=this.viewport.getContainerSize().x-f.position.x),R=this.gestureSettingsByDeviceType(f.pointerType),R.scrollToZoom&&(L=Math.pow(this.zoomPerScroll,f.scroll),this.viewport.zoomBy(L,R.zoomToRefPoint?this.viewport.pointFromPixel(f.position,!0):null),this.viewport.applyConstraints())),f.preventDefault=_.preventDefault):f.preventDefault=!0}function oe(f){n[this.hash].mouseInside=!0,g(this),this.raiseEvent("container-enter",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function re(f){f.pointers<1&&(n[this.hash].mouseInside=!1,n[this.hash].animating||h(this)),this.raiseEvent("container-exit",{tracker:f.eventSource,pointerType:f.pointerType,position:f.position,buttons:f.buttons,pointers:f.pointers,insideElementPressed:f.insideElementPressed,buttonDownAny:f.buttonDownAny,originalEvent:f.originalEvent})}function ae(f){pe(f),f.isOpen()?f._updateRequestId=u(f,ae):f._updateRequestId=!1}function pe(f){if(!(f._opening||!n[f.hash])){if(f.autoResize){var _=o(f.container),R=n[f.hash].prevContainerSize;if(!_.equals(R)){var L=f.viewport;if(f.preserveImageSizeOnResize){var F=R.x/_.x,Y=L.getZoom()*F,X=L.getCenter();L.resize(_,!1),L.zoomTo(Y,null,!0),L.panTo(X,!0)}else{var fe=L.getBounds();L.resize(_,!0),L.fitBoundsWithConstraints(fe,!0)}n[f.hash].prevContainerSize=_,n[f.hash].forceRedraw=!0}}var xe=f.viewport.update(),ge=f.world.update()||xe;xe&&f.raiseEvent("viewport-change"),f.referenceStrip&&(ge=f.referenceStrip.update(f.viewport)||ge),!n[f.hash].animating&&ge&&(f.raiseEvent("animation-start"),g(f)),(ge||n[f.hash].forceRedraw||f.world.needsDraw())&&(Ee(f),f._drawOverlays(),f.navigator&&f.navigator.update(f.viewport),n[f.hash].forceRedraw=!1,ge&&f.raiseEvent("animation")),n[f.hash].animating&&!ge&&(f.raiseEvent("animation-finish"),n[f.hash].mouseInside||h(f)),n[f.hash].animating=ge}}function Ee(f){f.imageLoader.clear(),f.drawer.clear(),f.world.draw(),f.raiseEvent("update-viewport",{})}function $(f,_){return f?f+_:_}function le(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=this.zoomPerSecond,n[this.hash].zooming=!0,V(this)}function M(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=1/this.zoomPerSecond,n[this.hash].zooming=!0,V(this)}function H(){n[this.hash].zooming=!1}function V(f){e.requestAnimationFrame(e.delegate(f,j))}function j(){var f,_,R;n[this.hash].zooming&&this.viewport&&(f=e.now(),_=f-n[this.hash].lastZoomTime,R=Math.pow(n[this.hash].zoomFactor,_/1e3),this.viewport.zoomBy(R),this.viewport.applyConstraints(),n[this.hash].lastZoomTime=f,V(this))}function U(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Q(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function ye(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function Se(){this.viewport&&this.viewport.goHome()}function de(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function nt(){if(this.viewport){var f=this.viewport.getRotation();this.viewport.flipped?f=e.positiveModulo(f+this.rotationIncrement,360):f=e.positiveModulo(f-this.rotationIncrement,360),this.viewport.setRotation(f)}}function Ge(){if(this.viewport){var f=this.viewport.getRotation();this.viewport.flipped?f=e.positiveModulo(f-this.rotationIncrement,360):f=e.positiveModulo(f+this.rotationIncrement,360),this.viewport.setRotation(f)}}function Je(){this.viewport.toggleFlip()}}(i),function(e){e.Navigator=function(u){var c=u.viewer,h=this,d,g;u.id?(this.element=document.getElementById(u.id),u.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(u.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),u.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:u.autoFade},u.position&&(u.position==="BOTTOM_RIGHT"?u.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:u.position==="BOTTOM_LEFT"?u.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:u.position==="TOP_RIGHT"?u.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:u.position==="TOP_LEFT"?u.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:u.position==="ABSOLUTE"&&(u.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,u.controlOptions.top=u.top,u.controlOptions.left=u.left,u.controlOptions.height=u.height,u.controlOptions.width=u.width))),this.element.id=u.id,this.element.className+=" navigator",u=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},u,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:u.autoResize,minZoomImageRatio:1,background:u.background,opacity:u.opacity,borderColor:u.borderColor,displayRegionColor:u.displayRegionColor}),u.minPixelRatio=this.minPixelRatio=c.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),u.controlOptions.anchor!==e.ControlAnchor.NONE&&function(E,C){E.margin="0px",E.border=C+"px solid "+u.borderColor,E.padding="0px",E.background=u.background,E.opacity=u.opacity,E.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(E,C){E.position="relative",E.top="0px",E.left="0px",E.fontSize="0px",E.overflow="hidden",E.border=C+"px solid "+u.displayRegionColor,E.margin="0px",E.padding="0px",E.background="transparent",E.float="left",E.cssFloat="left",E.styleFloat="left",E.zIndex=999999999,E.cursor="default"}(this.displayRegion.style,this.borderWidth),e.setElementPointerEventsNone(this.displayRegion),e.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",e.setElementPointerEventsNone(this.displayRegionContainer),e.setElementTouchActionNone(this.displayRegionContainer),c.addControl(this.element,u.controlOptions),this._resizeWithViewer=u.controlOptions.anchor!==e.ControlAnchor.ABSOLUTE&&u.controlOptions.anchor!==e.ControlAnchor.NONE,u.width&&u.height?(this.setWidth(u.width),this.setHeight(u.height)):this._resizeWithViewer&&(d=e.getElementSize(c.element),this.element.style.height=Math.round(d.y*u.sizeRatio)+"px",this.element.style.width=Math.round(d.x*u.sizeRatio)+"px",this.oldViewerSize=d,g=e.getElementSize(this.element),this.elementArea=g.x*g.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[u]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function y(E){a(h.displayRegionContainer,E),a(h.displayRegion,-E),h.viewport.setRotation(E)}if(u.navigatorRotate){var S=u.viewer.viewport?u.viewer.viewport.getRotation():u.viewer.degrees||0;y(S),u.viewer.addHandler("rotate",function(E){y(E.degrees)})}this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:e.delegate(this,r),clickHandler:e.delegate(this,n),releaseHandler:e.delegate(this,o),scrollHandler:e.delegate(this,s),preProcessEventHandler:function(E){E.eventType==="wheel"&&(E.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",e.setElementPointerEventsNone(this.canvas),e.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){h.viewport&&h.viewport.goHome(!0)}),c.world.addHandler("item-index-change",function(E){window.setTimeout(function(){var C=h.world.getItemAt(E.previousIndex);h.world.setItemIndex(C,E.newIndex)},1)}),c.world.addHandler("remove-item",function(E){var C=E.item,p=h._getMatchingItem(C);p&&h.world.removeItem(p)}),this.update(c.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var u=new e.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);u.equals(this.oldContainerSize)||(this.viewport.resize(u,!0),this.viewport.goHome(!0),this.oldContainerSize=u,this.drawer.clear(),this.world.draw())}},setWidth:function(u){this.width=u,this.element.style.width=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1},setHeight:function(u){this.height=u,this.element.style.height=typeof u=="number"?u+"px":u,this._resizeWithViewer=!1},setFlip:function(u){return this.viewport.setFlip(u),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(u){l(this.displayRegion,u),l(this.canvas,u),l(this.element,u)},update:function(u){var c,h,d,g,y,S;if(c=e.getElementSize(this.viewer.element),this._resizeWithViewer&&c.x&&c.y&&!c.equals(this.oldViewerSize)&&(this.oldViewerSize=c,this.maintainSizeRatio||!this.elementArea?(h=c.x*this.sizeRatio,d=c.y*this.sizeRatio):(h=Math.sqrt(this.elementArea*(c.x/c.y)),d=this.elementArea/h),this.element.style.width=Math.round(h)+"px",this.element.style.height=Math.round(d)+"px",this.elementArea||(this.elementArea=h*d),this.updateSize()),u&&this.viewport){g=u.getBoundsNoRotate(!0),y=this.viewport.pixelFromPointNoRotate(g.getTopLeft(),!1),S=this.viewport.pixelFromPointNoRotate(g.getBottomRight(),!1).minus(this.totalBorderWidths);var E=this.displayRegion.style;E.display=this.world.getItemCount()?"block":"none",E.top=Math.round(y.y)+"px",E.left=Math.round(y.x)+"px";var C=Math.abs(y.x-S.x),p=Math.abs(y.y-S.y);E.width=Math.round(Math.max(C,0))+"px",E.height=Math.round(Math.max(p,0))+"px"}},addTiledImage:function(u){var c=this,h=u.originalTiledImage;delete u.original;var d=e.extend({},u,{success:function(g){var y=g.item;y._originalForNavigator=h,c._matchBounds(y,h,!0),c._matchOpacity(y,h),c._matchCompositeOperation(y,h);function S(){c._matchBounds(y,h)}function E(){c._matchOpacity(y,h)}function C(){c._matchCompositeOperation(y,h)}h.addHandler("bounds-change",S),h.addHandler("clip-change",S),h.addHandler("opacity-change",E),h.addHandler("composite-operation-change",C)}});return e.Viewer.prototype.addTiledImage.apply(this,[d])},destroy:function(){return e.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(u){for(var c=this.world.getItemCount(),h,d=0;d<c;d++)if(h=this.world.getItemAt(d),h._originalForNavigator===u)return h;return null},_matchBounds:function(u,c,h){var d=c.getBoundsNoRotate();u.setPosition(d.getTopLeft(),h),u.setWidth(d.width,h),u.setRotation(c.getRotation(),h),u.setClip(c.getClip()),u.setFlip(c.getFlip())},_matchOpacity:function(u,c){u.setOpacity(c.opacity)},_matchCompositeOperation:function(u,c){u.setCompositeOperation(c.compositeOperation)}});function n(u){var c={tracker:u.eventSource,position:u.position,quick:u.quick,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",c),!c.preventDefaultAction&&u.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(u.position.x=this.viewport.getContainerSize().x-u.position.x);var h=this.viewport.pointFromPixel(u.position);this.panVertical?this.panHorizontal||(h.x=this.viewer.viewport.getCenter(!0).x):h.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(h),this.viewer.viewport.applyConstraints()}}function r(u){var c={tracker:u.eventSource,position:u.position,delta:u.delta,speed:u.speed,direction:u.direction,shift:u.shift,originalEvent:u.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",c),!c.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(u.delta.x=0),this.panVertical||(u.delta.y=0),this.viewer.viewport.flipped&&(u.delta.x=-u.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(u.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function o(u){u.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function s(u){var c={tracker:u.eventSource,position:u.position,scroll:u.scroll,shift:u.shift,originalEvent:u.originalEvent,preventDefault:u.preventDefault};this.viewer.raiseEvent("navigator-scroll",c),u.preventDefault=c.preventDefault}function a(u,c){l(u,"rotate("+c+"deg)")}function l(u,c){u.style.webkitTransform=c,u.style.mozTransform=c,u.style.msTransform=c,u.style.oTransform=c,u.style.transform=c}}(i),function(e){var n={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(r){var o=r.split("."),s=null,a=arguments,l=n,u;for(u=0;u<o.length-1;u++)l=l[o[u]]||{};return s=l[o[u]],typeof s!="string"&&(e.console.log("Untranslated source string:",r),s=""),s.replace(/\{\d+\}/g,function(c){var h=parseInt(c.match(/\d+/),10)+1;return h<a.length?a[h]:""})},setString:function(r,o){var s=r.split("."),a=n,l;for(l=0;l<s.length-1;l++)a[s[l]]||(a[s[l]]={}),a=a[s[l]];a[s[l]]=o}})}(i),function(e){e.Point=function(n,r){this.x=typeof n=="number"?n:0,this.y=typeof r=="number"?r:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(n){return new e.Point(this.x+n.x,this.y+n.y)},minus:function(n){return new e.Point(this.x-n.x,this.y-n.y)},times:function(n){return new e.Point(this.x*n,this.y*n)},divide:function(n){return new e.Point(this.x/n,this.y/n)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(n){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))},squaredDistanceTo:function(n){return Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2)},apply:function(n){return new e.Point(n(this.x),n(this.y))},equals:function(n){return n instanceof e.Point&&this.x===n.x&&this.y===n.y},rotate:function(n,r){r=r||new e.Point(0,0);var o,s;if(n%90===0){var a=e.positiveModulo(n,360);switch(a){case 0:o=1,s=0;break;case 90:o=0,s=1;break;case 180:o=-1,s=0;break;case 270:o=0,s=-1;break}}else{var l=n*Math.PI/180;o=Math.cos(l),s=Math.sin(l)}var u=o*(this.x-r.x)-s*(this.y-r.y)+r.x,c=s*(this.x-r.x)+o*(this.y-r.y)+r.y;return new e.Point(u,c)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(i),function(e){e.TileSource=function(r,o,s,a,l,u){var c=this,h=arguments,d,g;if(e.isPlainObject(r)?d=r:d={width:h[0],height:h[1],tileSize:h[2],tileOverlap:h[3],minLevel:h[4],maxLevel:h[5]},e.EventSource.call(this),e.extend(!0,this,d),!this.success){for(g=0;g<arguments.length;g++)if(e.isFunction(arguments[g])){this.success=arguments[g];break}}this.success&&this.addHandler("ready",function(y){c.success(y)}),e.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=d.width&&d.height?d.width/d.height:1,this.dimensions=new e.Point(d.width,d.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=d.tileOverlap?d.tileOverlap:0,this.minLevel=d.minLevel?d.minLevel:0,this.maxLevel=d.maxLevel!==void 0&&d.maxLevel!==null?d.maxLevel:d.width&&d.height?Math.ceil(Math.log(Math.max(d.width,d.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(r){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(r){return this._tileWidth?this._tileWidth:this.getTileSize(r)},getTileHeight:function(r){return this._tileHeight?this._tileHeight:this.getTileSize(r)},setMaxLevel:function(r){this.maxLevel=r,this._memoizeLevelScale()},getLevelScale:function(r){return this._memoizeLevelScale(),this.getLevelScale(r)},_memoizeLevelScale:function(){var r={},o;for(o=0;o<=this.maxLevel;o++)r[o]=1/Math.pow(2,this.maxLevel-o);this.getLevelScale=function(s){return r[s]}},getNumTiles:function(r){var o=this.getLevelScale(r),s=Math.ceil(o*this.dimensions.x/this.getTileWidth(r)),a=Math.ceil(o*this.dimensions.y/this.getTileHeight(r));return new e.Point(s,a)},getPixelRatio:function(r){var o=this.dimensions.times(this.getLevelScale(r)),s=1/o.x*e.pixelDensityRatio,a=1/o.y*e.pixelDensityRatio;return new e.Point(s,a)},getClosestLevel:function(){var r,o;for(r=this.minLevel+1;r<=this.maxLevel&&(o=this.getNumTiles(r),!(o.x>1||o.y>1));r++);return r-1},getTileAtPoint:function(r,o){var s=o.x>=0&&o.x<=1&&o.y>=0&&o.y<=1/this.aspectRatio;e.console.assert(s,"[TileSource.getTileAtPoint] must be called with a valid point.");var a=this.dimensions.x*this.getLevelScale(r),l=o.x*a,u=o.y*a,c=Math.floor(l/this.getTileWidth(r)),h=Math.floor(u/this.getTileHeight(r));o.x>=1&&(c=this.getNumTiles(r).x-1);var d=1e-15;return o.y>=1/this.aspectRatio-d&&(h=this.getNumTiles(r).y-1),new e.Point(c,h)},getTileBounds:function(r,o,s,a){var l=this.dimensions.times(this.getLevelScale(r)),u=this.getTileWidth(r),c=this.getTileHeight(r),h=o===0?0:u*o-this.tileOverlap,d=s===0?0:c*s-this.tileOverlap,g=u+(o===0?1:2)*this.tileOverlap,y=c+(s===0?1:2)*this.tileOverlap,S=1/l.x;return g=Math.min(g,l.x-h),y=Math.min(y,l.y-d),a?new e.Rect(0,0,g,y):new e.Rect(h*S,d*S,g*S,y*S)},getImageInfo:function(r){var o=this,s,a,l,u,c,h,d;r&&(c=r.split("/"),h=c[c.length-1],d=h.lastIndexOf("."),d>-1&&(c[c.length-1]=h.slice(0,d))),a=function(g){typeof g=="string"&&(g=e.parseXml(g));var y=e.TileSource.determineType(o,g,r);if(!y){o.raiseEvent("open-failed",{message:"Unable to load TileSource",source:r});return}u=y.prototype.configure.apply(o,[g,r]),u.ajaxWithCredentials===void 0&&(u.ajaxWithCredentials=o.ajaxWithCredentials),l=new y(u),o.ready=!0,o.raiseEvent("ready",{tileSource:l})},r.match(/\.js$/)?(s=r.split("/").pop().replace(".js",""),e.jsonp({url:r,async:!1,callbackName:s,callback:a})):e.makeAjaxRequest({url:r,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(g){var y=n(g);a(y)},error:function(g,y){var S;try{S="HTTP "+g.status+" attempting to load TileSource"}catch{var E;typeof y>"u"||!y.toString?E="Unknown error":E=y.toString(),S=E+" attempting to load TileSource"}o.raiseEvent("open-failed",{message:S,source:r})}})},supports:function(r,o){return!1},configure:function(r,o){throw new Error("Method not implemented.")},getTileUrl:function(r,o,s){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(r,o,s){return{}},tileExists:function(r,o,s){var a=this.getNumTiles(r);return r>=this.minLevel&&r<=this.maxLevel&&o>=0&&s>=0&&o<a.x&&s<a.y}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype);function n(r){var o=r.responseText,s=r.status,a,l;if(r){if(r.status!==200&&r.status!==0)throw s=r.status,a=s===404?"Not Found":r.statusText,new Error(e.getString("Errors.Status",s,a))}else throw new Error(e.getString("Errors.Security"));if(o.match(/\s*<.*/))try{l=r.responseXML&&r.responseXML.documentElement?r.responseXML:e.parseXml(o)}catch{l=r.responseText}else if(o.match(/\s*[{[].*/))try{l=e.parseJSON(o)}catch{l=o}else l=o;return l}e.TileSource.determineType=function(r,o,s){var a;for(a in i)if(a.match(/.+TileSource$/)&&e.isFunction(i[a])&&e.isFunction(i[a].prototype.supports)&&i[a].prototype.supports.call(r,o,s))return i[a];return e.console.error("No TileSource was able to open %s %s",s,o),null}}(i),function(e){e.DziTileSource=function(o,s,a,l,u,c,h,d,g){var y,S,E,C;if(e.isPlainObject(o)?C=o:C={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=C.tilesUrl,this.fileFormat=C.fileFormat,this.displayRects=C.displayRects,this.displayRects)for(y=this.displayRects.length-1;y>=0;y--)for(S=this.displayRects[y],E=S.minLevel;E<=S.maxLevel;E++)this._levelRects[E]||(this._levelRects[E]=[]),this._levelRects[E].push(S);e.TileSource.apply(this,[C])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(o,s){var a;return o.Image?a=o.Image.xmlns:o.documentElement&&(o.documentElement.localName==="Image"||o.documentElement.tagName==="Image")&&(a=o.documentElement.namespaceURI),a=(a||"").toLowerCase(),a.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||a.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(o,s){var a;return e.isPlainObject(o)?a=r(this,o):a=n(this,o),s&&!a.tilesUrl&&(a.tilesUrl=s.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),s.search(/\.(dzi|xml|js)\?/)!==-1?a.queryParams=s.match(/\?.*/):a.queryParams=""),a},getTileUrl:function(o,s,a){return[this.tilesUrl,o,"/",s,"_",a,".",this.fileFormat,this.queryParams].join("")},tileExists:function(o,s,a){var l=this._levelRects[o],u,c,h,d,g,y,S;if(this.minLevel&&o<this.minLevel||this.maxLevel&&o>this.maxLevel)return!1;if(!l||!l.length)return!0;for(S=l.length-1;S>=0;S--)if(u=l[S],!(o<u.minLevel||o>u.maxLevel)&&(c=this.getLevelScale(o),h=u.x*c,d=u.y*c,g=h+u.width*c,y=d+u.height*c,h=Math.floor(h/this._tileWidth),d=Math.floor(d/this._tileWidth),g=Math.ceil(g/this._tileWidth),y=Math.ceil(y/this._tileWidth),h<=s&&s<g&&d<=a&&a<y))return!0;return!1}});function n(o,s){if(!s||!s.documentElement)throw new Error(e.getString("Errors.Xml"));var a=s.documentElement,l=a.localName||a.tagName,u=s.documentElement.namespaceURI,c=null,h=[],d,g,y,S,E;if(l==="Image")try{if(S=a.getElementsByTagName("Size")[0],S===void 0&&(S=a.getElementsByTagNameNS(u,"Size")[0]),c={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:a.getAttribute("Url"),Format:a.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(a.getAttribute("Overlap"),10),TileSize:parseInt(a.getAttribute("TileSize"),10),Size:{Height:parseInt(S.getAttribute("Height"),10),Width:parseInt(S.getAttribute("Width"),10)}}},!e.imageFormatSupported(c.Image.Format))throw new Error(e.getString("Errors.ImageFormat",c.Image.Format.toUpperCase()));for(d=a.getElementsByTagName("DisplayRect"),d===void 0&&(d=a.getElementsByTagNameNS(u,"DisplayRect")[0]),E=0;E<d.length;E++)g=d[E],y=g.getElementsByTagName("Rect")[0],y===void 0&&(y=g.getElementsByTagNameNS(u,"Rect")[0]),h.push({Rect:{X:parseInt(y.getAttribute("X"),10),Y:parseInt(y.getAttribute("Y"),10),Width:parseInt(y.getAttribute("Width"),10),Height:parseInt(y.getAttribute("Height"),10),MinLevel:parseInt(g.getAttribute("MinLevel"),10),MaxLevel:parseInt(g.getAttribute("MaxLevel"),10)}});return h.length&&(c.Image.DisplayRect=h),r(o,c)}catch(x){throw x instanceof Error?x:new Error(e.getString("Errors.Dzi"))}else{if(l==="Collection")throw new Error(e.getString("Errors.Dzc"));if(l==="Error"){var C=a.getElementsByTagName("Message")[0],p=C.firstChild.nodeValue;throw new Error(p)}}throw new Error(e.getString("Errors.Dzi"))}function r(o,s){var a=s.Image,l=a.Url,u=a.Format,c=a.Size,h=a.DisplayRect||[],d=parseInt(c.Width,10),g=parseInt(c.Height,10),y=parseInt(a.TileSize,10),S=parseInt(a.Overlap,10),E=[],C,p;for(p=0;p<h.length;p++)C=h[p].Rect,E.push(new e.DisplayRect(parseInt(C.X,10),parseInt(C.Y,10),parseInt(C.Width,10),parseInt(C.Height,10),parseInt(C.MinLevel,10),parseInt(C.MaxLevel,10)));return e.extend(!0,{width:d,height:g,tileSize:y,tileOverlap:S,minLevel:null,maxLevel:null,tilesUrl:l,fileFormat:u,displayRects:E},s)}}(i),function(e){e.IIIFTileSource=function(a){if(e.extend(!0,this,a),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(a.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=a.version,this.tile_width&&this.tile_height)a.tileWidth=this.tile_width,a.tileHeight=this.tile_height;else if(this.tile_width)a.tileSize=this.tile_width;else if(this.tile_height)a.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)a.tileWidth=this.tiles[0].width,a.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var l=0;l<this.tiles.length;l++)for(var u=0;u<this.tiles[l].scaleFactors.length;u++){var c=this.tiles[l].scaleFactors[u];this.scale_factors.push(c),a.tileSizePerScaleFactor[c]={width:this.tiles[l].width,height:this.tiles[l].height||this.tiles[l].width}}}else if(n(a)){for(var h=Math.min(this.height,this.width),d=[256,512,1024],g=[],y=0;y<d.length;y++)d[y]<=h&&g.push(d[y]);g.length>0?a.tileSize=Math.max.apply(null,g):a.tileSize=h}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,a.levels=r(this),e.extend(!0,a,{width:a.levels[a.levels.length-1].width,height:a.levels[a.levels.length-1].height,tileSize:Math.max(a.height,a.width),tileOverlap:0,minLevel:0,maxLevel:a.levels.length-1}),this.levels=a.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!a.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)a.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));else{var S=Math.max.apply(null,this.scale_factors);a.maxLevel=Math.round(Math.log(S)*Math.LOG2E)}e.TileSource.apply(this,[a])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(a,l){return a.protocol&&a.protocol==="http://iiif.io/api/image"||a["@context"]&&(a["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||a["@context"]==="http://iiif.io/api/image/1/context.json")||a.profile&&a.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||a.identifier&&a.width&&a.height?!0:!!(a.documentElement&&a.documentElement.tagName==="info"&&a.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(a,l){if(e.isPlainObject(a)){if(!a["@context"])a["@context"]="http://iiif.io/api/image/1.0/context.json",a["@id"]=l.replace("/info.json",""),a.version=1;else{var u=a["@context"];if(Array.isArray(u)){for(var c=0;c<u.length;c++)if(typeof u[c]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(u[c])||u[c]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){u=u[c];break}}switch(u){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":a.version=1;break;case"http://iiif.io/api/image/2/context.json":a.version=2;break;case"http://iiif.io/api/image/3/context.json":a.version=3;break;default:e.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(!a["@id"]&&a.id&&(a["@id"]=a.id),a.preferredFormats){for(var h=0;h<a.preferredFormats.length;h++)if(i.imageFormatSupported(a.preferredFormats[h])){a.tileFormat=a.preferredFormats[h];break}}return a}else{var d=o(a);return d["@context"]="http://iiif.io/api/image/1.0/context.json",d["@id"]=l.replace("/info.xml",""),d.version=1,d}},getTileWidth:function(a){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,a);var l=Math.pow(2,this.maxLevel-a);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].width:this._tileWidth},getTileHeight:function(a){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,a);var l=Math.pow(2,this.maxLevel-a);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[l]?this.tileSizePerScaleFactor[l].height:this._tileHeight},getLevelScale:function(a){if(this.emulateLegacyImagePyramid){var l=NaN;return this.levels.length>0&&a>=this.minLevel&&a<=this.maxLevel&&(l=this.levels[a].width/this.levels[this.maxLevel].width),l}return e.TileSource.prototype.getLevelScale.call(this,a)},getNumTiles:function(a){if(this.emulateLegacyImagePyramid){var l=this.getLevelScale(a);return l?new e.Point(1,1):new e.Point(0,0)}return e.TileSource.prototype.getNumTiles.call(this,a)},getTileAtPoint:function(a,l){return this.emulateLegacyImagePyramid?new e.Point(0,0):e.TileSource.prototype.getTileAtPoint.call(this,a,l)},getTileUrl:function(a,l,u){if(this.emulateLegacyImagePyramid){var c=null;return this.levels.length>0&&a>=this.minLevel&&a<=this.maxLevel&&(c=this.levels[a].url),c}var h="0",d=Math.pow(.5,this.maxLevel-a),g=Math.ceil(this.width*d),y=Math.ceil(this.height*d),S,E,C,p,x,A,P,D,O,I,N,W,q,G;return S=this.getTileWidth(a),E=this.getTileHeight(a),C=Math.ceil(S/d),p=Math.ceil(E/d),this.version===1?q="native."+this.tileFormat:q="default."+this.tileFormat,g<S&&y<E?(this.version===2&&g===this.width?I="full":this.version===3&&g===this.width&&y===this.height?I="max":this.version===3?I=g+","+y:I=g+",",x="full"):(A=l*C,P=u*p,D=Math.min(C,this.width-A),O=Math.min(p,this.height-P),l===0&&u===0&&D===this.width&&O===this.height?x="full":x=[A,P,D,O].join(","),N=Math.ceil(D*d),W=Math.ceil(O*d),this.version===2&&N===this.width?I="full":this.version===3&&N===this.width&&W===this.height?I="max":this.version===3?I=N+","+W:I=N+","),G=[this["@id"],x,I,h,q].join("/"),G},__testonly__:{canBeTiled:n,constructLevels:r}});function n(a){var l=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],u=Array.isArray(a.profile)?a.profile[0]:a.profile,c=l.indexOf(u)!==-1,h=!1;return a.version===2&&a.profile.length>1&&a.profile[1].supports&&(h=a.profile[1].supports.indexOf("sizeByW")!==-1),a.version===3&&a.extraFeatures&&(h=a.extraFeatures.indexOf("sizeByWh")!==-1),!c||h}function r(a){for(var l=[],u=0;u<a.sizes.length;u++)l.push({url:a["@id"]+"/full/"+a.sizes[u].width+","+(a.version===3?a.sizes[u].height:"")+"/0/default."+a.tileFormat,width:a.sizes[u].width,height:a.sizes[u].height});return l.sort(function(c,h){return c.width-h.width})}function o(a){if(!a||!a.documentElement)throw new Error(e.getString("Errors.Xml"));var l=a.documentElement,u=l.tagName,c=null;if(u==="info")try{return c={},s(l,c),c}catch(h){throw h instanceof Error?h:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function s(a,l,u){var c,h;if(a.nodeType===3&&u)h=a.nodeValue.trim(),h.match(/^\d*$/)&&(h=Number(h)),l[u]?(e.isArray(l[u])||(l[u]=[l[u]]),l[u].push(h)):l[u]=h;else if(a.nodeType===1)for(c=0;c<a.childNodes.length;c++)s(a.childNodes[c],l,a.nodeName)}}(i),function(e){e.OsmTileSource=function(n,r,o,s,a){var l;e.isPlainObject(n)?l=n:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!l.width||!l.height)&&(l.width=65572864,l.height=65572864),l.tileSize||(l.tileSize=256,l.tileOverlap=0),l.tilesUrl||(l.tilesUrl="http://tile.openstreetmap.org/"),l.minLevel=8,e.TileSource.apply(this,[l])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="openstreetmaps"},configure:function(n,r){return n},getTileUrl:function(n,r,o){return this.tilesUrl+(n-8)+"/"+r+"/"+o+".png"}})}(i),function(e){e.TmsTileSource=function(n,r,o,s,a){var l;e.isPlainObject(n)?l=n:l={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var u=Math.ceil(l.width/256)*256,c=Math.ceil(l.height/256)*256,h;u>c?h=u/256:h=c/256,l.maxLevel=Math.ceil(Math.log(h)/Math.log(2))-1,l.tileSize=256,l.width=u,l.height=c,e.TileSource.apply(this,[l])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="tiledmapservice"},configure:function(n,r){return n},getTileUrl:function(n,r,o){var s=this.getNumTiles(n).y-1;return this.tilesUrl+n+"/"+r+"/"+(s-o)+".png"}})}(i),function(e){e.ZoomifyTileSource=function(n){typeof n.tileSize>"u"&&(n.tileSize=256),typeof n.fileFormat>"u"&&(n.fileFormat="jpg",this.fileFormat=n.fileFormat);var r={x:n.width,y:n.height};for(n.imageSizes=[{x:n.width,y:n.height}],n.gridSize=[this._getGridSize(n.width,n.height,n.tileSize)];parseInt(r.x,10)>n.tileSize||parseInt(r.y,10)>n.tileSize;)r.x=Math.floor(r.x/2),r.y=Math.floor(r.y/2),n.imageSizes.push({x:r.x,y:r.y}),n.gridSize.push(this._getGridSize(r.x,r.y,n.tileSize));n.imageSizes.reverse(),n.gridSize.reverse(),n.minLevel=0,n.maxLevel=n.gridSize.length-1,i.TileSource.apply(this,[n])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(n,r,o){return{x:Math.ceil(n/o),y:Math.ceil(r/o)}},_calculateAbsoluteTileNumber:function(n,r,o){for(var s=0,a={},l=0;l<n;l++)a=this.gridSize[l],s+=a.x*a.y;return a=this.gridSize[n],s+=a.x*o+r,s},supports:function(n,r){return n.type&&n.type==="zoomifytileservice"},configure:function(n,r){return n},getTileUrl:function(n,r,o){var s=0,a=this._calculateAbsoluteTileNumber(n,r,o);return s=Math.floor(a/256),this.tilesUrl+"TileGroup"+s+"/"+n+"-"+r+"-"+o+"."+this.fileFormat}})}(i),function(e){e.LegacyTileSource=function(s){var a,l,u;e.isArray(s)&&(a={type:"legacy-image-pyramid",levels:s}),a.levels=n(a.levels),a.levels.length>0?(l=a.levels[a.levels.length-1].width,u=a.levels[a.levels.length-1].height):(l=0,u=0,e.console.error("No supported image formats found")),e.extend(!0,a,{width:l,height:u,tileSize:Math.max(u,l),tileOverlap:0,minLevel:0,maxLevel:a.levels.length>0?a.levels.length-1:0}),e.TileSource.apply(this,[a]),this.levels=a.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(s,a){return s.type&&s.type==="legacy-image-pyramid"||s.documentElement&&s.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(s,a){var l;return e.isPlainObject(s)?l=o(this,s):l=r(this,s),l},getLevelScale:function(s){var a=NaN;return this.levels.length>0&&s>=this.minLevel&&s<=this.maxLevel&&(a=this.levels[s].width/this.levels[this.maxLevel].width),a},getNumTiles:function(s){var a=this.getLevelScale(s);return a?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(s,a,l){var u=null;return this.levels.length>0&&s>=this.minLevel&&s<=this.maxLevel&&(u=this.levels[s].url),u}});function n(s){var a=[],l,u;for(u=0;u<s.length;u++)l=s[u],l.height&&l.width&&l.url?a.push({url:l.url,width:Number(l.width),height:Number(l.height)}):e.console.error("Unsupported image format: %s",l.url?l.url:"<no URL>");return a.sort(function(c,h){return c.height-h.height})}function r(s,a){if(!a||!a.documentElement)throw new Error(e.getString("Errors.Xml"));var l=a.documentElement,u=l.tagName,c=null,h=[],d,g;if(u==="image")try{for(c={type:l.getAttribute("type"),levels:[]},h=l.getElementsByTagName("level"),g=0;g<h.length;g++)d=h[g],c.levels.push({url:d.getAttribute("url"),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10)});return o(s,c)}catch(y){throw y instanceof Error?y:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(u==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(u==="error")throw new Error("Error: "+a)}throw new Error("Unknown element "+u)}function o(s,a){return a.levels}}(i),function(e){e.ImageTileSource=function(n){n=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},n),e.TileSource.apply(this,[n])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){return n.type&&n.type==="image"},configure:function(n,r){return n},getImageInfo:function(n){var r=this._image=new Image,o=this;this.crossOriginPolicy&&(r.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(r.useCredentials=this.ajaxWithCredentials),e.addEvent(r,"load",function(){o.width=r.naturalWidth,o.height=r.naturalHeight,o.aspectRatio=o.width/o.height,o.dimensions=new e.Point(o.width,o.height),o._tileWidth=o.width,o._tileHeight=o.height,o.tileOverlap=0,o.minLevel=0,o.levels=o._buildLevels(),o.maxLevel=o.levels.length-1,o.ready=!0,o.raiseEvent("ready",{tileSource:o})}),e.addEvent(r,"error",function(){o.raiseEvent("open-failed",{message:"Error loading image at "+n,source:n})}),r.src=n},getLevelScale:function(n){var r=NaN;return n>=this.minLevel&&n<=this.maxLevel&&(r=this.levels[n].width/this.levels[this.maxLevel].width),r},getNumTiles:function(n){var r=this.getLevelScale(n);return r?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(n,r,o){var s=null;return n>=this.minLevel&&n<=this.maxLevel&&(s=this.levels[n].url),s},getContext2D:function(n,r,o){var s=null;return n>=this.minLevel&&n<=this.maxLevel&&(s=this.levels[n].context2D),s},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var n=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,n;var r=this._image.naturalWidth,o=this._image.naturalHeight,s=document.createElement("canvas"),a=s.getContext("2d");if(s.width=r,s.height=o,a.drawImage(this._image,0,0,r,o),n[0].context2D=a,delete this._image,e.isCanvasTainted(s))return n;for(;r>=2&&o>=2;){r=Math.floor(r/2),o=Math.floor(o/2);var l=document.createElement("canvas"),u=l.getContext("2d");l.width=r,l.height=o,u.drawImage(s,0,0,r,o),n.splice(0,0,{context2D:u,width:r,height:o}),s=l,a=u}return n},_freeupCanvasMemory:function(){for(var n=0;n<this.levels.length;n++)this.levels[n].context2D.canvas.height=0,this.levels[n].context2D.canvas.width=0}})}(i),function(e){e.TileSourceCollection=function(n,r,o,s){e.console.error("TileSourceCollection is deprecated; use World instead")}}(i),function(e){e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(u){var c=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},u),this.element=u.element||e.makeNeutralElement("div"),u.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,e.setElementPointerEventsNone(this.imgRest),e.setElementPointerEventsNone(this.imgGroup),e.setElementPointerEventsNone(this.imgHover),e.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor===e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(h){h.insideElementPressed?(a(c,e.ButtonState.DOWN),c.raiseEvent("enter",{originalEvent:h.originalEvent})):h.buttonDownAny||a(c,e.ButtonState.HOVER)},focusHandler:function(h){c.tracker.enterHandler(h),c.raiseEvent("focus",{originalEvent:h.originalEvent})},leaveHandler:function(h){l(c,e.ButtonState.GROUP),h.insideElementPressed&&c.raiseEvent("exit",{originalEvent:h.originalEvent})},blurHandler:function(h){c.tracker.leaveHandler(h),c.raiseEvent("blur",{originalEvent:h.originalEvent})},pressHandler:function(h){a(c,e.ButtonState.DOWN),c.raiseEvent("press",{originalEvent:h.originalEvent})},releaseHandler:function(h){h.insideElementPressed&&h.insideElementReleased?(l(c,e.ButtonState.HOVER),c.raiseEvent("release",{originalEvent:h.originalEvent})):h.insideElementPressed?l(c,e.ButtonState.GROUP):a(c,e.ButtonState.HOVER)},clickHandler:function(h){h.quick&&c.raiseEvent("click",{originalEvent:h.originalEvent})},keyHandler:function(h){h.keyCode===13?(c.raiseEvent("click",{originalEvent:h.originalEvent}),c.raiseEvent("release",{originalEvent:h.originalEvent}),h.preventDefault=!0):h.preventDefault=!1}}),l(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){a(this,e.ButtonState.GROUP)},notifyGroupExit:function(){l(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function n(u){e.requestAnimationFrame(function(){r(u)})}function r(u){var c,h,d;u.shouldFade&&(c=e.now(),h=c-u.fadeBeginTime,d=1-h/u.fadeLength,d=Math.min(1,d),d=Math.max(0,d),u.imgGroup&&e.setElementOpacity(u.imgGroup,d,!0),d>0&&n(u))}function o(u){u.shouldFade=!0,u.fadeBeginTime=e.now()+u.fadeDelay,window.setTimeout(function(){n(u)},u.fadeDelay)}function s(u){u.shouldFade=!1,u.imgGroup&&e.setElementOpacity(u.imgGroup,1,!0)}function a(u,c){u.element.disabled||(c>=e.ButtonState.GROUP&&u.currentState===e.ButtonState.REST&&(s(u),u.currentState=e.ButtonState.GROUP),c>=e.ButtonState.HOVER&&u.currentState===e.ButtonState.GROUP&&(u.imgHover&&(u.imgHover.style.visibility=""),u.currentState=e.ButtonState.HOVER),c>=e.ButtonState.DOWN&&u.currentState===e.ButtonState.HOVER&&(u.imgDown&&(u.imgDown.style.visibility=""),u.currentState=e.ButtonState.DOWN))}function l(u,c){u.element.disabled||(c<=e.ButtonState.HOVER&&u.currentState===e.ButtonState.DOWN&&(u.imgDown&&(u.imgDown.style.visibility="hidden"),u.currentState=e.ButtonState.HOVER),c<=e.ButtonState.GROUP&&u.currentState===e.ButtonState.HOVER&&(u.imgHover&&(u.imgHover.style.visibility="hidden"),u.currentState=e.ButtonState.GROUP),c<=e.ButtonState.REST&&u.currentState===e.ButtonState.GROUP&&(o(u),u.currentState=e.ButtonState.REST))}}(i),function(e){e.ButtonGroup=function(n){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},n);var r=this.buttons.concat([]),o=this,s;if(this.element=n.element||e.makeNeutralElement("div"),!n.group)for(this.element.style.display="inline-block",s=0;s<r.length;s++)this.element.appendChild(r[s].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(a){var l;for(l=0;l<o.buttons.length;l++)o.buttons[l].notifyGroupEnter()},leaveHandler:function(a){var l;if(!a.insideElementPressed)for(l=0;l<o.buttons.length;l++)o.buttons[l].notifyGroupExit()}})},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var n=this.buttons.pop();this.element.removeChild(n.element),n.destroy()}this.tracker.destroy(),this.element=null}}}(i),function(e){e.Rect=function(n,r,o,s,a){this.x=typeof n=="number"?n:0,this.y=typeof r=="number"?r:0,this.width=typeof o=="number"?o:0,this.height=typeof s=="number"?s:0,this.degrees=typeof a=="number"?a:0,this.degrees=e.positiveModulo(this.degrees,360);var l,u;this.degrees>=270?(l=this.getTopRight(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=270):this.degrees>=180?(l=this.getBottomRight(),this.x=l.x,this.y=l.y,this.degrees-=180):this.degrees>=90&&(l=this.getBottomLeft(),this.x=l.x,this.y=l.y,u=this.height,this.height=this.width,this.width=u,this.degrees-=90)},e.Rect.fromSummits=function(n,r,o){var s=n.distanceTo(r),a=n.distanceTo(o),l=r.minus(n),u=Math.atan(l.y/l.x);return l.x<0?u+=Math.PI:l.y<0&&(u+=2*Math.PI),new e.Rect(n.x,n.y,s,a,u/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(n){return n instanceof e.Rect&&this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height&&this.degrees===n.degrees},times:function(n){return new e.Rect(this.x*n,this.y*n,this.width*n,this.height*n,this.degrees)},translate:function(n){return new e.Rect(this.x+n.x,this.y+n.y,this.width,this.height,this.degrees)},union:function(n){var r=this.getBoundingBox(),o=n.getBoundingBox(),s=Math.min(r.x,o.x),a=Math.min(r.y,o.y),l=Math.max(r.x+r.width,o.x+o.width),u=Math.max(r.y+r.height,o.y+o.height);return new e.Rect(s,a,l-s,u-a)},intersection:function(n){var r=1e-10,o=[],s=this.getTopLeft();n.containsPoint(s,r)&&o.push(s);var a=this.getTopRight();n.containsPoint(a,r)&&o.push(a);var l=this.getBottomLeft();n.containsPoint(l,r)&&o.push(l);var u=this.getBottomRight();n.containsPoint(u,r)&&o.push(u);var c=n.getTopLeft();this.containsPoint(c,r)&&o.push(c);var h=n.getTopRight();this.containsPoint(h,r)&&o.push(h);var d=n.getBottomLeft();this.containsPoint(d,r)&&o.push(d);var g=n.getBottomRight();this.containsPoint(g,r)&&o.push(g);for(var y=this._getSegments(),S=n._getSegments(),E=0;E<y.length;E++)for(var C=y[E],p=0;p<S.length;p++){var x=S[p],A=P(C[0],C[1],x[0],x[1]);A&&o.push(A)}function P(G,J,K,oe){var re=J.minus(G),ae=oe.minus(K),pe=-ae.x*re.y+re.x*ae.y;if(pe===0)return null;var Ee=(re.x*(G.y-K.y)-re.y*(G.x-K.x))/pe,$=(ae.x*(G.y-K.y)-ae.y*(G.x-K.x))/pe;return-r<=Ee&&Ee<=1-r&&-r<=$&&$<=1-r?new e.Point(G.x+$*re.x,G.y+$*re.y):null}if(o.length===0)return null;for(var D=o[0].x,O=o[0].x,I=o[0].y,N=o[0].y,W=1;W<o.length;W++){var q=o[W];q.x<D&&(D=q.x),q.x>O&&(O=q.x),q.y<I&&(I=q.y),q.y>N&&(N=q.y)}return new e.Rect(D,I,O-D,N-I)},_getSegments:function(){var n=this.getTopLeft(),r=this.getTopRight(),o=this.getBottomLeft(),s=this.getBottomRight();return[[n,r],[r,s],[s,o],[o,n]]},rotate:function(n,r){if(n=e.positiveModulo(n,360),n===0)return this.clone();r=r||this.getCenter();var o=this.getTopLeft().rotate(n,r),s=this.getTopRight().rotate(n,r),a=s.minus(o);a=a.apply(function(u){var c=1e-15;return Math.abs(u)<c?0:u});var l=Math.atan(a.y/a.x);return a.x<0?l+=Math.PI:a.y<0&&(l+=2*Math.PI),new e.Rect(o.x,o.y,this.width,this.height,l/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var n=this.getTopLeft(),r=this.getTopRight(),o=this.getBottomLeft(),s=this.getBottomRight(),a=Math.min(n.x,r.x,o.x,s.x),l=Math.max(n.x,r.x,o.x,s.x),u=Math.min(n.y,r.y,o.y,s.y),c=Math.max(n.y,r.y,o.y,s.y);return new e.Rect(a,u,l-a,c-u)},getIntegerBoundingBox:function(){var n=this.getBoundingBox(),r=Math.floor(n.x),o=Math.floor(n.y),s=Math.ceil(n.width+n.x-r),a=Math.ceil(n.height+n.y-o);return new e.Rect(r,o,s,a)},containsPoint:function(n,r){r=r||0;var o=this.getTopLeft(),s=this.getTopRight(),a=this.getBottomLeft(),l=s.minus(o),u=a.minus(o);return(n.x-o.x)*l.x+(n.y-o.y)*l.y>=-r&&(n.x-s.x)*l.x+(n.y-s.y)*l.y<=r&&(n.x-o.x)*u.x+(n.y-o.y)*u.y>=-r&&(n.x-a.x)*u.x+(n.y-a.y)*u.y<=r},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(i),function(e){var n={};e.ReferenceStrip=function(d){var g=this,y=d.viewer,S=e.getElementSize(y.element),E,C,p;for(d.id||(d.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=d.id,this.element.className="referencestrip"),d=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},d,{element:this.element}),e.extend(this,d),n[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,C=this.element.style,C.marginTop="0px",C.marginRight="0px",C.marginBottom="0px",C.marginLeft="0px",C.left="0px",C.bottom="0px",C.border="0px",C.background="#000",C.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=y,this.tracker=new e.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:e.delegate(this,r),dragHandler:e.delegate(this,o),scrollHandler:e.delegate(this,s),enterHandler:e.delegate(this,l),leaveHandler:e.delegate(this,u),keyDownHandler:e.delegate(this,c),keyHandler:e.delegate(this,h),preProcessEventHandler:function(x){x.eventType==="wheel"&&(x.preventDefault=!0)}}),d.width&&d.height?(this.element.style.width=d.width+"px",this.element.style.height=d.height+"px",y.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):d.scroll==="horizontal"?(this.element.style.width=S.x*d.sizeRatio*y.tileSources.length+12*y.tileSources.length+"px",this.element.style.height=S.y*d.sizeRatio+"px",y.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=S.y*d.sizeRatio*y.tileSources.length+12*y.tileSources.length+"px",this.element.style.width=S.x*d.sizeRatio+"px",y.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=S.x*this.sizeRatio+8,this.panelHeight=S.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},p=0;p<y.tileSources.length;p++)E=e.makeNeutralElement("div"),E.id=this.element.id+"-"+p,E.style.width=g.panelWidth+"px",E.style.height=g.panelHeight+"px",E.style.display="inline",E.style.float="left",E.style.cssFloat="left",E.style.styleFloat="left",E.style.padding="2px",e.setElementTouchActionNone(E),e.setElementPointerEventsNone(E),this.element.appendChild(E),E.activePanel=!1,this.panels.push(E);a(this,this.scroll==="vertical"?S.y:S.x,0),this.setFocus(0)},e.ReferenceStrip.prototype={setFocus:function(d){var g=this.element.querySelector("#"+this.element.id+"-"+d),y=e.getElementSize(this.viewer.canvas),S=Number(this.element.style.width.replace("px","")),E=Number(this.element.style.height.replace("px","")),C=-Number(this.element.style.marginLeft.replace("px","")),p=-Number(this.element.style.marginTop.replace("px","")),x;this.currentSelected!==g&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=g,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(x=Number(d)*(this.panelWidth+3),x>C+y.x-this.panelWidth?(x=Math.min(x,S-y.x),this.element.style.marginLeft=-x+"px",a(this,y.x,-x)):x<C&&(x=Math.max(0,x-y.x/2),this.element.style.marginLeft=-x+"px",a(this,y.x,-x))):(x=Number(d)*(this.panelHeight+3),x>p+y.y-this.panelHeight?(x=Math.min(x,E-y.y),this.element.style.marginTop=-x+"px",a(this,y.y,-x)):x<p&&(x=Math.max(0,x-y.y/2),this.element.style.marginTop=-x+"px",a(this,y.y,-x))),this.currentPage=d,l.call(this,{eventSource:this.tracker}))},update:function(){return n[this.id].animating?(e.console.log("image reference strip update"),!0):!1},destroy:function(){if(this.miniViewers)for(var d in this.miniViewers)this.miniViewers[d].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function r(d){if(d.quick){var g;this.scroll==="horizontal"?g=Math.floor(d.position.x/this.panelWidth):g=Math.floor(d.position.y/this.panelHeight),this.viewer.goToPage(g)}this.element.focus()}function o(d){if(this.dragging=!0,this.element){var g=Number(this.element.style.marginLeft.replace("px","")),y=Number(this.element.style.marginTop.replace("px","")),S=Number(this.element.style.width.replace("px","")),E=Number(this.element.style.height.replace("px","")),C=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-d.delta.x>0?g>-(S-C.x)&&(this.element.style.marginLeft=g+d.delta.x*2+"px",a(this,C.x,g+d.delta.x*2)):-d.delta.x<0&&g<0&&(this.element.style.marginLeft=g+d.delta.x*2+"px",a(this,C.x,g+d.delta.x*2)):-d.delta.y>0?y>-(E-C.y)&&(this.element.style.marginTop=y+d.delta.y*2+"px",a(this,C.y,y+d.delta.y*2)):-d.delta.y<0&&y<0&&(this.element.style.marginTop=y+d.delta.y*2+"px",a(this,C.y,y+d.delta.y*2))}}function s(d){if(this.element){var g=Number(this.element.style.marginLeft.replace("px","")),y=Number(this.element.style.marginTop.replace("px","")),S=Number(this.element.style.width.replace("px","")),E=Number(this.element.style.height.replace("px","")),C=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?d.scroll>0?g>-(S-C.x)&&(this.element.style.marginLeft=g-d.scroll*60+"px",a(this,C.x,g-d.scroll*60)):d.scroll<0&&g<0&&(this.element.style.marginLeft=g-d.scroll*60+"px",a(this,C.x,g-d.scroll*60)):d.scroll<0?y>C.y-E&&(this.element.style.marginTop=y+d.scroll*60+"px",a(this,C.y,y+d.scroll*60)):d.scroll>0&&y<0&&(this.element.style.marginTop=y+d.scroll*60+"px",a(this,C.y,y+d.scroll*60)),d.preventDefault=!0}}function a(d,g,y){var S,E,C,p,x,A;for(d.scroll==="horizontal"?S=d.panelWidth:S=d.panelHeight,E=Math.ceil(g/S)+5,C=Math.ceil((Math.abs(y)+g)/S)+1,E=C-E,E=E<0?0:E,x=E;x<C&&x<d.panels.length;x++)if(A=d.panels[x],!A.activePanel){var P,D=d.viewer.tileSources[x];D.referenceStripThumbnailUrl?P={type:"image",url:D.referenceStripThumbnailUrl}:P=D,p=new e.Viewer({id:A.id,tileSources:[P],element:A,navigatorSizeRatio:d.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:d.viewer.loadTilesWithAjax,ajaxHeaders:d.viewer.ajaxHeaders,useCanvas:d.useCanvas}),e.setElementPointerEventsNone(p.canvas),e.setElementPointerEventsNone(p.container),p.innerTracker.setTracking(!1),p.outerTracker.setTracking(!1),d.miniViewers[A.id]=p,A.activePanel=!0}}function l(d){var g=d.eventSource.element;this.scroll==="horizontal"?g.style.marginBottom="0px":g.style.marginLeft="0px"}function u(d){var g=d.eventSource.element;this.scroll==="horizontal"?g.style.marginBottom="-"+e.getElementSize(g).y/2+"px":g.style.marginLeft="-"+e.getElementSize(g).x/2+"px"}function c(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 38:s.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 40:s.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 37:s.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 39:s.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}function h(d){if(!d.ctrl&&!d.alt&&!d.meta)switch(d.keyCode){case 61:s.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 45:s.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 48:case 119:case 87:s.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;case 115:case 83:s.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 97:s.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),d.preventDefault=!0;break;case 100:s.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),d.preventDefault=!0;break;default:d.preventDefault=!1;break}else d.preventDefault=!1}}(i),function(e){e.DisplayRect=function(n,r,o,s,a,l){e.Rect.apply(this,[n,r,o,s]),this.minLevel=a,this.maxLevel=l},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(i),function(e){e.Spring=function(r){var o=arguments;typeof r!="object"&&(r={initial:o.length&&typeof o[0]=="number"?o[0]:void 0,springStiffness:o.length>1?o[1].springStiffness:5,animationTime:o.length>1?o[1].animationTime:1.5}),e.console.assert(typeof r.springStiffness=="number"&&r.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert(typeof r.animationTime=="number"&&r.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),r.exponential&&(this._exponential=!0,delete r.exponential),e.extend(!0,this,r),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(r){e.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=r,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(r){e.console.assert(!this._exponential||r!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=r,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(r){this.start.value+=r,this.target.value+=r,this._exponential&&(e.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(r){this._exponential=r,this._exponential&&(e.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=e.now();var r,o;this._exponential?(r=this.start._logValue,o=this.target._logValue):(r=this.start.value,o=this.target.value);var s=this.current.time>=this.target.time?o:r+(o-r)*n(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),a=this.current.value;return this._exponential?this.current.value=Math.exp(s):this.current.value=s,a!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function n(r,o){return(1-Math.exp(r*-o))/(1-Math.exp(-r))}}(i),function(e){function n(o){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null},o),this.image=null}n.prototype={errorMsg:null,start:function(){var o=this,s=this.abort;this.image=new Image,this.image.onload=function(){o.finish(!0)},this.image.onabort=this.image.onerror=function(){o.errorMsg="Image load aborted",o.finish(!1)},this.jobId=window.setTimeout(function(){o.errorMsg="Image load exceeded timeout ("+o.timeout+" ms)",o.finish(!1)},this.timeout),this.loadWithAjax?(this.request=e.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(a){var l;try{l=new window.Blob([a.response])}catch(d){var u=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(d.name==="TypeError"&&u){var c=new u;c.append(a.response),l=c.getBlob()}}l.size===0&&(o.errorMsg="Empty image response.",o.finish(!1));var h=(window.URL||window.webkitURL).createObjectURL(l);o.image.src=h},error:function(a){o.errorMsg="Image load aborted - XHR error",o.finish(!1)}}),this.abort=function(){o.request.abort(),typeof s=="function"&&s()}):(this.crossOriginPolicy!==!1&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(o){this.image.onload=this.image.onerror=this.image.onabort=null,o||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(o){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},o)},e.ImageLoader.prototype={addJob:function(o){var s=this,a=function(c){r(s,c,o.callback)},l={src:o.src,loadWithAjax:o.loadWithAjax,ajaxHeaders:o.loadWithAjax?o.ajaxHeaders:null,crossOriginPolicy:o.crossOriginPolicy,ajaxWithCredentials:o.ajaxWithCredentials,callback:a,abort:o.abort,timeout:this.timeout},u=new n(l);!this.jobLimit||this.jobsInProgress<this.jobLimit?(u.start(),this.jobsInProgress++):this.jobQueue.push(u)},clear:function(){for(var o=0;o<this.jobQueue.length;o++){var s=this.jobQueue[o];typeof s.abort=="function"&&s.abort()}this.jobQueue=[]}};function r(o,s,a){var l;o.jobsInProgress--,(!o.jobLimit||o.jobsInProgress<o.jobLimit)&&o.jobQueue.length>0&&(l=o.jobQueue.shift(),l.start(),o.jobsInProgress++),a(s.image,s.errorMsg,s.request)}}(i),function(e){e.Tile=function(n,r,o,s,a,l,u,c,h,d){this.level=n,this.x=r,this.y=o,this.bounds=s,this.sourceBounds=d,this.exists=a,this.url=l,this.context2D=u,this.loadWithAjax=c,this.ajaxHeaders=h,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(n){if(!this.cacheImageRecord){e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!==n&&n.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),e.setElementOpacity(this.element,this.opacity)},drawCanvas:function(n,r,o,s){var a=this.position.times(e.pixelDensityRatio),l=this.size.times(e.pixelDensityRatio),u;if(!this.context2D&&!this.cacheImageRecord){e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(u=this.context2D||this.cacheImageRecord.getRenderedContext(),!this.loaded||!u){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}n.save(),n.globalAlpha=this.opacity,typeof o=="number"&&o!==1&&(a=a.times(o),l=l.times(o)),s instanceof e.Point&&(a=a.plus(s)),n.globalAlpha===1&&this._hasTransparencyChannel()&&n.clearRect(a.x,a.y,l.x,l.y),r({context:n,tile:this,rendered:u});var c,h;this.sourceBounds?(c=Math.min(this.sourceBounds.width,u.canvas.width),h=Math.min(this.sourceBounds.height,u.canvas.height)):(c=u.canvas.width,h=u.canvas.height),n.translate(a.x+l.x/2,0),this.flipped&&n.scale(-1,1),n.drawImage(u.canvas,0,0,c,h,-l.x/2,a.y,l.x,l.y),n.restore()},getScaleForEdgeSmoothing:function(){var n;if(this.cacheImageRecord)n=this.cacheImageRecord.getRenderedContext();else if(this.context2D)n=this.context2D;else return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return n.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(n,r,o){var s=Math.max(1,Math.ceil((o.x-r.x)/2)),a=Math.max(1,Math.ceil((o.y-r.y)/2));return new e.Point(s,a).minus(this.position.times(e.pixelDensityRatio).times(n||1).apply(function(l){return l%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(i),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(n,r,o){var s;e.isPlainObject(n)?s=n:s={element:n,location:r,placement:o},this.element=s.element,this.style=s.element.style,this._init(s)},e.Overlay.prototype={_init:function(n){this.location=n.location,this.placement=n.placement===void 0?e.Placement.TOP_LEFT:n.placement,this.onDraw=n.onDraw,this.checkResize=n.checkResize===void 0?!0:n.checkResize,this.width=n.width===void 0?null:n.width,this.height=n.height===void 0?null:n.height,this.rotationMode=n.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(n,r){var o=e.Placement.properties[this.placement];!o||(o.isHorizontallyCentered?n.x-=r.x/2:o.isRight&&(n.x-=r.x),o.isVerticallyCentered?n.y-=r.y/2:o.isBottom&&(n.y-=r.y))},destroy:function(){var n=this.element,r=this.style;n.parentNode&&(n.parentNode.removeChild(n),n.prevElementParent&&(r.display="none",document.body.appendChild(n))),this.onDraw=null,r.top="",r.left="",r.position="",this.width!==null&&(r.width=""),this.height!==null&&(r.height="");var o=e.getCssPropertyWithVendorPrefix("transformOrigin"),s=e.getCssPropertyWithVendorPrefix("transform");o&&s&&(r[o]="",r[s]="")},drawHTML:function(n,r){var o=this.element;o.parentNode!==n&&(o.prevElementParent=o.parentNode,o.prevNextSibling=o.nextSibling,n.appendChild(o),this.style.position="absolute",this.size=e.getElementSize(o));var s=this._getOverlayPositionAndSize(r),a=s.position,l=this.size=s.size,u=s.rotate;if(this.onDraw)this.onDraw(a,l,this.element);else{var c=this.style;c.left=a.x+"px",c.top=a.y+"px",this.width!==null&&(c.width=l.x+"px"),this.height!==null&&(c.height=l.y+"px");var h=e.getCssPropertyWithVendorPrefix("transformOrigin"),d=e.getCssPropertyWithVendorPrefix("transform");h&&d&&(u?(c[h]=this._getTransformOrigin(),c[d]="rotate("+u+"deg)"):(c[h]="",c[d]="")),c.display="block"}},_getOverlayPositionAndSize:function(n){var r=n.pixelFromPoint(this.location,!0),o=this._getSizeInPixels(n);this.adjust(r,o);var s=0;if(n.degrees&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var a=new e.Rect(r.x,r.y,o.x,o.y),l=this._getBoundingBox(a,n.degrees);r=l.getTopLeft(),o=l.getSize()}else s=n.degrees;return{position:r,size:o,rotate:s}},_getSizeInPixels:function(n){var r=this.size.x,o=this.size.y;if(this.width!==null||this.height!==null){var s=n.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);this.width!==null&&(r=s.x),this.height!==null&&(o=s.y)}if(this.checkResize&&(this.width===null||this.height===null)){var a=this.size=e.getElementSize(this.element);this.width===null&&(r=a.x),this.height===null&&(o=a.y)}return new e.Point(r,o)},_getBoundingBox:function(n,r){var o=this._getPlacementPoint(n);return n.rotate(r,o).getBoundingBox()},_getPlacementPoint:function(n){var r=new e.Point(n.x,n.y),o=e.Placement.properties[this.placement];return o&&(o.isHorizontallyCentered?r.x+=n.width/2:o.isRight&&(r.x+=n.width),o.isVerticallyCentered?r.y+=n.height/2:o.isBottom&&(r.y+=n.height)),r},_getTransformOrigin:function(){var n="",r=e.Placement.properties[this.placement];return r&&(r.isLeft?n="left":r.isRight&&(n="right"),r.isTop?n+=" top":r.isBottom&&(n+=" bottom")),n},update:function(n,r){var o=e.isPlainObject(n)?n:{location:n,placement:r};this._init({location:o.location||this.location,placement:o.placement!==void 0?o.placement:this.placement,onDraw:o.onDraw||this.onDraw,checkResize:o.checkResize||this.checkResize,width:o.width!==void 0?o.width:this.width,height:o.height!==void 0?o.height:this.height,rotationMode:o.rotationMode||this.rotationMode})},getBounds:function(n){e.console.assert(n,"A viewport must now be passed to Overlay.getBounds.");var r=this.width,o=this.height;if(r===null||o===null){var s=n.deltaPointsFromPixelsNoRotate(this.size,!0);r===null&&(r=s.x),o===null&&(o=s.y)}var a=this.location.clone();return this.adjust(a,new e.Point(r,o)),this._adjustBoundsForRotation(n,new e.Rect(a.x,a.y,r,o))},_adjustBoundsForRotation:function(n,r){if(!n||n.degrees===0||this.rotationMode===e.OverlayRotationMode.EXACT)return r;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return r;var o=this._getOverlayPositionAndSize(n);return n.viewerElementToViewportRectangle(new e.Rect(o.position.x,o.position.y,o.size.x,o.size.y))}return r.rotate(-n.degrees,this._getPlacementPoint(r))}}}(i),function(e){e.Drawer=function(n){e.console.assert(n.viewer,"[Drawer] options.viewer is required");var r=arguments;if(e.isPlainObject(n)||(n={source:r[0],viewport:r[1],element:r[2]}),e.console.assert(n.viewport,"[Drawer] options.viewport is required"),e.console.assert(n.element,"[Drawer] options.element is required"),n.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=n.viewer,this.viewport=n.viewport,this.debugGridColor=typeof n.debugGridColor=="string"?[n.debugGridColor]:n.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,n.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=e.getElement(n.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var o=this._calculateCanvasSize();this.canvas.width=o.x,this.canvas.height=o.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),e.setElementPointerEventsNone(this.canvas),e.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},e.Drawer.prototype={addOverlay:function(n,r,o,s){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(n,r,o,s),this},updateOverlay:function(n,r,o){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(n,r,o),this},removeOverlay:function(n){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(n),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(n){var r=this.viewport.pixelFromPointNoRotate(n,!0);return new e.Point(r.x*e.pixelDensityRatio,r.y*e.pixelDensityRatio)},clipWithPolygons:function(n,r){if(this.useCanvas){var o=this._getContext(r);o.beginPath(),n.forEach(function(s){s.forEach(function(a,l){o[l===0?"moveTo":"lineTo"](a.x,a.y)})}),o.clip()}},setOpacity:function(n){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var r=this.viewer.world,o=0;o<r.getItemCount();o++)r.getItemAt(o).setOpacity(n);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var n=this.viewer.world,r=0,o=0;o<n.getItemCount();o++){var s=n.getItemAt(o).getOpacity();s>r&&(r=s)}return r},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var n=this._calculateCanvasSize();if((this.canvas.width!==n.x||this.canvas.height!==n.y)&&(this.canvas.width=n.x,this.canvas.height=n.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var r=this._calculateSketchCanvasSize();this.sketchCanvas.width=r.x,this.sketchCanvas.height=r.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(n,r){if(this.useCanvas){var o=this._getContext(n);if(r)o.clearRect(r.x,r.y,r.width,r.height);else{var s=o.canvas;o.clearRect(0,0,s.width,s.height)}}},viewportToDrawerRectangle:function(n){var r=this.viewport.pixelFromPointNoRotate(n.getTopLeft(),!0),o=this.viewport.deltaPixelsFromPointsNoRotate(n.getSize(),!0);return new e.Rect(r.x*e.pixelDensityRatio,r.y*e.pixelDensityRatio,o.x*e.pixelDensityRatio,o.y*e.pixelDensityRatio)},drawTile:function(n,r,o,s,a){if(e.console.assert(n,"[Drawer.drawTile] tile is required"),e.console.assert(r,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var l=this._getContext(o);s=s||1,n.drawCanvas(l,r,s,a)}else n.drawHTML(this.canvas)},_getContext:function(n){var r=this.context;if(n){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var o=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=o.x,this.sketchCanvas.height=o.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var s=this;this.viewer.addHandler("rotate",function a(){if(s.viewport.getRotation()!==0){s.viewer.removeHandler("rotate",a);var l=s._calculateSketchCanvasSize();s.sketchCanvas.width=l.x,s.sketchCanvas.height=l.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}r=this.sketchContext}return r},saveContext:function(n){!this.useCanvas||this._getContext(n).save()},restoreContext:function(n){!this.useCanvas||this._getContext(n).restore()},setClip:function(n,r){if(this.useCanvas){var o=this._getContext(r);o.beginPath(),o.rect(n.x,n.y,n.width,n.height),o.clip()}},drawRectangle:function(n,r,o){if(this.useCanvas){var s=this._getContext(o);s.save(),s.fillStyle=r,s.fillRect(n.x,n.y,n.width,n.height),s.restore()}},blendSketch:function(n,r,o,s){var a=n;if(e.isPlainObject(a)||(a={opacity:n,scale:r,translate:o,compositeOperation:s}),!(!this.useCanvas||!this.sketchCanvas)){n=a.opacity,s=a.compositeOperation;var l=a.bounds;if(this.context.save(),this.context.globalAlpha=n,s&&(this.context.globalCompositeOperation=s),l)l.x<0&&(l.width+=l.x,l.x=0),l.x+l.width>this.canvas.width&&(l.width=this.canvas.width-l.x),l.y<0&&(l.height+=l.y,l.y=0),l.y+l.height>this.canvas.height&&(l.height=this.canvas.height-l.y),this.context.drawImage(this.sketchCanvas,l.x,l.y,l.width,l.height,l.x,l.y,l.width,l.height);else{r=a.scale||1,o=a.translate;var u=o instanceof e.Point?o:new e.Point(0,0),c=0,h=0;if(o){var d=this.sketchCanvas.width-this.canvas.width,g=this.sketchCanvas.height-this.canvas.height;c=Math.round(d/2),h=Math.round(g/2)}this.context.drawImage(this.sketchCanvas,u.x-c*r,u.y-h*r,(this.canvas.width+2*c)*r,(this.canvas.height+2*h)*r,-c,-h,this.canvas.width+2*c,this.canvas.height+2*h)}this.context.restore()}},drawDebugInfo:function(n,r,o,s){if(this.useCanvas){var a=this.viewer.world.getIndexOfItem(s)%this.debugGridColor.length,l=this.context;l.save(),l.lineWidth=2*e.pixelDensityRatio,l.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",l.strokeStyle=this.debugGridColor[a],l.fillStyle=this.debugGridColor[a],this.viewport.degrees!==0&&this._offsetForRotation({degrees:this.viewport.degrees}),s.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:s.getRotation(!0),point:s.viewport.pixelFromPointNoRotate(s._getRotationPoint(!0),!0)}),s.viewport.degrees===0&&s.getRotation(!0)%360===0&&s._drawer.viewer.viewport.getFlip()&&s._drawer._flip(),l.strokeRect(n.position.x*e.pixelDensityRatio,n.position.y*e.pixelDensityRatio,n.size.x*e.pixelDensityRatio,n.size.y*e.pixelDensityRatio);var u=(n.position.x+n.size.x/2)*e.pixelDensityRatio,c=(n.position.y+n.size.y/2)*e.pixelDensityRatio;l.translate(u,c),l.rotate(Math.PI/180*-this.viewport.degrees),l.translate(-u,-c),n.x===0&&n.y===0&&(l.fillText("Zoom: "+this.viewport.getZoom(),n.position.x*e.pixelDensityRatio,(n.position.y-30)*e.pixelDensityRatio),l.fillText("Pan: "+this.viewport.getBounds().toString(),n.position.x*e.pixelDensityRatio,(n.position.y-20)*e.pixelDensityRatio)),l.fillText("Level: "+n.level,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+20)*e.pixelDensityRatio),l.fillText("Column: "+n.x,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+30)*e.pixelDensityRatio),l.fillText("Row: "+n.y,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+40)*e.pixelDensityRatio),l.fillText("Order: "+o+" of "+r,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+50)*e.pixelDensityRatio),l.fillText("Size: "+n.size.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+60)*e.pixelDensityRatio),l.fillText("Position: "+n.position.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+70)*e.pixelDensityRatio),this.viewport.degrees!==0&&this._restoreRotationChanges(),s.getRotation(!0)%360!==0&&this._restoreRotationChanges(),s.viewport.degrees===0&&s.getRotation(!0)%360===0&&s._drawer.viewer.viewport.getFlip()&&s._drawer._flip(),l.restore()}},debugRect:function(n){if(this.useCanvas){var r=this.context;r.save(),r.lineWidth=2*e.pixelDensityRatio,r.strokeStyle=this.debugGridColor[0],r.fillStyle=this.debugGridColor[0],r.strokeRect(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio,n.width*e.pixelDensityRatio,n.height*e.pixelDensityRatio),r.restore()}},setImageSmoothingEnabled:function(n){this.useCanvas&&(this._imageSmoothingEnabled=n,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(n){n.msImageSmoothingEnabled=this._imageSmoothingEnabled,n.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(n){var r=this._getContext(n).canvas;return new e.Point(r.width,r.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(n){var r=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),o=this._getContext(n.useSketch);o.save(),o.translate(r.x,r.y),this.viewer.viewport.flipped?(o.rotate(Math.PI/180*-n.degrees),o.scale(-1,1)):o.rotate(Math.PI/180*n.degrees),o.translate(-r.x,-r.y)},_flip:function(n){n=n||{};var r=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),o=this._getContext(n.useSketch);o.translate(r.x,0),o.scale(-1,1),o.translate(-r.x,0)},_restoreRotationChanges:function(n){var r=this._getContext(n);r.restore()},_calculateCanvasSize:function(){var n=e.pixelDensityRatio,r=this.viewport.getContainerSize();return{x:Math.round(r.x*n),y:Math.round(r.y*n)}},_calculateSketchCanvasSize:function(){var n=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return n;var r=Math.ceil(Math.sqrt(n.x*n.x+n.y*n.y));return{x:r,y:r}}}}(i),function(e){e.Viewport=function(n){var r=arguments;r.length&&r[0]instanceof e.Point&&(n={containerSize:r[0],contentSize:r[1],config:r[2]}),n.config&&(e.extend(!0,n,n.config),delete n.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n.margins||{}),delete n.margins,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer},n),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(n){return e.console.assert(n,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(n instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(n.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(n.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,n.y/n.x),n.x),this},setHomeBounds:function(n,r){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(n,r)},_setContentBounds:function(n,r){e.console.assert(n,"[Viewport._setContentBounds] bounds is required"),e.console.assert(n instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(n.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(n.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=n.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(r),this._contentBounds=n.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(r),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:r,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var n=this._contentAspectRatio/this.getAspectRatio(),r;return this.homeFillsViewer?r=n>=1?n:1:r=n>=1?1:n,r/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var n=this._contentBounds.getCenter(),r=1/this.getHomeZoom(),o=r/this.getAspectRatio();return new e.Rect(n.x-r/2,n.y-o/2,r,o)},goHome:function(n){return this.viewer&&this.viewer.raiseEvent("home",{immediately:n}),this.fitBounds(this.getHomeBounds(),n)},getMinZoom:function(){var n=this.getHomeZoom(),r=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*n;return r},getMaxZoom:function(){var n=this.maxZoomLevel;return n||(n=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,n/=this._contentBounds.width),Math.max(n,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(n){e.console.assert(e.type(n)==="object","[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(n){return this.getBoundsNoRotate(n).rotate(-this.getRotation())},getBoundsNoRotate:function(n){var r=this.getCenter(n),o=1/this.getZoom(n),s=o/this.getAspectRatio();return new e.Rect(r.x-o/2,r.y-s/2,o,s)},getBoundsWithMargins:function(n){return this.getBoundsNoRotateWithMargins(n).rotate(-this.getRotation(),this.getCenter(n))},getBoundsNoRotateWithMargins:function(n){var r=this.getBoundsNoRotate(n),o=this._containerInnerSize.x*this.getZoom(n);return r.x-=this._margins.left/o,r.y-=this._margins.top/o,r.width+=(this._margins.left+this._margins.right)/o,r.height+=(this._margins.top+this._margins.bottom)/o,r},getCenter:function(n){var r=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),o=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),s,a,l,u,c,h,d,g;return n?r:this.zoomPoint?(s=this.pixelFromPoint(this.zoomPoint,!0),a=this.getZoom(),l=1/a,u=l/this.getAspectRatio(),c=new e.Rect(r.x-l/2,r.y-u/2,l,u),h=this._pixelFromPoint(this.zoomPoint,c),d=h.minus(s),g=d.divide(this._containerInnerSize.x*a),o.plus(g)):o},getZoom:function(n){return n?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(n){return Math.max(Math.min(n,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(n){var r=new e.Rect(n.x,n.y,n.width,n.height);if(!this.wrapHorizontal){var o=this.visibilityRatio*r.width,s=r.x+r.width,a=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,l=this._contentBoundsNoRotate.x-s+o,u=a-r.x-o;o>this._contentBoundsNoRotate.width?r.x+=(l+u)/2:u<0?r.x+=u:l>0&&(r.x+=l)}if(!this.wrapVertical){var c=this.visibilityRatio*r.height,h=r.y+r.height,d=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,g=this._contentBoundsNoRotate.y-h+c,y=d-r.y-c;c>this._contentBoundsNoRotate.height?r.y+=(g+y)/2:y<0?r.y+=y:g>0&&(r.y+=g)}return r},_raiseConstraintsEvent:function(n){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:n})},applyConstraints:function(n){var r=this.getZoom(),o=this._applyZoomConstraints(r);r!==o&&this.zoomTo(o,this.zoomPoint,n);var s=this.getBoundsNoRotate(),a=this._applyBoundaryConstraints(s);return this._raiseConstraintsEvent(n),(s.x!==a.x||s.y!==a.y||n)&&this.fitBounds(a.rotate(-this.getRotation()),n),this},ensureVisible:function(n){return this.applyConstraints(n)},_fitBounds:function(n,r){r=r||{};var o=r.immediately||!1,s=r.constraints||!1,a=this.getAspectRatio(),l=n.getCenter(),u=new e.Rect(n.x,n.y,n.width,n.height,n.degrees+this.getRotation()).getBoundingBox();u.getAspectRatio()>=a?u.height=u.width/a:u.width=u.height*a,u.x=l.x-u.width/2,u.y=l.y-u.height/2;var c=1/u.width;if(s){var h=u.getAspectRatio(),d=this._applyZoomConstraints(c);c!==d&&(c=d,u.width=1/c,u.x=l.x-u.width/2,u.height=u.width/h,u.y=l.y-u.height/2),u=this._applyBoundaryConstraints(u),l=u.getCenter(),this._raiseConstraintsEvent(o)}if(o)return this.panTo(l,!0),this.zoomTo(c,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var g=this.getBounds(),y=this.getZoom();if(y===0||Math.abs(c/y-1)<1e-8)return this.zoomTo(c,!0),this.panTo(l,o);u=u.rotate(-this.getRotation());var S=u.getTopLeft().times(c).minus(g.getTopLeft().times(y)).divide(c-y);return this.zoomTo(c,S,o)},fitBounds:function(n,r){return this._fitBounds(n,{immediately:r,constraints:!1})},fitBoundsWithConstraints:function(n,r){return this._fitBounds(n,{immediately:r,constraints:!0})},fitVertically:function(n){var r=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(r,n)},fitHorizontally:function(n){var r=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(r,n)},getConstrainedBounds:function(n){var r,o;return r=this.getBounds(n),o=this._applyBoundaryConstraints(r),o},panBy:function(n,r){var o=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(o.plus(n),r)},panTo:function(n,r){return r?(this.centerSpringX.resetTo(n.x),this.centerSpringY.resetTo(n.y)):(this.centerSpringX.springTo(n.x),this.centerSpringY.springTo(n.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:n,immediately:r}),this},zoomBy:function(n,r,o){return this.zoomTo(this.zoomSpring.target.value*n,r,o)},zoomTo:function(n,r,o){var s=this;return this.zoomPoint=r instanceof e.Point&&!isNaN(r.x)&&!isNaN(r.y)?r:null,o?this._adjustCenterSpringsForZoomPoint(function(){s.zoomSpring.resetTo(n)}):this.zoomSpring.springTo(n),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:n,refPoint:r,immediately:o}),this},setRotation:function(n){return!this.viewer||!this.viewer.drawer.canRotate()?this:(this.degrees=e.positiveModulo(n,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:n}),this)},getRotation:function(){return this.degrees},resize:function(n,r){var o=this.getBoundsNoRotate(),s=o,a;return this.containerSize.x=n.x,this.containerSize.y=n.y,this._updateContainerInnerSize(),r&&(a=n.x/this.containerSize.x,s.width=o.width*a,s.height=s.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:n,maintain:r}),this.fitBounds(s,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var n=this;this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var r=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,r},_adjustCenterSpringsForZoomPoint:function(n){if(this.zoomPoint){var r=this.pixelFromPoint(this.zoomPoint,!0);n();var o=this.pixelFromPoint(this.zoomPoint,!0),s=o.minus(r),a=this.deltaPointsFromPixels(s,!0);this.centerSpringX.shiftBy(a.x),this.centerSpringY.shiftBy(a.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else n()},deltaPixelsFromPointsNoRotate:function(n,r){return n.times(this._containerInnerSize.x*this.getZoom(r))},deltaPixelsFromPoints:function(n,r){return this.deltaPixelsFromPointsNoRotate(n.rotate(this.getRotation()),r)},deltaPointsFromPixelsNoRotate:function(n,r){return n.divide(this._containerInnerSize.x*this.getZoom(r))},deltaPointsFromPixels:function(n,r){return this.deltaPointsFromPixelsNoRotate(n,r).rotate(-this.getRotation())},pixelFromPointNoRotate:function(n,r){return this._pixelFromPointNoRotate(n,this.getBoundsNoRotate(r))},pixelFromPoint:function(n,r){return this._pixelFromPoint(n,this.getBoundsNoRotate(r))},_pixelFromPointNoRotate:function(n,r){return n.minus(r.getTopLeft()).times(this._containerInnerSize.x/r.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(n,r){return this._pixelFromPointNoRotate(n.rotate(this.getRotation(),this.getCenter(!0)),r)},pointFromPixelNoRotate:function(n,r){var o=this.getBoundsNoRotate(r);return n.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/o.width).plus(o.getTopLeft())},pointFromPixel:function(n,r){return this.pointFromPixelNoRotate(n,r).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(n,r){var o=this._contentBoundsNoRotate.width;return new e.Point(n*this._contentSizeNoRotate.x/o,r*this._contentSizeNoRotate.x/o)},viewportToImageCoordinates:function(n,r){if(n instanceof e.Point)return this.viewportToImageCoordinates(n.x,n.y);if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(o===1){var s=this.viewer.world.getItemAt(0);return s.viewportToImageCoordinates(n,r,!0)}}return this._viewportToImageDelta(n-this._contentBoundsNoRotate.x,r-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(n,r){var o=this._contentBoundsNoRotate.width;return new e.Point(n/this._contentSizeNoRotate.x*o,r/this._contentSizeNoRotate.x*o)},imageToViewportCoordinates:function(n,r){if(n instanceof e.Point)return this.imageToViewportCoordinates(n.x,n.y);if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(o===1){var s=this.viewer.world.getItemAt(0);return s.imageToViewportCoordinates(n,r,!0)}}var a=this._imageToViewportDelta(n,r);return a.x+=this._contentBoundsNoRotate.x,a.y+=this._contentBoundsNoRotate.y,a},imageToViewportRectangle:function(n,r,o,s){var a=n;if(a instanceof e.Rect||(a=new e.Rect(n,r,o,s)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.imageToViewportRectangle(n,r,o,s,!0)}}var c=this.imageToViewportCoordinates(a.x,a.y),h=this._imageToViewportDelta(a.width,a.height);return new e.Rect(c.x,c.y,h.x,h.y,a.degrees)},viewportToImageRectangle:function(n,r,o,s){var a=n;if(a instanceof e.Rect||(a=new e.Rect(n,r,o,s)),this.viewer){var l=this.viewer.world.getItemCount();if(l>1)e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(l===1){var u=this.viewer.world.getItemAt(0);return u.viewportToImageRectangle(n,r,o,s,!0)}}var c=this.viewportToImageCoordinates(a.x,a.y),h=this._viewportToImageDelta(a.width,a.height);return new e.Rect(c.x,c.y,h.x,h.y,a.degrees)},viewerElementToImageCoordinates:function(n){var r=this.pointFromPixel(n,!0);return this.viewportToImageCoordinates(r)},imageToViewerElementCoordinates:function(n){var r=this.imageToViewportCoordinates(n);return this.pixelFromPoint(r,!0)},windowToImageCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var r=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(r)},imageToWindowCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var r=this.imageToViewerElementCoordinates(n);return r.plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(n){return this.pointFromPixel(n,!0)},viewportToViewerElementCoordinates:function(n){return this.pixelFromPoint(n,!0)},viewerElementToViewportRectangle:function(n){return e.Rect.fromSummits(this.pointFromPixel(n.getTopLeft(),!0),this.pointFromPixel(n.getTopRight(),!0),this.pointFromPixel(n.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(n){return e.Rect.fromSummits(this.pixelFromPoint(n.getTopLeft(),!0),this.pixelFromPoint(n.getTopRight(),!0),this.pixelFromPoint(n.getBottomLeft(),!0))},windowToViewportCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var r=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(r)},viewportToWindowCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var r=this.viewportToViewerElementCoordinates(n);return r.plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(n){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(r===1){var o=this.viewer.world.getItemAt(0);return o.viewportToImageZoom(n)}}var s=this._contentSizeNoRotate.x,a=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=a/s*l;return n*u},imageToViewportZoom:function(n){if(this.viewer){var r=this.viewer.world.getItemCount();if(r>1)e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(r===1){var o=this.viewer.world.getItemAt(0);return o.imageToViewportZoom(n)}}var s=this._contentSizeNoRotate.x,a=this._containerInnerSize.x,l=this._contentBoundsNoRotate.width,u=s/a/l;return n*u},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(n){return this.flipped===n?this:(this.flipped=n,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:n}),this)}}}(i),function(e){e.TiledImage=function(p){var x=this;e.console.assert(p.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(p.drawer,"[TiledImage] options.drawer is required"),e.console.assert(p.viewer,"[TiledImage] options.viewer is required"),e.console.assert(p.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(p.source,"[TiledImage] options.source is required"),e.console.assert(!p.clip||p.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=p.tileCache,delete p.tileCache,this._drawer=p.drawer,delete p.drawer,this._imageLoader=p.imageLoader,delete p.imageLoader,p.clip instanceof e.Rect&&(this._clip=p.clip.clone()),delete p.clip;var A=p.x||0;delete p.x;var P=p.y||0;delete p.y,this.normHeight=p.source.dimensions.y/p.source.dimensions.x,this.contentAspectX=p.source.dimensions.x/p.source.dimensions.y;var D=1;p.width?(D=p.width,delete p.width,p.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete p.height)):p.height&&(D=p.height/this.normHeight,delete p.height);var O=p.fitBounds;delete p.fitBounds;var I=p.fitBoundsPlacement||i.Placement.CENTER;delete p.fitBoundsPlacement;var N=p.degrees||0;delete p.degrees,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation},p),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:A,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:P,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:D,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:N,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),O&&this.fitBounds(O,I,!0),this._drawingHandler=function(W){x.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:x},W))}},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(p){p!==this._fullyLoaded&&(this._fullyLoaded=p,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var p=this._xSpring.update(),x=this._ySpring.update(),A=this._scaleSpring.update(),P=this._degreesSpring.update();return p||x||A||P?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(p){return this.getBoundsNoRotate(p).rotate(this.getRotation(p),this._getRotationPoint(p))},getBoundsNoRotate:function(p){return p?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(p){var x=this.getBoundsNoRotate(p);if(this._clip){var A=p?this._worldWidthCurrent:this._worldWidthTarget,P=A/this.source.dimensions.x,D=this._clip.times(P);x=new e.Rect(x.x+D.x,x.y+D.y,D.width,D.height)}return x.rotate(this.getRotation(p),this._getRotationPoint(p))},getTileBounds:function(p,x,A){var P=this.source.getNumTiles(p),D=(P.x+x%P.x)%P.x,O=(P.y+A%P.y)%P.y,I=this.source.getTileBounds(p,D,O);return this.getFlip()&&(I.x=1-I.x-I.width),I.x+=(x-D)/P.x,I.y+=this._worldHeightCurrent/this._worldWidthCurrent*((A-O)/P.y),I},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var p=this.imageToWindowCoordinates(new e.Point(0,0)),x=this.imageToWindowCoordinates(this.getContentSize());return new e.Point(x.x-p.x,x.y-p.y)},_viewportToImageDelta:function(p,x,A){var P=A?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(p*(this.source.dimensions.x/P),x*(this.source.dimensions.y*this.contentAspectX/P))},viewportToImageCoordinates:function(p,x,A){var P;return p instanceof e.Point?(A=x,P=p):P=new e.Point(p,x),P=P.rotate(-this.getRotation(A),this._getRotationPoint(A)),A?this._viewportToImageDelta(P.x-this._xSpring.current.value,P.y-this._ySpring.current.value):this._viewportToImageDelta(P.x-this._xSpring.target.value,P.y-this._ySpring.target.value)},_imageToViewportDelta:function(p,x,A){var P=A?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(p/this.source.dimensions.x*P,x/this.source.dimensions.y/this.contentAspectX*P)},imageToViewportCoordinates:function(p,x,A){p instanceof e.Point&&(A=x,x=p.y,p=p.x);var P=this._imageToViewportDelta(p,x);return A?(P.x+=this._xSpring.current.value,P.y+=this._ySpring.current.value):(P.x+=this._xSpring.target.value,P.y+=this._ySpring.target.value),P.rotate(this.getRotation(A),this._getRotationPoint(A))},imageToViewportRectangle:function(p,x,A,P,D){var O=p;O instanceof e.Rect?D=x:O=new e.Rect(p,x,A,P);var I=this.imageToViewportCoordinates(O.getTopLeft(),D),N=this._imageToViewportDelta(O.width,O.height,D);return new e.Rect(I.x,I.y,N.x,N.y,O.degrees+this.getRotation(D))},viewportToImageRectangle:function(p,x,A,P,D){var O=p;p instanceof e.Rect?D=x:O=new e.Rect(p,x,A,P);var I=this.viewportToImageCoordinates(O.getTopLeft(),D),N=this._viewportToImageDelta(O.width,O.height,D);return new e.Rect(I.x,I.y,N.x,N.y,O.degrees-this.getRotation(D))},viewerElementToImageCoordinates:function(p){var x=this.viewport.pointFromPixel(p,!0);return this.viewportToImageCoordinates(x)},imageToViewerElementCoordinates:function(p){var x=this.imageToViewportCoordinates(p);return this.viewport.pixelFromPoint(x,!0)},windowToImageCoordinates:function(p){var x=p.minus(i.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(x)},imageToWindowCoordinates:function(p){var x=this.imageToViewerElementCoordinates(p);return x.plus(i.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(p){var x=this._scaleSpring.current.value;return p=p.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((p.x-this._xSpring.current.value)/x,(p.y-this._ySpring.current.value)/x,p.width/x,p.height/x,p.degrees)},viewportToImageZoom:function(p){var x=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return x*p},imageToViewportZoom:function(p){var x=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return p/x},setPosition:function(p,x){var A=this._xSpring.target.value===p.x&&this._ySpring.target.value===p.y;if(x){if(A&&this._xSpring.current.value===p.x&&this._ySpring.current.value===p.y)return;this._xSpring.resetTo(p.x),this._ySpring.resetTo(p.y),this._needsDraw=!0}else{if(A)return;this._xSpring.springTo(p.x),this._ySpring.springTo(p.y),this._needsDraw=!0}A||this._raiseBoundsChange()},setWidth:function(p,x){this._setScale(p,x)},setHeight:function(p,x){this._setScale(p/this.normHeight,x)},setCroppingPolygons:function(p){var x=function(P){return P instanceof e.Point||typeof P.x=="number"&&typeof P.y=="number"},A=function(P){return P.map(function(D){try{if(x(D))return{x:D.x,y:D.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!e.isArray(p))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=p.map(function(P){return A(P)})}catch(P){e.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),e.console.error(P),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(p,x,A){x=x||e.Placement.CENTER;var P=e.Placement.properties[x],D=this.contentAspectX,O=0,I=0,N=1,W=1;if(this._clip&&(D=this._clip.getAspectRatio(),N=this._clip.width/this.source.dimensions.x,W=this._clip.height/this.source.dimensions.y,p.getAspectRatio()>D?(O=this._clip.x/this._clip.height*p.height,I=this._clip.y/this._clip.height*p.height):(O=this._clip.x/this._clip.width*p.width,I=this._clip.y/this._clip.width*p.width)),p.getAspectRatio()>D){var q=p.height/W,G=0;P.isHorizontallyCentered?G=(p.width-p.height*D)/2:P.isRight&&(G=p.width-p.height*D),this.setPosition(new e.Point(p.x-O+G,p.y-I),A),this.setHeight(q,A)}else{var J=p.width/N,K=0;P.isVerticallyCentered?K=(p.height-p.width/D)/2:P.isBottom&&(K=p.height-p.width/D),this.setPosition(new e.Point(p.x-O,p.y-I+K),A),this.setWidth(J,A)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(p){e.console.assert(!p||p instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),p instanceof e.Rect?this._clip=p.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(p){this.flipped=!!p,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(p){p!==this.opacity&&(this.opacity=p,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(p){this._preload=!!p,this._needsDraw=!0},getRotation:function(p){return p?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(p,x){this._degreesSpring.target.value===p&&this._degreesSpring.isAtTargetValue()||(x?this._degreesSpring.resetTo(p):this._degreesSpring.springTo(p),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(p){return this.getBoundsNoRotate(p).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(p){p!==this.compositeOperation&&(this.compositeOperation=p,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(p,x){var A=this._scaleSpring.target.value===p;if(x){if(A&&this._scaleSpring.current.value===p)return;this._scaleSpring.resetTo(p),this._updateForScale(),this._needsDraw=!0}else{if(A)return;this._scaleSpring.springTo(p),this._updateForScale(),this._needsDraw=!0}A||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var p=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),x=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,A=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(x/this.minPixelRatio)/Math.log(2))));return A=Math.max(A,this.source.minLevel||0),p=Math.min(p,A),{lowestLevel:p,highestLevel:A}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var p=this.lastDrawn.pop();p.beingDrawn=!1}var x=this.viewport,A=this._viewportToTiledImageRectangle(x.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var P=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(A=A.intersection(P),A===null)return}for(var D=this._getLevelsInterval(),O=D.lowestLevel,I=D.highestLevel,N=null,W=!1,q=e.now(),G=I;G>=O;G--){var J=!1,K=x.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(G),!0).x*this._scaleSpring.current.value;if(G===O||!W&&K>=this.minPixelRatio)J=!0,W=!0;else if(!W)continue;var oe=x.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(G),!1).x*this._scaleSpring.current.value,re=x.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,ae=this.immediateRender?1:re,pe=Math.min(1,(K-.5)/.5),Ee=ae/Math.abs(ae-oe);if(N=n(this,W,J,G,pe,Ee,A,q,N),h(this.coverage,G))break}E(this,this.lastDrawn),N&&!N.context2D?(s(this,N,q),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(p,x,A){var P,D;this.wrapHorizontal?(P=e.positiveModulo(x.x,1),D=e.positiveModulo(A.x,1)):(P=Math.max(0,x.x),D=Math.min(1,A.x));var O,I,N=1/this.source.aspectRatio;this.wrapVertical?(O=e.positiveModulo(x.y,N),I=e.positiveModulo(A.y,N)):(O=Math.max(0,x.y),I=Math.min(N,A.y));var W=this.source.getTileAtPoint(p,new e.Point(P,O)),q=this.source.getTileAtPoint(p,new e.Point(D,I)),G=this.source.getNumTiles(p);return this.wrapHorizontal&&(W.x+=G.x*Math.floor(x.x),q.x+=G.x*Math.floor(A.x)),this.wrapVertical&&(W.y+=G.y*Math.floor(x.y/N),q.y+=G.y*Math.floor(A.y/N)),{topLeft:W,bottomRight:q}}});function n(p,x,A,P,D,O,I,N,W){var q=I.getBoundingBox().getTopLeft(),G=I.getBoundingBox().getBottomRight();p.viewer&&p.viewer.raiseEvent("update-level",{tiledImage:p,havedrawn:x,level:P,opacity:D,visibility:O,drawArea:I,topleft:q,bottomright:G,currenttime:N,best:W}),y(p.coverage,P),y(p.loadingCoverage,P);var J=p._getCornerTiles(P,q,G),K=J.topLeft,oe=J.bottomRight,re=p.source.getNumTiles(P),ae=p.viewport.pixelFromPoint(p.viewport.getCenter());p.getFlip()&&(oe.x+=1,p.wrapHorizontal||(oe.x=Math.min(oe.x,re.x-1)));for(var pe=K.x;pe<=oe.x;pe++)for(var Ee=K.y;Ee<=oe.y;Ee++){var $;if(p.getFlip()){var le=(re.x+pe%re.x)%re.x;$=pe+re.x-le-le-1}else $=pe;I.intersection(p.getTileBounds(P,$,Ee))!==null&&(W=r(p,A,x,$,Ee,P,D,O,ae,re,N,W))}return W}function r(p,x,A,P,D,O,I,N,W,q,G,J){var K=o(P,D,O,p,p.source,p.tilesMatrix,G,q,p._worldWidthCurrent,p._worldHeightCurrent),oe=A;p.viewer&&p.viewer.raiseEvent("update-tile",{tiledImage:p,tile:K}),g(p.coverage,O,P,D,!1);var re=K.loaded||K.loading||d(p.loadingCoverage,O,P,D);if(g(p.loadingCoverage,O,P,D,re),!K.exists||(x&&!oe&&(d(p.coverage,O,P,D)?g(p.coverage,O,P,D,!0):oe=!0),!oe))return J;if(u(K,p.source.tileOverlap,p.viewport,W,N,p),!K.loaded)if(K.context2D)l(p,K);else{var ae=p._tileCache.getImageRecord(K.cacheKey);if(ae){var pe=ae.getImage();l(p,K,pe)}}if(K.loaded){var Ee=c(p,K,P,D,O,I,G);Ee&&(p._needsDraw=!0)}else K.loading?p._tilesLoading++:re||(J=S(J,K));return J}function o(p,x,A,P,D,O,I,N,W,q){var G,J,K,oe,re,ae,pe,Ee,$;return O[A]||(O[A]={}),O[A][p]||(O[A][p]={}),(!O[A][p][x]||!O[A][p][x].flipped!=!P.flipped)&&(G=(N.x+p%N.x)%N.x,J=(N.y+x%N.y)%N.y,K=P.getTileBounds(A,p,x),oe=D.getTileBounds(A,G,J,!0),re=D.tileExists(A,G,J),ae=D.getTileUrl(A,G,J),P.loadTilesWithAjax?(pe=D.getTileAjaxHeaders(A,G,J),e.isPlainObject(P.ajaxHeaders)&&(pe=e.extend({},P.ajaxHeaders,pe))):pe=null,Ee=D.getContext2D?D.getContext2D(A,G,J):void 0,$=new e.Tile(A,p,x,K,re,ae,Ee,P.loadTilesWithAjax,pe,oe),P.getFlip()?G===0&&($.isRightMost=!0):G===N.x-1&&($.isRightMost=!0),J===N.y-1&&($.isBottomMost=!0),$.flipped=P.flipped,O[A][p][x]=$),$=O[A][p][x],$.lastTouchTime=I,$}function s(p,x,A){x.loading=!0,p._imageLoader.addJob({src:x.url,loadWithAjax:x.loadWithAjax,ajaxHeaders:x.ajaxHeaders,crossOriginPolicy:p.crossOriginPolicy,ajaxWithCredentials:p.ajaxWithCredentials,callback:function(P,D,O){a(p,x,A,P,D,O)},abort:function(){x.loading=!1}})}function a(p,x,A,P,D,O){if(!P){e.console.log("Tile %s failed to load: %s - error: %s",x,x.url,D),p.viewer.raiseEvent("tile-load-failed",{tile:x,tiledImage:p,time:A,message:D,tileRequest:O}),x.loading=!1,x.exists=!1;return}if(A<p.lastResetTime){e.console.log("Ignoring tile %s loaded before reset: %s",x,x.url),x.loading=!1;return}var I=function(){var N=p.source.getClosestLevel();l(p,x,P,N,O)};p._midDraw?window.setTimeout(I,1):I()}function l(p,x,A,P,D){var O=0;function I(){return O++,N}function N(){O--,O===0&&(x.loading=!1,x.loaded=!0,x.context2D||p._tileCache.cacheTile({image:A,tile:x,cutoff:P,tiledImage:p}),p._needsDraw=!0)}p.viewer.raiseEvent("tile-loaded",{tile:x,tiledImage:p,tileRequest:D,image:A,getCompletionCallback:I}),I()()}function u(p,x,A,P,D,O){var I=p.bounds.getTopLeft();I.x*=O._scaleSpring.current.value,I.y*=O._scaleSpring.current.value,I.x+=O._xSpring.current.value,I.y+=O._ySpring.current.value;var N=p.bounds.getSize();N.x*=O._scaleSpring.current.value,N.y*=O._scaleSpring.current.value;var W=A.pixelFromPointNoRotate(I,!0),q=A.pixelFromPointNoRotate(I,!1),G=A.deltaPixelsFromPointsNoRotate(N,!0),J=A.deltaPixelsFromPointsNoRotate(N,!1),K=q.plus(J.divide(2)),oe=P.squaredDistanceTo(K);x||(G=G.plus(new e.Point(1,1))),p.isRightMost&&O.wrapHorizontal&&(G.x+=.75),p.isBottomMost&&O.wrapVertical&&(G.y+=.75),p.position=W,p.size=G,p.squaredDistance=oe,p.visibility=D}function c(p,x,A,P,D,O,I){var N=1e3*p.blendTime,W,q;if(x.blendStart||(x.blendStart=I),W=I-x.blendStart,q=N?Math.min(1,W/N):1,p.alwaysBlend&&(q*=O),x.opacity=q,p.lastDrawn.push(x),q===1)g(p.coverage,D,A,P,!0),p._hasOpaqueTile=!0;else if(W<N)return!0;return!1}function h(p,x,A,P){var D,O,I,N;if(!p[x])return!1;if(A===void 0||P===void 0){D=p[x];for(I in D)if(Object.prototype.hasOwnProperty.call(D,I)){O=D[I];for(N in O)if(Object.prototype.hasOwnProperty.call(O,N)&&!O[N])return!1}return!0}return p[x][A]===void 0||p[x][A][P]===void 0||p[x][A][P]===!0}function d(p,x,A,P){return A===void 0||P===void 0?h(p,x+1):h(p,x+1,2*A,2*P)&&h(p,x+1,2*A,2*P+1)&&h(p,x+1,2*A+1,2*P)&&h(p,x+1,2*A+1,2*P+1)}function g(p,x,A,P,D){if(!p[x]){e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",x);return}p[x][A]||(p[x][A]={}),p[x][A][P]=D}function y(p,x){p[x]={}}function S(p,x){return!p||x.visibility>p.visibility||x.visibility===p.visibility&&x.squaredDistance<p.squaredDistance?x:p}function E(p,x){if(!(p.opacity===0||x.length===0&&!p.placeholderFillStyle)){var A=x[0],P;A&&(P=p.opacity<1||p.compositeOperation&&p.compositeOperation!=="source-over"||!p._isBottomItem()&&A._hasTransparencyChannel());var D,O,I=p.viewport.getZoom(!0),N=p.viewportToImageZoom(I);x.length>1&&N>p.smoothTileEdgesMinZoom&&!p.iOSDevice&&p.getRotation(!0)%360===0&&e.supportsCanvas&&(P=!0,D=A.getScaleForEdgeSmoothing(),O=A.getTranslationForEdgeSmoothing(D,p._drawer.getCanvasSize(!1),p._drawer.getCanvasSize(!0)));var W;P&&(D||(W=p.viewport.viewportToViewerElementRectangle(p.getClippedBounds(!0)).getIntegerBoundingBox(),p._drawer.viewer.viewport.getFlip()&&(p.viewport.degrees!==0||p.getRotation(!0)%360!==0)&&(W.x=p._drawer.viewer.container.clientWidth-(W.x+W.width)),W=W.times(e.pixelDensityRatio)),p._drawer._clear(!0,W)),D||(p.viewport.degrees!==0&&p._drawer._offsetForRotation({degrees:p.viewport.degrees,useSketch:P}),p.getRotation(!0)%360!==0&&p._drawer._offsetForRotation({degrees:p.getRotation(!0),point:p.viewport.pixelFromPointNoRotate(p._getRotationPoint(!0),!0),useSketch:P}),p.viewport.degrees===0&&p.getRotation(!0)%360===0&&p._drawer.viewer.viewport.getFlip()&&p._drawer._flip());var q=!1;if(p._clip){p._drawer.saveContext(P);var G=p.imageToViewportRectangle(p._clip,!0);G=G.rotate(-p.getRotation(!0),p._getRotationPoint(!0));var J=p._drawer.viewportToDrawerRectangle(G);D&&(J=J.times(D)),O&&(J=J.translate(O)),p._drawer.setClip(J,P),q=!0}if(p._croppingPolygons){p._drawer.saveContext(P);try{var K=p._croppingPolygons.map(function(pe){return pe.map(function(Ee){var $=p.imageToViewportCoordinates(Ee.x,Ee.y,!0).rotate(-p.getRotation(!0),p._getRotationPoint(!0)),le=p._drawer.viewportCoordToDrawerCoord($);return D&&(le=le.times(D)),le})});p._drawer.clipWithPolygons(K,P)}catch(pe){e.console.error(pe)}q=!0}if(p.placeholderFillStyle&&p._hasOpaqueTile===!1){var oe=p._drawer.viewportToDrawerRectangle(p.getBounds(!0));D&&(oe=oe.times(D)),O&&(oe=oe.translate(O));var re=null;typeof p.placeholderFillStyle=="function"?re=p.placeholderFillStyle(p,p._drawer.context):re=p.placeholderFillStyle,p._drawer.drawRectangle(oe,re,P)}for(var ae=x.length-1;ae>=0;ae--)A=x[ae],p._drawer.drawTile(A,p._drawingHandler,P,D,O),A.beingDrawn=!0,p.viewer&&p.viewer.raiseEvent("tile-drawn",{tiledImage:p,tile:A});q&&p._drawer.restoreContext(P),D||(p.getRotation(!0)%360!==0&&p._drawer._restoreRotationChanges(P),p.viewport.degrees!==0&&p._drawer._restoreRotationChanges(P)),P&&(D&&(p.viewport.degrees!==0&&p._drawer._offsetForRotation({degrees:p.viewport.degrees,useSketch:!1}),p.getRotation(!0)%360!==0&&p._drawer._offsetForRotation({degrees:p.getRotation(!0),point:p.viewport.pixelFromPointNoRotate(p._getRotationPoint(!0),!0),useSketch:!1})),p._drawer.blendSketch({opacity:p.opacity,scale:D,translate:O,compositeOperation:p.compositeOperation,bounds:W}),D&&(p.getRotation(!0)%360!==0&&p._drawer._restoreRotationChanges(!1),p.viewport.degrees!==0&&p._drawer._restoreRotationChanges(!1))),D||p.viewport.degrees===0&&p.getRotation(!0)%360===0&&p._drawer.viewer.viewport.getFlip()&&p._drawer._flip(),C(p,x)}}function C(p,x){if(p.debugMode)for(var A=x.length-1;A>=0;A--){var P=x[A];try{p._drawer.drawDebugInfo(P,x.length,A,p)}catch(D){e.console.error(D)}}}}(i),function(e){var n=function(o){e.console.assert(o,"[TileCache.cacheTile] options is required"),e.console.assert(o.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(o.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=o.tile,this.tiledImage=o.tiledImage},r=function(o){e.console.assert(o,"[ImageRecord] options is required"),e.console.assert(o.image,"[ImageRecord] options.image is required"),this._image=o.image,this._tiles=[]};r.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var o=document.createElement("canvas");o.width=this._image.width,o.height=this._image.height,this._renderedContext=o.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(o){e.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=o},addTile:function(o){e.console.assert(o,"[ImageRecord.addTile] tile is required"),this._tiles.push(o)},removeTile:function(o){for(var s=0;s<this._tiles.length;s++)if(this._tiles[s]===o){this._tiles.splice(s,1);return}e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",o)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(o){o=o||{},this._maxImageCacheCount=o.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(o){e.console.assert(o,"[TileCache.cacheTile] options is required"),e.console.assert(o.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(o.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(o.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var s=o.cutoff||0,a=this._tilesLoaded.length,l=this._imagesLoaded[o.tile.cacheKey];if(l||(e.console.assert(o.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),l=this._imagesLoaded[o.tile.cacheKey]=new r({image:o.image}),this._imagesLoadedCount++),l.addTile(o.tile),o.tile.cacheImageRecord=l,this._imagesLoadedCount>this._maxImageCacheCount){for(var u=null,c=-1,h=null,d,g,y,S,E,C,p=this._tilesLoaded.length-1;p>=0;p--)if(C=this._tilesLoaded[p],d=C.tile,!(d.level<=s||d.beingDrawn)){if(!u){u=d,c=p,h=C;continue}S=d.lastTouchTime,g=u.lastTouchTime,E=d.level,y=u.level,(S<g||S===g&&E>y)&&(u=d,c=p,h=C)}u&&c>=0&&(this._unloadTile(h),a=c)}this._tilesLoaded[a]=new n({tile:o.tile,tiledImage:o.tiledImage})},clearTilesFor:function(o){e.console.assert(o,"[TileCache.clearTilesFor] tiledImage is required");for(var s,a=0;a<this._tilesLoaded.length;++a)s=this._tilesLoaded[a],s.tiledImage===o&&(this._unloadTile(s),this._tilesLoaded.splice(a,1),a--)},getImageRecord:function(o){return e.console.assert(o,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[o]},_unloadTile:function(o){e.console.assert(o,"[TileCache._unloadTile] tileRecord is required");var s=o.tile,a=o.tiledImage;s.unload(),s.cacheImageRecord=null;var l=this._imagesLoaded[s.cacheKey];l.removeTile(s),l.getTileCount()||(l.destroy(),delete this._imagesLoaded[s.cacheKey],this._imagesLoadedCount--),a.viewer.raiseEvent("tile-unloaded",{tile:s,tiledImage:a})}}}(i),function(e){e.World=function(n){var r=this;e.console.assert(n.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=n.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(o){r._autoRefigureSizes?r._figureSizes():r._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(n,r){if(e.console.assert(n,"[World.addItem] item is required"),e.console.assert(n instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),r=r||{},r.index!==void 0){var o=Math.max(0,Math.min(this._items.length,r.index));this._items.splice(o,0,n)}else this._items.push(n);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,n.addHandler("bounds-change",this._delegatedFigureSizes),n.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:n})},getItemAt:function(n){return e.console.assert(n!==void 0,"[World.getItemAt] index is required"),this._items[n]},getIndexOfItem:function(n){return e.console.assert(n,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,n)},getItemCount:function(){return this._items.length},setItemIndex:function(n,r){e.console.assert(n,"[World.setItemIndex] item is required"),e.console.assert(r!==void 0,"[World.setItemIndex] index is required");var o=this.getIndexOfItem(n);if(r>=this._items.length)throw new Error("Index bigger than number of layers.");r===o||o===-1||(this._items.splice(o,1),this._items.splice(r,0,n),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:n,previousIndex:o,newIndex:r}))},removeItem:function(n){e.console.assert(n,"[World.removeItem] item is required");var r=e.indexOf(this._items,n);r!==-1&&(n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy(),this._items.splice(r,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(n))},removeAll:function(){this.viewer._cancelPendingImages();var n,r;for(r=0;r<this._items.length;r++)n=this._items[r],n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy();var o=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,r=0;r<o.length;r++)n=o[r],this._raiseRemoveItem(n)},resetItems:function(){for(var n=0;n<this._items.length;n++)this._items[n].reset()},update:function(){for(var n=!1,r=0;r<this._items.length;r++)n=this._items[r].update()||n;return n},draw:function(){for(var n=0;n<this._items.length;n++)this._items[n].draw();this._needsDraw=!1},needsDraw:function(){for(var n=0;n<this._items.length;n++)if(this._items[n].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(n){this._autoRefigureSizes=n,n&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(n){n=n||{};var r=n.immediately||!1,o=n.layout||e.DEFAULT_SETTINGS.collectionLayout,s=n.rows||e.DEFAULT_SETTINGS.collectionRows,a=n.columns||e.DEFAULT_SETTINGS.collectionColumns,l=n.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,u=n.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,c=l+u,h;!n.rows&&a?h=a:h=Math.ceil(this._items.length/s);var d=0,g=0,y,S,E,C,p;this.setAutoRefigureSizes(!1);for(var x=0;x<this._items.length;x++)x&&x%h===0&&(o==="horizontal"?(g+=c,d=0):(d+=c,g=0)),y=this._items[x],S=y.getBounds(),S.width>S.height?E=l:E=l*(S.width/S.height),C=E*(S.height/S.width),p=new e.Point(d+(l-E)/2,g+(l-C)/2),y.setPosition(p,r),y.setWidth(E,r),o==="horizontal"?d+=c:g+=c;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var n=this._homeBounds?this._homeBounds.clone():null,r=this._contentSize?this._contentSize.clone():null,o=this._contentFactor||0;if(!this._items.length)this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;else{var s=this._items[0],a=s.getBounds();this._contentFactor=s.getContentSize().x/a.width;for(var l=s.getClippedBounds().getBoundingBox(),u=l.x,c=l.y,h=l.x+l.width,d=l.y+l.height,g=1;g<this._items.length;g++)s=this._items[g],a=s.getBounds(),this._contentFactor=Math.max(this._contentFactor,s.getContentSize().x/a.width),l=s.getClippedBounds().getBoundingBox(),u=Math.min(u,l.x),c=Math.min(c,l.y),h=Math.max(h,l.x+l.width),d=Math.max(d,l.y+l.height);this._homeBounds=new e.Rect(u,c,h-u,d-c),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==o||!this._homeBounds.equals(n)||!this._contentSize.equals(r))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(n){this.raiseEvent("remove-item",{item:n})}})}(i)})(Nh);var Dt=Nh.exports;const ce="http://www.w3.org/2000/svg",os=t=>{const i=t.getAttribute("class");return i?new Set(i.split(" ")):new Set},xt=(t,i)=>{const e=os(t);e.add(i),t.setAttribute("class",Array.from(e).join(" "))},er=(t,i)=>{const e=os(t);e.delete(i),e.size===0?t.removeAttribute("class"):t.setAttribute("class",Array.from(e).join(" "))},ss=(t,i)=>os(t).has(i),Ot=(t,i)=>{const e=t.selector("FragmentSelector");if(e!=null&&e.conformsTo.startsWith("http://www.w3.org/TR/media-frags")){const{value:n}=e,r=n.includes(":")?n.substring(n.indexOf("=")+1,n.indexOf(":")):"pixel",o=n.includes(":")?n.substring(n.indexOf(":")+1):n.substring(n.indexOf("=")+1);let[s,a,l,u]=o.split(",").map(parseFloat);return r.toLowerCase()==="percent"&&(s=s*i.naturalWidth/100,a=a*i.naturalHeight/100,l=l*i.naturalWidth/100,u=u*i.naturalHeight/100),{x:s,y:a,w:l,h:u}}},Rb=(t,i,e,n,r)=>({source:r==null?void 0:r.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=pixel:${t},${i},${e},${n}`}}),kb=(t,i,e,n,r)=>{const o=t/r.naturalWidth*100,s=i/r.naturalHeight*100,a=e/r.naturalWidth*100,l=n/r.naturalHeight*100;return{source:r.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=percent:${o},${s},${a},${l}`}}},gn=(t,i,e,n,r,o)=>(o==null?void 0:o.toLowerCase())==="percent"?kb(t,i,e,n,r):Rb(t,i,e,n,r),tr=(t,i,e,n,r)=>{t.setAttribute("x",i),t.setAttribute("y",e),t.setAttribute("width",n),t.setAttribute("height",r)},nr=(t,i,e)=>{t.setAttribute("cx",i),t.setAttribute("cy",e),t.setAttribute("r",7)},zh=(t,i,e,n,r)=>{const o=document.createElementNS(ce,"path");o.setAttribute("fill-rule","evenodd");const{naturalWidth:s,naturalHeight:a}=t;return o.setAttribute("d",`M0 0 h${s} v${a} h-${s} z M${i} ${e} h${n} v${r} h-${n} z`),o},Hh=(t,i,e,n,r,o)=>{const{naturalWidth:s,naturalHeight:a}=i;t.setAttribute("d",`M0 0 h${s} v${a} h-${s} z M${e} ${n} h${r} v${o} h-${r} z`)},as=(t,i,e,n)=>{const{x:r,y:o,w:s,h:a}=t.type==="Annotation"||t.type==="Selection"?Ot(t,i):{x:t,y:i,w:e,h:n},l=document.createElementNS(ce,"g");if(s===0&&a===0){xt(l,"a9s-point"),xt(l,"a9s-non-scaling"),l.setAttribute("transform-origin",`${r} ${o}`);const u=document.createElementNS(ce,"circle"),c=document.createElementNS(ce,"circle");c.setAttribute("class","a9s-inner"),nr(c,r,o),u.setAttribute("class","a9s-outer"),nr(u,r,o),l.appendChild(u),l.appendChild(c)}else{const u=document.createElementNS(ce,"rect"),c=document.createElementNS(ce,"rect");c.setAttribute("class","a9s-inner"),tr(c,r,o,s,a),u.setAttribute("class","a9s-outer"),tr(u,r,o,s,a),l.appendChild(u),l.appendChild(c)}return l},ls=t=>{const i=t.querySelector(".a9s-outer");if(i.nodeName==="rect"){const e=parseFloat(i.getAttribute("x")),n=parseFloat(i.getAttribute("y")),r=parseFloat(i.getAttribute("width")),o=parseFloat(i.getAttribute("height"));return{x:e,y:n,w:r,h:o}}else{const e=parseFloat(i.getAttribute("cx")),n=parseFloat(i.getAttribute("cy"));return{x:e,y:n,w:0,h:0}}},jh=(t,i,e,n,r)=>{const o=t.querySelector(".a9s-inner"),s=t.querySelector(".a9s-outer");s.nodeName==="rect"?(tr(o,i,e,n,r),tr(s,i,e,n,r)):(nr(o,i,e),nr(s,i,e))},Bb=(t,i)=>{const{w:e,h:n}=Ot(t,i);return e*n};class Mb{constructor(i,e,n,r,o){T(this,"dragTo",(s,a)=>{this.group.style.display=null,this.opposite=[s,a];const{x:l,y:u,w:c,h}=this.bbox;Hh(this.mask,this.env.image,l,u,c,h),jh(this.rect,l,u,c,h)}),T(this,"getBoundingClientRect",()=>this.rect.getBoundingClientRect()),T(this,"toSelection",()=>{const{x:s,y:a,w:l,h:u}=this.bbox;return new Gn(gn(s,a,l,u,this.env.image,this.config.fragmentUnit))}),T(this,"destroy",()=>{this.group.parentNode.removeChild(this.group),this.mask=null,this.rect=null,this.group=null}),this.anchor=[i,e],this.opposite=[i,e],this.config=r,this.env=o,this.group=document.createElementNS(ce,"g"),this.mask=zh(o.image,i,e,2,2),this.mask.setAttribute("class","a9s-selection-mask"),this.rect=as(i,e,2,2),this.rect.setAttribute("class","a9s-selection"),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask),this.group.appendChild(this.rect),n.appendChild(this.group)}get bbox(){const i=this.opposite[0]-this.anchor[0],e=this.opposite[1]-this.anchor[1];return{x:i>0?this.anchor[0]:this.opposite[0],y:e>0?this.anchor[1]:this.opposite[1],w:Math.max(1,Math.abs(i)),h:Math.max(1,Math.abs(e))}}get element(){return this.rect}}const Fb={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},us=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,Ib=t=>{let i=null;const e=(r,o)=>new MouseEvent(r,{screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY,pageX:o.pageX,pageY:o.pageY,bubbles:!0}),n=r=>{const o=r.changedTouches[0],s=e(Fb[r.type],o);o.target.dispatchEvent(s),r.preventDefault(),(r.type==="touchstart"||r.type==="touchmove")&&(i&&clearTimeout(i),i=setTimeout(()=>{const a=e("dblclick",o);o.target.dispatchEvent(a)},800)),r.type==="touchend"&&i&&clearTimeout(i)};t.addEventListener("touchstart",n,!0),t.addEventListener("touchmove",n,!0),t.addEventListener("touchend",n,!0),t.addEventListener("touchcancel",n,!0)},ir="An implementation is missing",Lb=us();class Vh extends ei{constructor(i,e,n){super(),T(this,"enableResponsive",()=>{window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{const o=this.svg.getBoundingClientRect(),{width:s,height:a}=this.svg.viewBox.baseVal;this.scale=Math.max(s/o.width,a/o.height),this.onScaleChanged&&this.onScaleChanged(this.scale)}),this.resizeObserver.observe(this.svg.parentNode))}),T(this,"getSVGPoint",o=>{const s=this.svg.createSVGPoint();if(Lb){const a=this.svg.getBoundingClientRect(),l=o.clientX-a.x,u=o.clientY-a.y,{left:c,top:h}=this.svg.getBoundingClientRect();return s.x=l+c,s.y=u+h,s.matrixTransform(this.g.getScreenCTM().inverse())}else return s.x=o.offsetX,s.y=o.offsetY,s.matrixTransform(this.g.getCTM().inverse())}),T(this,"drawHandle",(o,s)=>{const a=document.createElementNS(ce,"g");a.setAttribute("class","a9s-handle");const l=document.createElementNS(ce,"g"),u=g=>{const y=document.createElementNS(ce,"circle");return y.setAttribute("cx",o),y.setAttribute("cy",s),y.setAttribute("r",g),y.setAttribute("transform-origin",`${o} ${s}`),y},c=this.config.handleRadius||6,h=u(c);h.setAttribute("class","a9s-handle-inner");const d=u(c+1);return d.setAttribute("class","a9s-handle-outer"),l.appendChild(d),l.appendChild(h),a.appendChild(l),a}),T(this,"setHandleXY",(o,s,a)=>{const l=o.querySelector(".a9s-handle-inner");l.setAttribute("cx",s),l.setAttribute("cy",a),l.setAttribute("transform-origin",`${s} ${a}`);const u=o.querySelector(".a9s-handle-outer");u.setAttribute("cx",s),u.setAttribute("cy",a),u.setAttribute("transform-origin",`${s} ${a}`)}),T(this,"getHandleXY",o=>{const s=o.querySelector(".a9s-handle-outer");return{x:parseFloat(s.getAttribute("cx")),y:parseFloat(s.getAttribute("cy"))}}),T(this,"scaleHandle",o=>{const s=o.querySelector(".a9s-handle-inner"),a=o.querySelector(".a9s-handle-outer"),l=this.scale*(this.config.handleRadius||6);s.setAttribute("r",l),a.setAttribute("r",l)}),this.svg=i.closest("svg"),this.g=i,this.config=e,this.env=n,this.scale=1;const{image:r}=n;(r instanceof Element||r instanceof HTMLDocument)&&this.enableResponsive()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null}}class cs extends Vh{constructor(i,e,n){super(i,e,n),T(this,"attachListeners",({mouseMove:r,mouseUp:o,dblClick:s})=>{r&&(this.mouseMove=a=>{const{x:l,y:u}=this.getSVGPoint(a);this.started||(this.emit("startSelection",{x:l,y:u}),this.started=!0),r(l,u,a)},this.svg.addEventListener("mousemove",this.mouseMove)),o&&(this.mouseUp=a=>{if(a.button!==0)return;const{x:l,y:u}=this.getSVGPoint(a);o(l,u,a)},document.addEventListener("mouseup",this.mouseUp)),s&&(this.dblClick=a=>{const{x:l,y:u}=this.getSVGPoint(a);s(l,u,a)},document.addEventListener("dblclick",this.dblClick))}),T(this,"detachListeners",()=>{this.mouseMove&&this.svg.removeEventListener("mousemove",this.mouseMove),this.mouseUp&&document.removeEventListener("mouseup",this.mouseUp),this.dblClick&&document.removeEventListener("dblclick",this.dblClick)}),T(this,"start",(r,o)=>{const{x:s,y:a}=this.getSVGPoint(r),{naturalWidth:l,naturalHeight:u}=this.env.image,c=s<0?0:s>l?l:s,h=a<0?0:a>u?u:a;this.startDrawing(c,h,o,r)}),T(this,"startDrawing",r=>{throw new Error(ir)}),T(this,"createEditableShape",(r,o)=>{throw new Error(ir)}),this.started=!1}get isDrawing(){throw new Error(ir)}}cs.supports=t=>{throw new Error(ir)};const Uh="An implementation is missing";class Wh extends Vh{constructor(i,e,n,r){super(e,n,r),T(this,"updateState",o=>{throw new Error(Uh)}),this.annotation=i}get element(){throw new Error(Uh)}}const Nb=/firefox/i.test(navigator.userAgent),Gh=(t,i,e,n,r)=>{t.setAttribute("width",n),t.setAttribute("height",r),Nb?(t.setAttribute("x",0),t.setAttribute("y",0),t.setAttribute("transform",`translate(${i}, ${e})`)):(t.setAttribute("x",i),t.setAttribute("y",e))},zb=(t,i)=>{const{x:e,y:n,width:r,height:o}=i.getBBox(),s=document.createElementNS(ce,"svg");s.setAttribute("class","a9s-formatter-el"),Gh(s,e,n,r,o);const a=document.createElementNS(ce,"g");a.appendChild(t),s.appendChild(a),i.append(s)},rr=(t,i,e)=>{if(!e)return t;const n=e.reduce((a,l)=>{const u=l(i);if(!u)return a;if(typeof u=="string"||u instanceof String)a.className=a.className?`${a.className} ${u}`:u;else if(u.nodeType===Node.ELEMENT_NODE)a.elements=a.elements?[...a.elements,u]:[u];else{const{className:c,style:h,element:d}=u;c&&(a.className=a.className?`${a.className} ${c}`:c),h&&(a.style=a.style?`${a.style} ${h}`:h),d&&(a.elements=a.elements?[...a.elements,d]:[d])}for(const c in u)u.hasOwnProperty(c)&&c.startsWith("data-")&&(a[c]=u[c]);return a},{}),{className:r,style:o,elements:s}=n;if(r&&xt(t,r),o){const a=t.querySelector(".a9s-outer"),l=t.querySelector(".a9s-inner");a&&l?(a.setAttribute("style","display:none"),l.setAttribute("style",o)):t.setAttribute("style",o)}s&&s.forEach(a=>zb(a,t));for(const a in n)n.hasOwnProperty(a)&&a.startsWith("data-")&&t.setAttribute(a,n[a])},$h=(t,i,e,n,r)=>{const o=t.querySelector(".a9s-formatter-el");o&&Gh(o,i,e,n,r)},$n="corner",or="edge";class Hb extends Wh{constructor(i,e,n,r){super(i,e,n,r),T(this,"onScaleChanged",()=>this.handles.map(this.scaleHandle)),T(this,"setSize",(c,h,d,g)=>{jh(this.rectangle,c,h,d,g),Hh(this.mask,this.env.image,c,h,d,g),$h(this.elementGroup,c,h,d,g);const[y,S,E,C,p,x,A,P]=this.handles;this.setHandleXY(y,c,h),this.setHandleXY(S,c+d,h),this.setHandleXY(E,c+d,h+g),this.setHandleXY(C,c,h+g),this.enableEdgeControls&&(this.setHandleXY(p,c+d/2,h),this.setHandleXY(x,c+d,h+g/2),this.setHandleXY(A,c+d/2,h+g),this.setHandleXY(P,c,h+g/2))}),T(this,"stretchCorners",(c,h,d)=>{const g=this.getHandleXY(h),y=d.x-g.x,S=d.y-g.y,E=y>0?g.x:d.x,C=S>0?g.y:d.y,p=Math.abs(y),x=Math.abs(S);return this.setSize(E,C,p,x),{x:E,y:C,w:p,h:x}}),T(this,"stretchEdge",(c,h,d)=>{const g=this.getHandleXY(h),y=ls(this.rectangle),S=c%2===0,E=S?y.w:d.x-g.x,C=S?d.y-g.y:y.h,p=S?y.x:E>0?g.x:d.x,x=S?C>0?g.y:d.y:y.y,A=Math.abs(E),P=Math.abs(C);return this.setSize(p,x,A,P),{x:p,y:x,w:A,h:P}}),T(this,"onGrab",(c,h)=>d=>{if(d.button!==0)return;this.grabbedElem=c,this.grabbedType=h;const g=this.getSVGPoint(d),{x:y,y:S}=ls(this.rectangle);this.mouseOffset={x:g.x-y,y:g.y-S}}),T(this,"onMouseMove",c=>{if(c.button!==0)return;const h=(d,g)=>d<0?0:d>g?g:d;if(this.grabbedElem){const d=this.getSVGPoint(c);if(this.grabbedElem===this.rectangle){const{w:g,h:y}=ls(this.rectangle),{naturalWidth:S,naturalHeight:E}=this.env.image,C=h(d.x-this.mouseOffset.x,S-g),p=h(d.y-this.mouseOffset.y,E-y);this.setSize(C,p,g,y),this.emit("update",gn(C,p,g,y,this.env.image,this.config.fragmentUnit))}else{const g=this.handles.indexOf(this.grabbedElem),y=this.handles[g^2],{x:S,y:E,w:C,h:p}=this.grabbedType===$n?this.stretchCorners(g,y,d):this.stretchEdge(g,y,d);this.emit("update",gn(S,E,C,p,this.env.image,this.config.fragmentUnit))}}}),T(this,"onMouseUp",c=>{this.grabbedElem=null,this.grabbedType=null,this.mouseOffset=null}),T(this,"updateState",c=>{const{x:h,y:d,w:g,h:y}=Ot(c,this.env.image);this.setSize(h,d,g,y)}),this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseup",this.onMouseUp);const{x:o,y:s,w:a,h:l}=Ot(i,r.image);this.containerGroup=document.createElementNS(ce,"g"),this.mask=zh(r.image,o,s,a,l),this.mask.setAttribute("class","a9s-selection-mask"),this.containerGroup.appendChild(this.mask),this.elementGroup=document.createElementNS(ce,"g"),this.elementGroup.setAttribute("class","a9s-annotation editable selected"),this.elementGroup.setAttribute("data-id",i.id),this.rectangle=as(o,s,a,l),this.rectangle.querySelector(".a9s-inner").addEventListener("mousedown",this.onGrab(this.rectangle)),this.elementGroup.appendChild(this.rectangle),this.enableEdgeControls=n.enableEdgeControls;const u=this.enableEdgeControls?[[o+a/2,s,or],[o+a,s+l/2,or],[o+a/2,s+l,or],[o,s+l/2,or]]:[];this.handles=[[o,s,$n],[o+a,s,$n],[o+a,s+l,$n],[o,s+l,$n],...u].map(c=>{const[h,d,g]=c,y=this.drawHandle(h,d);return y.addEventListener("mousedown",this.onGrab(y,g)),this.elementGroup.appendChild(y),y}),this.containerGroup.appendChild(this.elementGroup),e.appendChild(this.containerGroup),rr(this.rectangle,i,n.formatters),this.grabbedElem=null,this.grabbedType=null,this.mouseOffset=null}get element(){return this.elementGroup}destroy(){this.containerGroup.parentNode.removeChild(this.containerGroup),super.destroy()}}class sr extends cs{constructor(i,e,n){super(i,e,n),T(this,"startDrawing",(r,o)=>{this.attachListeners({mouseMove:this.onMouseMove,mouseUp:this.onMouseUp}),this.rubberband=new Mb(r,o,this.g,this.config,this.env)}),T(this,"stop",()=>{this.rubberband&&(this.rubberband.destroy(),this.rubberband=null)}),T(this,"onMouseMove",(r,o)=>{const{naturalWidth:s,naturalHeight:a}=this.env.image,l=Math.min(Math.max(r,0),s),u=Math.min(Math.max(o,0),a);this.rubberband.dragTo(l,u)}),T(this,"onMouseUp",()=>{this.detachListeners(),this.started=!1;const{width:r,height:o}=this.rubberband.getBoundingClientRect(),s=this.config.minSelectionWidth||4,a=this.config.minSelectionHeight||4;if(r>=s&&o>=a){const{element:l}=this.rubberband;l.annotation=this.rubberband.toSelection(),this.emit("complete",l)}else this.emit("cancel");this.stop()}),T(this,"createEditableShape",(r,o)=>new Hb(r,this.g,{...this.config,formatters:o},this.env)),this.rubberband=null}get isDrawing(){return this.rubberband!=null}}sr.identifier="rect",sr.supports=t=>{const i=t.selector("FragmentSelector");return i==null?void 0:i.conformsTo.startsWith("http://www.w3.org/TR/media-frags")};const ar=t=>{let i=0,e=t.length-1;for(let n=0;n<t.length;n++)i+=(t[e][0]+t[n][0])*(t[e][1]-t[n][1]),e=n;return Math.abs(.5*i)},jb=(t,i,e,n)=>{const r=t[0]-i,o=t[1]-e;return Math.sqrt(r*r+o*o)<=n},Vb=(t,i,e,n,r,o)=>{const s=o||0,a=Math.cos(s),l=Math.sin(s),u=t[0]-i,c=t[1]-e,h=a*u+l*c,d=l*u-a*c;return h*h/(n*n)+d*d/(r*r)<=1},hs=(t,i)=>{const e=t[0],n=t[1];let r=!1;for(let o=0,s=i.length-1;o<i.length;s=o++){const a=i[o][0],l=i[o][1],u=i[s][0],c=i[s][1];l>n!=c>n&&e<(u-a)*(n-l)/(c-l)+a&&(r=!r)}return r},Ub=(t,i)=>{for(let e of t)if(!hs(e,i))return!1;return!0},Wb=(t,i,e,n,r,o)=>{const s=t[0],a=t[1],l=n-i,u=r-e,c=Math.sqrt(l*l+u*u);return Math.abs((s-i)*u-(a-e)*l)/c<=o},Xh=t=>{const i=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(r=>r.trim()),e=[];let n=[];for(let r of i){const o=r.substring(0,1);if(o.toLowerCase()==="z")e.push([...n]),n=[];else{const s=r.substring(1).split(" ").map(c=>parseFloat(c.trim())),a=o===o.toUpperCase(),l=a?s[0]:s[0]+n[n.length-1][0],u=a?s[1]:s[1]+n[n.length-1][1];n.push([l,u])}}return n.length>0&&e.push([...n]),e},Gb=t=>{const i=new XMLSerializer().serializeToString(t.documentElement).replace("<svg>",`<svg xmlns="${ce}">`);return new DOMParser().parseFromString(i,"image/svg+xml").documentElement},qh=t=>{const i=n=>{Array.from(n.attributes).forEach(r=>{r.name.startsWith("on")&&n.removeAttribute(r.name)})},e=t.getElementsByTagName("script");return Array.from(e).reverse().forEach(n=>n.parentNode.removeChild(n)),i(t),Array.from(t.querySelectorAll("*")).forEach(i),t},Ut=t=>{const i=t.selector("SvgSelector");if(i){const e=new DOMParser,{value:n}=i,r=e.parseFromString(n,"image/svg+xml"),o=r.lookupPrefix(ce),s=r.lookupNamespaceURI(null);return o||s?qh(r).firstChild:qh(Gb(r)).firstChild}},Yh=t=>{const i=Ut(t),e=document.createElementNS(ce,"g"),n=i.cloneNode(!0);n.setAttribute("class","a9s-inner");const r=i.cloneNode(!0);return r.setAttribute("class","a9s-outer"),e.appendChild(r),e.appendChild(n),e},ds=(t,i)=>{const e=t.querySelector(".a9s-inner").cloneNode(!0);e.removeAttribute("class"),e.removeAttribute("xmlns");let n=e.outerHTML||new XMLSerializer().serializeToString(e);return n=n.replace(` xmlns="${ce}"`,""),{source:i==null?void 0:i.src,selector:{type:"SvgSelector",value:`<svg>${n}</svg>`}}},$b=t=>{const i=Ut(t),e=i.nodeName.toLowerCase();if(e==="polygon")return Xb(i);if(e==="circle")return qb(i);if(e==="ellipse")return Yb(i);if(e=="path")return Zb(i);if(e=="line")return 0;throw`Unsupported SVG shape type: ${e}`},Xb=t=>{const i=t.getAttribute("points").trim().split(" ").map(e=>e.split(",").map(n=>parseFloat(n.trim())));return ar(i)},qb=t=>{const i=t.getAttribute("r");return i*i*Math.PI},Yb=t=>{const i=t.getAttribute("rx"),e=t.getAttribute("ry");return i*e*Math.PI},Zb=t=>{const i=Xh(t);if(i.length==1)return ar(i[0]);{const e=r=>i.find(o=>{if(r!==o)return Ub(r,o)});let n=0;for(let r of i)e(r)?n-=ar(r):n+=ar(r);return n}};class Zh{constructor(i,e){T(this,"redraw",()=>{this.mask.setAttribute("d",`M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute("points")} z`)}),T(this,"destroy",()=>this.mask.parentNode.removeChild(this.mask)),this.w=i.naturalWidth,this.h=i.naturalHeight,this.polygon=e,this.mask=document.createElementNS(ce,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d",`M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute("points")} z`)}get element(){return this.mask}}class Kb{constructor(i,e,n){T(this,"setPoints",r=>{const o=r.map(s=>`${s[0]},${s[1]}`).join(" ");this.outer.setAttribute("points",o),this.inner.setAttribute("points",o)}),T(this,"getBoundingClientRect",()=>this.outer.getBoundingClientRect()),T(this,"dragTo",r=>{this.group.style.display=null,this.mousepos=r;const o=[...this.points,r];this.setPoints(o),this.mask.redraw()}),T(this,"addPoint",()=>{const[r,o]=this.mousepos,s=this.points[this.points.length-1];Math.pow(r-s[0],2)+Math.pow(o-s[1],2)>4&&(this.points=[...this.points,this.mousepos],this.setPoints(this.points),this.mask.redraw())}),T(this,"destroy",()=>{this.group.parentNode.removeChild(this.group),this.polygon=null,this.group=null}),T(this,"toSelection",()=>new Gn(ds(this.group,this.env.image))),this.points=[i],this.env=n,this.mousepos=i,this.group=document.createElementNS(ce,"g"),this.polygon=document.createElementNS(ce,"g"),this.polygon.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(ce,"polygon"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(ce,"polygon"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.mask=new Zh(n.image,this.inner),this.polygon.appendChild(this.outer),this.polygon.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.polygon),e.appendChild(this.group)}get element(){return this.polygon}}const ps=t=>{const i=t.querySelector(".a9s-inner").points,e=[];for(let n=0;n<i.numberOfItems;n++)e.push(i.getItem(n));return e},Jb=t=>t.querySelector(".a9s-inner").getBBox();class Qb extends Wh{constructor(i,e,n,r){super(i,e,n,r),T(this,"onScaleChanged",()=>this.handles.map(this.scaleHandle)),T(this,"setPoints",o=>{const s=g=>Math.round(10*g)/10,a=o.map(g=>`${s(g.x)},${s(g.y)}`).join(" ");this.shape.querySelector(".a9s-inner").setAttribute("points",a);const l=this.shape.querySelector(".a9s-outer");l.setAttribute("points",a),this.mask.redraw();const{x:u,y:c,width:h,height:d}=l.getBBox();$h(this.elementGroup,u,c,h,d)}),T(this,"onGrab",o=>s=>{s.button===0&&(this.grabbedElem=o,this.grabbedAt=this.getSVGPoint(s))}),T(this,"onMouseMove",o=>{const s=(a,l,u)=>a+l<0?-a:a+l>u?u-a:l;if(this.grabbedElem){const a=this.getSVGPoint(o);if(this.grabbedElem===this.shape){const{x:l,y:u,width:c,height:h}=Jb(this.shape),{naturalWidth:d,naturalHeight:g}=this.env.image,y=s(l,a.x-this.grabbedAt.x,d-c),S=s(u,a.y-this.grabbedAt.y,g-h),E=ps(this.shape).map(C=>({x:C.x+y,y:C.y+S}));this.grabbedAt=a,this.setPoints(E),E.forEach((C,p)=>this.setHandleXY(this.handles[p],C.x,C.y)),this.emit("update",ds(this.shape,this.env.image))}else{const l=this.handles.indexOf(this.grabbedElem),u=ps(this.shape).map((c,h)=>h===l?a:c);this.setPoints(u),this.setHandleXY(this.handles[l],a.x,a.y),this.emit("update",ds(this.shape,this.env.image))}}}),T(this,"onMouseUp",o=>{this.grabbedElem=null,this.grabbedAt=null}),T(this,"updateState",o=>{const s=Ut(o).getAttribute("points").split(" ").map(a=>{const[l,u]=a.split(",").map(c=>parseFloat(c.trim()));return{x:l,y:u}});this.setPoints(s),s.forEach((a,l)=>this.setHandleXY(this.handles[l],a.x,a.y))}),T(this,"destroy",()=>{this.containerGroup.parentNode.removeChild(this.containerGroup),super.destroy()}),this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseup",this.onMouseUp),this.containerGroup=document.createElementNS(ce,"g"),this.shape=Yh(i),this.shape.querySelector(".a9s-inner").addEventListener("mousedown",this.onGrab(this.shape)),this.mask=new Zh(r.image,this.shape.querySelector(".a9s-inner")),this.containerGroup.appendChild(this.mask.element),this.elementGroup=document.createElementNS(ce,"g"),this.elementGroup.setAttribute("class","a9s-annotation editable selected"),this.elementGroup.setAttribute("data-id",i.id),this.elementGroup.appendChild(this.shape),this.handles=ps(this.shape).map(o=>{const s=this.drawHandle(o.x,o.y);return s.addEventListener("mousedown",this.onGrab(s)),this.elementGroup.appendChild(s),s}),this.containerGroup.appendChild(this.elementGroup),e.appendChild(this.containerGroup),rr(this.shape,i,n.formatters),this.grabbedElem=null,this.grabbedAt=null}get element(){return this.elementGroup}}class fs extends cs{constructor(i,e,n){super(i,e,n),T(this,"startDrawing",(r,o,s)=>{this._isDrawing=!0,this._startOnSingleClick=s,this.attachListeners({mouseMove:this.onMouseMove,mouseUp:this.onMouseUp,dblClick:this.onDblClick}),this.rubberband=new Kb([r,o],this.g,this.env)}),T(this,"stop",()=>{this.detachListeners(),this._isDrawing=!1,this.rubberband&&(this.rubberband.destroy(),this.rubberband=null)}),T(this,"onMouseMove",(r,o)=>this.rubberband.dragTo([r,o])),T(this,"onMouseUp",()=>{const{width:r,height:o}=this.rubberband.getBoundingClientRect(),s=this.config.minSelectionWidth||4,a=this.config.minSelectionHeight||4;r>=s||o>=a?this.rubberband.addPoint():this._startOnSingleClick||(this.emit("cancel"),this.stop())}),T(this,"onDblClick",()=>{this._isDrawing=!1;const r=this.rubberband.element;r.annotation=this.rubberband.toSelection(),this.emit("complete",r),this.stop()}),T(this,"createEditableShape",(r,o)=>new Qb(r,this.g,{...this.config,formatters:o},this.env)),this._isDrawing=!1,this._startOnSingleClick=!1}get isDrawing(){return this._isDrawing}}fs.identifier="polygon",fs.supports=t=>{var i;const e=t.selector("SvgSelector");if(e)return(i=e.value)==null?void 0:i.match(/^<svg.*<polygon/g)};class ex extends ei{constructor(i,e,n){super(),T(this,"listTools",()=>this._registered.map(r=>r.identifier)),T(this,"registerTool",r=>{const o=r.identifier;this.listTools().includes(o)&&this.unregisterTool(o),this._registered.unshift(r)}),T(this,"unregisterTool",r=>this._registered=this._registered.filter(o=>o.identifier!==r)),T(this,"setCurrent",r=>{this._current&&this._current.destroy();const o=typeof r=="string"||r instanceof String?this._registered.find(s=>s.identifier===r):r;this._current=new o(this._g,this._config,this._env),this._current.on("startSelection",s=>this.emit("startSelection",s)),this._current.on("complete",s=>this.emit("complete",s)),this._current.on("cancel",s=>this.emit("cancel",s))}),T(this,"forAnnotation",r=>{var o;const[s,...a]=r.targets,l=(o=s.renderedVia)==null?void 0:o.name,u=l?this._registered.find(c=>c.identifier===l):this._registered.find(c=>c.supports(r));return u?new u(this._g,this._config,this._env):null}),this._g=i,this._config=e,this._env=n,this._registered=[sr,fs],this.setCurrent(sr)}get current(){return this._current}}const tx={FragmentSelector:as,SvgSelector:Yh},nx={FragmentSelector:Bb,SvgSelector:$b},Kh=t=>{const i=t.targets[0];if(i)return Array.isArray(i.selector)?i.selector[0]:i.selector},gs=(t,i)=>tx[Kh(t).type](t,i),Jh=(t,i)=>nx[Kh(t).type](t,i);class ix{constructor(i){const e=document.createElementNS(ce,"svg");e.setAttribute("class","a9s-osd-crosshair-container");const n=document.createElementNS(ce,"g");n.setAttribute("class","a9s-crosshair"),e.appendChild(n);const r=document.createElementNS(ce,"line"),o=document.createElementNS(ce,"line");n.appendChild(r),n.appendChild(o),i.parentElement.appendChild(e);const s=a=>{const{offsetX:l,offsetY:u}=a,c=i.parentElement.offsetWidth,h=i.parentElement.offsetHeight;r.setAttribute("x1",0),r.setAttribute("y1",u),r.setAttribute("x2",c),r.setAttribute("y2",u),o.setAttribute("x1",l),o.setAttribute("y1",0),o.setAttribute("x2",l),o.setAttribute("y2",h)};i.addEventListener("pointermove",s),i.parentElement.addEventListener("pointermove",s)}}function rx(t,i,e,n,r){Qh(t,i,e||0,n||t.length-1,r||ox)}function Qh(t,i,e,n,r){for(;n>e;){if(n-e>600){var o=n-e+1,s=i-e+1,a=Math.log(o),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1),c=Math.max(e,Math.floor(i-s*l/o+u)),h=Math.min(n,Math.floor(i+(o-s)*l/o+u));Qh(t,i,c,h,r)}var d=t[i],g=e,y=n;for(Xn(t,e,i),r(t[n],d)>0&&Xn(t,e,n);g<y;){for(Xn(t,g,y),g++,y--;r(t[g],d)<0;)g++;for(;r(t[y],d)>0;)y--}r(t[e],d)===0?Xn(t,e,y):(y++,Xn(t,y,n)),y<=i&&(e=y+1),i<=y&&(n=y-1)}}function Xn(t,i,e){var n=t[i];t[i]=t[e],t[e]=n}function ox(t,i){return t<i?-1:t>i?1:0}class sx{constructor(i=9){this._maxEntries=Math.max(4,i),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(i){let e=this.data;const n=[];if(!ur(i,e))return n;const r=this.toBBox,o=[];for(;e;){for(let s=0;s<e.children.length;s++){const a=e.children[s],l=e.leaf?r(a):a;ur(i,l)&&(e.leaf?n.push(a):vs(i,l)?this._all(a,n):o.push(a))}e=o.pop()}return n}collides(i){let e=this.data;if(!ur(i,e))return!1;const n=[];for(;e;){for(let r=0;r<e.children.length;r++){const o=e.children[r],s=e.leaf?this.toBBox(o):o;if(ur(i,s)){if(e.leaf||vs(i,s))return!0;n.push(o)}}e=n.pop()}return!1}load(i){if(!(i&&i.length))return this;if(i.length<this._minEntries){for(let n=0;n<i.length;n++)this.insert(i[n]);return this}let e=this._build(i.slice(),0,i.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(i){return i&&this._insert(i,this.data.height-1),this}clear(){return this.data=vn([]),this}remove(i,e){if(!i)return this;let n=this.data;const r=this.toBBox(i),o=[],s=[];let a,l,u;for(;n||o.length;){if(n||(n=o.pop(),l=o[o.length-1],a=s.pop(),u=!0),n.leaf){const c=ax(i,n.children,e);if(c!==-1)return n.children.splice(c,1),o.push(n),this._condense(o),this}!u&&!n.leaf&&vs(n,r)?(o.push(n),s.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],u=!1):n=null}return this}toBBox(i){return i}compareMinX(i,e){return i.minX-e.minX}compareMinY(i,e){return i.minY-e.minY}toJSON(){return this.data}fromJSON(i){return this.data=i,this}_all(i,e){const n=[];for(;i;)i.leaf?e.push(...i.children):n.push(...i.children),i=n.pop();return e}_build(i,e,n,r){const o=n-e+1;let s=this._maxEntries,a;if(o<=s)return a=vn(i.slice(e,n+1)),mn(a,this.toBBox),a;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),a=vn([]),a.leaf=!1,a.height=r;const l=Math.ceil(o/s),u=l*Math.ceil(Math.sqrt(s));ed(i,e,n,u,this.compareMinX);for(let c=e;c<=n;c+=u){const h=Math.min(c+u-1,n);ed(i,c,h,l,this.compareMinY);for(let d=c;d<=h;d+=l){const g=Math.min(d+l-1,h);a.children.push(this._build(i,d,g,r-1))}}return mn(a,this.toBBox),a}_chooseSubtree(i,e,n,r){for(;r.push(e),!(e.leaf||r.length-1===n);){let o=1/0,s=1/0,a;for(let l=0;l<e.children.length;l++){const u=e.children[l],c=ms(u),h=cx(i,u)-c;h<s?(s=h,o=c<o?c:o,a=u):h===s&&c<o&&(o=c,a=u)}e=a||e.children[0]}return e}_insert(i,e,n){const r=n?i:this.toBBox(i),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(i),Yn(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)}_split(i,e){const n=i[e],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);const s=this._chooseSplitIndex(n,o,r),a=vn(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,mn(n,this.toBBox),mn(a,this.toBBox),e?i[e-1].children.push(a):this._splitRoot(n,a)}_splitRoot(i,e){this.data=vn([i,e]),this.data.height=i.height+1,this.data.leaf=!1,mn(this.data,this.toBBox)}_chooseSplitIndex(i,e,n){let r,o=1/0,s=1/0;for(let a=e;a<=n-e;a++){const l=qn(i,0,a,this.toBBox),u=qn(i,a,n,this.toBBox),c=hx(l,u),h=ms(l)+ms(u);c<o?(o=c,r=a,s=h<s?h:s):c===o&&h<s&&(s=h,r=a)}return r||n-e}_chooseSplitAxis(i,e,n){const r=i.leaf?this.compareMinX:lx,o=i.leaf?this.compareMinY:ux,s=this._allDistMargin(i,e,n,r),a=this._allDistMargin(i,e,n,o);s<a&&i.children.sort(r)}_allDistMargin(i,e,n,r){i.children.sort(r);const o=this.toBBox,s=qn(i,0,e,o),a=qn(i,n-e,n,o);let l=lr(s)+lr(a);for(let u=e;u<n-e;u++){const c=i.children[u];Yn(s,i.leaf?o(c):c),l+=lr(s)}for(let u=n-e-1;u>=e;u--){const c=i.children[u];Yn(a,i.leaf?o(c):c),l+=lr(a)}return l}_adjustParentBBoxes(i,e,n){for(let r=n;r>=0;r--)Yn(e[r],i)}_condense(i){for(let e=i.length-1,n;e>=0;e--)i[e].children.length===0?e>0?(n=i[e-1].children,n.splice(n.indexOf(i[e]),1)):this.clear():mn(i[e],this.toBBox)}}function ax(t,i,e){if(!e)return i.indexOf(t);for(let n=0;n<i.length;n++)if(e(t,i[n]))return n;return-1}function mn(t,i){qn(t,0,t.children.length,i,t)}function qn(t,i,e,n,r){r||(r=vn(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let o=i;o<e;o++){const s=t.children[o];Yn(r,t.leaf?n(s):s)}return r}function Yn(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function lx(t,i){return t.minX-i.minX}function ux(t,i){return t.minY-i.minY}function ms(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function lr(t){return t.maxX-t.minX+(t.maxY-t.minY)}function cx(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function hx(t,i){const e=Math.max(t.minX,i.minX),n=Math.max(t.minY,i.minY),r=Math.min(t.maxX,i.maxX),o=Math.min(t.maxY,i.maxY);return Math.max(0,r-e)*Math.max(0,o-n)}function vs(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function ur(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function vn(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ed(t,i,e,n,r){const o=[i,e];for(;o.length;){if(e=o.pop(),i=o.pop(),e-i<=n)continue;const s=i+Math.ceil((e-i)/n/2)*n;rx(t,s,i,e,r),o.push(i,s,s,e)}}const ys=(t,i)=>{if(t.targets[0].selector.type==="FragmentSelector"){const{x:e,y:n,w:r,h:o}=Ot(t,i);return{minX:e,minY:n,maxX:e+r,maxY:n+o}}else{const e=gs(t,i),n=document.createElementNS(ce,"svg");n.style.position="absolute",n.style.opacity=0,n.style.top=0,n.style.left=0,n.appendChild(e),document.body.appendChild(n);const{x:r,y:o,width:s,height:a}=e.getBBox();return document.body.removeChild(n),{minX:r,minY:o,maxX:r+s,maxY:o+a}}},dx=t=>{var i;const e=t.targets[0];return Array.isArray(e.selector)?e.selector[0].type:(i=e.selector)==null?void 0:i.type},px=(t,i,e,n)=>{const r=Ut(e),o=r.nodeName.toLowerCase(),s=[t,i];if(o==="polygon"){const a=Array.from(r.points).map(l=>[l.x,l.y]);return hs(s,a)}else if(o==="circle"){const a=r.getAttribute("cx"),l=r.getAttribute("cy"),u=r.getAttribute("r");return jb(s,a,l,u)}else if(o==="ellipse"){const a=r.getAttribute("cx"),l=r.getAttribute("cy"),u=r.getAttribute("rx"),c=r.getAttribute("ry");return Vb(s,a,l,u,c)}else{if(o==="path")return Xh(r).find(a=>hs(s,a));if(o==="line"){const a=parseInt(r.getAttribute("x1")),l=parseInt(r.getAttribute("y1")),u=parseInt(r.getAttribute("x2")),c=parseInt(r.getAttribute("y2"));return Wb(s,a,l,u,c,n)}else throw`Unsupported SVG shape type: ${o}`}};class fx{constructor(i){T(this,"clear",()=>this.spatial_index.clear()),T(this,"getAnnotationAt",(e,n,r)=>{const o=r?5/r:5,s=this.spatial_index.search({minX:e-o,minY:n-o,maxX:e+o,maxY:n+o}).map(a=>a.annotation).filter(a=>{const l=dx(a);if(l==="FragmentSelector")return!0;if(l==="SvgSelector")return px(e,n,a,o);throw`Unsupported selector type: ${l}`});if(s.length>0)return s.sort((a,l)=>Jh(a,this.env.image)-Jh(l,this.env.image)),s[0]}),T(this,"getAnnotationsIntersecting",e=>{const n=e.minX,r=n?e:ys(e,this.env.image),o=this.spatial_index.search(r).map(s=>s.annotation);return n?o:o.filter(s=>!s.isEqual(e))}),T(this,"insert",e=>{(Array.isArray(e)?e:[e]).forEach(n=>{this.spatial_index.insert({...ys(n,this.env.image),annotation:n})})}),T(this,"getBounds",e=>this.getBounds(e,this.env.image)),T(this,"remove",e=>{const n={...ys(e,this.env.image),annotation:e};this.spatial_index.remove(n,(r,o)=>r.annotation.id===o.annotation.id)}),this.env=i,i.store=this,this.spatial_index=new sx}}const td=(t,i)=>{const e=(ss(i,".a9s-annotation")?i:i.closest(".a9s-annotation")).querySelector(".a9s-outer").getBoundingClientRect(),{canvas:n}=t.drawer,r=n.getBoundingClientRect(),o=n.width/r.width,s=n.height/r.height,a=e.x-r.x,l=e.y-r.y,{width:u,height:c}=e,h=document.createElement("CANVAS"),d=h.getContext("2d");h.width=u,h.height=c,d.drawImage(n,a*o,l*s,u*o,c*s,0,0,u,c);const g=t.viewport.viewerElementToImageCoordinates(new OpenSeadragon.Point(a,l)),y=t.viewport.viewportToImageZoom(t.viewport.getZoom());return{snippet:h,transform:S=>{const E=g.x+S[0]/o/y,C=g.y+S[1]/s/y;return[E,C]}}},gx=us();class nd extends ei{constructor(i){super(),T(this,"_getShapeAt",n=>{const r=l=>{const u=this.svg.createSVGPoint();if(window.TouchEvent&&l instanceof TouchEvent){const c=this.svg.getBoundingClientRect(),h=l.touches[0],d=h.clientX-c.x,g=h.clientY-c.y,{left:y,top:S}=this.svg.getBoundingClientRect();return u.x=d+y,u.y=g+S,u.matrixTransform(this.g.getScreenCTM().inverse())}else return u.x=l.offsetX,u.y=l.offsetY,u.matrixTransform(this.g.getCTM().inverse())},{x:o,y:s}=r(n),a=this.store.getAnnotationAt(o,s,this.currentScale());if(a)return this.findShape(a)}),T(this,"_initDrawingTools",n=>{var r;let o=!1,s=!1,a=!1;this.tools=new ex(this.g,this.config,this.env),this.tools.on("complete",c=>{s=!1,this.onDrawingComplete(c)}),this.mouseTracker=new Dt.MouseTracker({element:this.svg,preProcessEventHandler:c=>{this.mouseTracker.enabled||(c.preventDefault=!1,c.preventGesture=!0),this.selectedShape&&c.eventType==="wheel"&&(c.preventDefault=!1,this.viewer.canvas.dispatchEvent(new c.originalEvent.constructor(c.eventType,c.originalEvent)))},pressHandler:c=>{this.tools.current.isDrawing||(this.tools.current.start(c.originalEvent,this.drawOnSingleClick&&!this.hoveredShape),n||this.scaleTool(this.tools.current))},moveHandler:c=>{if(this.tools.current.isDrawing){const{x:h,y:d}=this.tools.current.getSVGPoint(c.originalEvent);!c.buttons||!s?(c.originalEvent.stopPropagation(),this.tools.current.onMouseMove(h,d,c.originalEvent),o||(this.emit("startSelection",{x:h,y:d}),o=!0)):(!a&&this.tools.current.onDragStart&&this.tools.current.onDragStart(h,d,c.originalEvent),a=!0)}},releaseHandler:c=>{if(this.tools.current.isDrawing){s=!0;const{x:h,y:d}=this.tools.current.getSVGPoint(c.originalEvent);o&&this.emit("endSelection",{x:h,y:d}),this.tools.current.onMouseUp(h,d,c.originalEvent),a&&this.tools.current.onDragEnd&&this.tools.current.onDragEnd()}o=!1,a=!1}});const l=this.config.hotkey?this.config.hotkey.key?this.config.hotkey.key.toLowerCase():this.config.hotkey.toLowerCase():"shift",u=(r=this.config.hotkey)==null?void 0:r.inverted;this.mouseTracker.enabled=u,this.onKeyDown&&document.removeEventListener("keydown",this.onKeyDown),this.onKeyUp&&document.removeEventListener("keydown",this.onKeyDown),this.onKeyDown=c=>{if(c.key.toLowerCase()===l&&!this.selectedShape){const h=!this.readOnly&&!u;this.mouseTracker.enabled=h,this.tools.current.enabled=h}},this.onKeyUp=c=>{c.key.toLowerCase()===l&&!this.tools.current.isDrawing&&(this.mouseTracker.enabled=u,this.tools.current.enabled=u)},document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)}),T(this,"_initMouseEvents",()=>{this.svg.addEventListener("mousemove",r=>{var o,s;if(!((o=this.tools)!=null&&o.current.isDrawing)&&!r.target.closest(".a9s-annotation.editable.selected")){const a=this._getShapeAt(r);if((a==null?void 0:a.annotation)!==((s=this.hoveredShape)==null?void 0:s.annotation)){if(this.hoveredShape){const l=this.hoveredShape.element||this.hoveredShape;er(l,"hover"),this.emit("mouseLeaveAnnotation",this.hoveredShape.annotation,this.hoveredShape)}a&&(xt(a,"hover"),this.emit("mouseEnterAnnotation",a.annotation,a))}this.hoveredShape=a}}),this.svg.parentElement.addEventListener("mouseleave",()=>{this.hoveredShape&&(er(this.hoveredShape,"hover"),this.emit("mouseLeaveAnnotation",this.hoveredShape.annotation,this.hoveredShape),this.hoveredShape=null)});let n=null;this.viewer.addHandler("canvas-press",()=>n=new Date().getTime()),this.viewer.addHandler("canvas-click",r=>{var o;const{originalEvent:s}=r;if(!((o=this.tools.current)!=null&&o.isDrawing||this.disableSelect)&&new Date().getTime()-n<250){const a=s.target.closest(".a9s-annotation.editable.selected")?this.selectedShape:this._getShapeAt(s);a?(r.preventDefaultAction=!0,this.selectShape(a)):a||(this.deselect(),this.emit("select",{}))}this.disableSelect&&this.hoveredShape&&this.emit("clickAnnotation",this.hoveredShape.annotation,this.hoveredShape)})}),T(this,"_lazy",n=>{if(this.viewer.world.getItemAt(0))n();else{const r=()=>{n(),this.viewer.removeHandler("open",r),this.viewer.world.removeHandler("add-item",r)};this.viewer.addHandler("open",r),this.viewer.world.addHandler("add-item",r)}}),T(this,"_refreshNonScalingAnnotations",()=>{const n=this.currentScale();Array.from(this.svg.querySelectorAll(".a9s-non-scaling")).forEach(r=>r.setAttribute("transform",`scale(${1/n})`))}),T(this,"addAnnotation",(n,r)=>{const o=r||this.g,s=gs(n,this.env.image);return xt(s,"a9s-annotation"),s.setAttribute("data-id",n.id),s.annotation=n,o.appendChild(s),rr(s,n,this.formatters),this.scaleFormatterElements(s),s}),T(this,"addDrawingTool",n=>this.tools.registerTool(n)),T(this,"addOrUpdateAnnotation",(n,r)=>{var o;const s=(o=this.selectedShape)==null?void 0:o.annotation;(s===n||s!=null&&s.isSelection||s==r)&&this.deselect(),r&&this.removeAnnotation(n),this.removeAnnotation(n);const a=this.addAnnotation(n);ss(a,"a9s-non-scaling")&&a.setAttribute("transform",`scale(${1/this.currentScale()})`),this.store.insert(n)}),T(this,"currentScale",()=>{const n=this.viewer.viewport.getContainerSize().x;return this.viewer.viewport.getZoom(!0)*n/this.viewer.world.getContentFactor()}),T(this,"deselect",()=>{var n;if((n=this.tools)==null||n.current.stop(),this.selectedShape){const{annotation:r}=this.selectedShape;if(this.selectedShape.destroy){if(this.selectedShape.mouseTracker.destroy(),this.selectedShape.destroy(),!r.isSelection){const o=this.addAnnotation(r);ss(o,"a9s-non-scaling")&&o.setAttribute("transform",`scale(${1/this.currentScale()})`)}}else er(this.selectedShape,"selected");this.selectedShape=null}}),T(this,"destroy",()=>{this.deselect(),this.svg.parentNode.removeChild(this.svg)}),T(this,"findShape",n=>{const r=n!=null&&n.id?n.id:n;return this.g.querySelector(`.a9s-annotation[data-id="${r}"]`)}),T(this,"_fit",(n,r,o)=>{const s=this.findShape(n);if(s){const a=r?typeof r=="boolean"?r:r.immediately:!1,l=(r==null?void 0:r.padding)||0,u=this.viewer.container.getBoundingClientRect(),c=Math.min(2*l/u.width,2*l/u.height),{x:h,y:d,width:g,height:y}=s.getBBox(),S=h-c*g,E=d-c*y,C=g+2*c*g,p=y+2*c*y,x=this.viewer.viewport.imageToViewportRectangle(S,E,C,p);this.viewer.viewport[o](x,a)}}),T(this,"fitBounds",(n,r)=>this._fit(n,r,"fitBounds")),T(this,"fitBoundsWithConstraints",(n,r)=>this._fit(n,r,"fitBoundsWithConstraints")),T(this,"getAnnotations",()=>Array.from(this.g.querySelectorAll(".a9s-annotation")).map(n=>n.annotation)),T(this,"getAnnotationsIntersecting",n=>{const r=n.id?n:this.findShape(n).annotation;return this.store.getAnnotationsIntersecting(r)}),T(this,"getImageSnippetById",n=>{const r=this.findShape(n);if(r)return td(this.viewer,r)}),T(this,"getSelectedImageSnippet",()=>{var n;if(this.selectedShape){const r=(n=this.selectedShape.element)!=null?n:this.selectedShape;return td(this.viewer,r)}}),T(this,"init",n=>{this.deselect(),Array.from(this.g.querySelectorAll(".a9s-annotation")).forEach(r=>this.g.removeChild(r)),this.store.clear(),this._lazy(()=>{console.time("Took"),console.log("Drawing..."),this.loaded||(this.g.style.display="none"),n.forEach(r=>this.addAnnotation(r)),console.log("Indexing..."),this.store.insert(n),console.timeEnd("Took"),this.resize()})}),T(this,"listDrawingTools",()=>this.tools.listTools()),T(this,"overrideId",(n,r)=>{const o=this.findShape(n);o.setAttribute("data-id",r);const{annotation:s}=o,a=s.clone({id:r});return o.annotation=a,this.store.remove(s),this.store.insert(a),a}),T(this,"panTo",(n,r)=>{const o=this.findShape(n);if(o){const{top:s,left:a,width:l,height:u}=o.getBoundingClientRect(),c=a+l/2+window.scrollX,h=s+u/2+window.scrollY,d=this.viewer.viewport.windowToViewportCoordinates(new Dt.Point(c,h));this.viewer.viewport.panTo(d,r)}}),T(this,"removeAnnotation",n=>{var r,o;const s=n.type?n.id:n;((r=this.selectedShape)==null?void 0:r.annotation.id)===s&&this.deselect();const a=this.findShape(n);if(a){const{annotation:l}=a;((o=this.selectedShape)==null?void 0:o.annotation)===l&&this.deselect(),a.parentNode.removeChild(a),this.store.remove(l)}}),T(this,"removeDrawingTool",n=>{var r;return(r=this.tools)==null?void 0:r.unregisterTool(n)}),T(this,"scaleFormatterElements",n=>{const r=1/this.currentScale();if(n){const o=n.querySelector(".a9s-formatter-el");o&&o.firstChild.setAttribute("transform",`scale(${r})`)}else Array.from(this.g.querySelectorAll(".a9s-formatter-el")).forEach(o=>o.firstChild.setAttribute("transform",`scale(${r})`))}),T(this,"scaleTool",n=>{if(n){const r=1/this.currentScale();n.scale=r,n.onScaleChanged&&n.onScaleChanged(r)}}),T(this,"selectAnnotation",(n,r)=>{this.selectedShape&&this.deselect();const o=this.findShape(n);if(o){this.selectShape(o,r);const s=this.selectedShape.element?this.selectedShape.element:this.selectedShape;return{annotation:o.annotation,element:s}}else this.deselect()}),T(this,"selectShape",(n,r)=>{var o;if(!r&&!n.annotation.isSelection&&this.emit("clickAnnotation",n.annotation,n),((o=this.selectedShape)==null?void 0:o.annotation)===n.annotation)return;this.selectedShape&&this.selectedShape.annotation!==n.annotation&&this.deselect();const{annotation:s}=n;if(this.readOnly||s.readOnly||this.headless)this.selectedShape=n,xt(n,"selected"),r||this.emit("select",{annotation:s,element:n,skipEvent:r});else{const a=this.tools.forAnnotation(s);if(a){setTimeout(()=>{n.parentNode.removeChild(n),r||this.emit("select",{annotation:s,element:this.selectedShape.element})},1),this.selectedShape=a.createEditableShape(s,this.formatters),this.scaleTool(this.selectedShape),this.scaleFormatterElements(this.selectedShape.element),this.selectedShape.element.annotation=s;const l=new Dt.MouseTracker({element:this.svg,preProcessEventHandler:u=>{u.stopPropagation=!0,u.preventDefault=!1,u.preventGesture=!0}}).setTracking(!1);this.selectedShape.element.addEventListener("mouseenter",()=>{this.hoveredShape=this.selectedShape,l.setTracking(!0)}),this.selectedShape.element.addEventListener("mouseleave",()=>{this.hoveredShape=null,l.setTracking(!1)}),this.selectedShape.mouseTracker=l,this.selectedShape.on("update",u=>this.emit("updateTarget",this.selectedShape.element,u))}else this.selectedShape=n,r||this.emit("select",{annotation:s,element:this.selectedShape})}}),T(this,"setDrawingEnabled",n=>{if(this.mouseTracker){const r=n&&!this.readOnly;this.mouseTracker.enabled=r,this.mouseTracker.setTracking(r),this.tools.current&&(this.tools.current.enabled=r)}}),T(this,"setDrawingTool",n=>{var r;this.tools&&((r=this.tools.current)==null||r.stop(),this.tools.setCurrent(n))}),T(this,"setVisible",n=>{n?this.svg.style.display=null:(this.deselect(),this.svg.style.display="none")}),T(this,"stopDrawing",()=>{var n;(n=this.tools)!=null&&n.current&&(this.tools.current.isDrawing&&this.tools.current.stop(),this.mouseTracker.enabled=!1,this.tools.current.enabled=!1)}),this.viewer=i.viewer,this.config=i.config,this.env=i.env,this.readOnly=i.config.readOnly,this.headless=i.config.headless,i.config.formatter?this.formatters=[i.config.formatter]:i.config.formatters&&(this.formatters=Array.isArray(i.config.formatters)?i.config.formatters:[i.config.formatters]),this.disableSelect=i.config.disableSelect,this.drawOnSingleClick=i.config.drawOnSingleClick,this.svg=document.createElementNS(ce,"svg"),gx?(this.svg.setAttribute("class","a9s-annotationlayer a9s-osd-annotationlayer touch"),Ib(this.svg)):this.svg.setAttribute("class","a9s-annotationlayer a9s-osd-annotationlayer"),this.g=document.createElementNS(ce,"g"),this.svg.appendChild(this.g),this.viewer.canvas.appendChild(this.svg),this.viewer.addHandler("animation",()=>this.resize()),this.viewer.addHandler("rotate",()=>this.resize()),this.viewer.addHandler("resize",()=>this.resize()),this.viewer.addHandler("flip",()=>this.resize()),this.loaded=!1;const e=()=>{const{x:n,y:r}=this.viewer.world.getItemAt(0).source.dimensions,o=this.viewer.world.getItemAt(0).source["@id"]||new URL(this.viewer.world.getItemAt(0).source.url,document.baseURI).href;this.env.image={src:o,naturalWidth:n,naturalHeight:r},i.config.crosshair&&(this.crosshair||(this.crosshair=new ix(this.svg),xt(this.svg,"no-cursor"))),this.loaded||this.emit("load",o),this.loaded=!0,this.g.style.display="inline",this.resize()};this.viewer.addHandler("open",e),this.viewer.world.addHandler("add-item",e),this.viewer.world.getItemAt(0)&&e(),this.store=new fx(this.env),this.selectedShape=null,this.hoveredShape=null,this._initMouseEvents()}resize(){var i;const e=this.viewer.viewport.getFlip(),n=this.viewer.viewport.pixelFromPoint(new Dt.Point(0,0),!0);e&&(n.x=this.viewer.viewport._containerInnerSize.x-n.x);const r=this.currentScale(),o=e?-r:r,s=this.viewer.viewport.getRotation();this.g.setAttribute("transform",`translate(${n.x}, ${n.y}) scale(${o}, ${r}) rotate(${s})`),this._refreshNonScalingAnnotations(),this.scaleFormatterElements(),this.selectedShape&&(this.selectedShape.element?(this.scaleTool(this.selectedShape),this.emit("viewportChange",this.selectedShape.element)):this.emit("viewportChange",this.selectedShape)),(i=this.tools)!=null&&i.current&&this.scaleTool(this.tools.current)}}class mx extends nd{constructor(i){super(i),T(this,"onDrawingComplete",e=>{var n;this.mouseTracker.enabled=(n=this.config.hotkey)==null?void 0:n.inverted,this.selectShape(e),this.emit("createSelection",e.annotation)}),this._initDrawingTools()}}const ws=t=>{const i=t.viewport.viewportToImageRectangle(t.viewport.getBounds(!0)),e=t.viewport.getContainerSize().x,n=t.viewport.getZoom(!0)*e/t.world.getContentFactor();return{extent:i,scale:n}},vx=t=>{var i;const e=t.targets[0];return e?Array.isArray(e.selector)?e.selector[0].type:(i=e.selector)==null?void 0:i.type:null},id=(t,i)=>{const{extent:e,scale:n}=ws(t),{selector:r}=i,o=Vt.create({target:i});if(r.type==="SvgSelector"){const s=Ut(o),a=s.nodeName.toLowerCase();let l=null;if(a==="polygon")l=yx(s,e,n);else if(a==="circle")l=wx(s,e,n);else if(a==="ellipse")l=Ex(s,e,n);else if(a==="path")l=bx(s,e,n);else throw`Unsupported SVG shape type: ${a}`;let u=l.outerHTML||new XMLSerializer().serializeToString(l);return u=u.replace(` xmlns="${ce}"`,""),{...i,selector:{type:"SvgSelector",value:`<svg>${u}</svg>`}}}else if(r.type==="FragmentSelector"){const{x:s,y:a,w:l,h:u}=Ot(o),c=e.x+s/n,h=e.y+a/n,d=l/n,g=u/n;return l===0&&u===0?{...gn(c,h,d,g),renderedVia:{name:"point"}}:gn(c,h,d,g)}else throw`Unsupported selector type: ${r.type}`},yx=(t,i,e)=>{const n=Array.from(t.points).map(r=>{const o=i.x+r.x/e,s=i.y+r.y/e;return o+","+s}).join(" ");return t.setAttribute("points",n),t},wx=(t,i,e)=>{const n=parseFloat(t.getAttribute("cx")),r=parseFloat(t.getAttribute("cy")),o=parseFloat(t.getAttribute("r"));return t.setAttribute("cx",i.x+n/e),t.setAttribute("cy",i.y+r/e),t.setAttribute("r",o/e),t},Ex=(t,i,e)=>{const n=parseFloat(t.getAttribute("cx")),r=parseFloat(t.getAttribute("cy")),o=parseFloat(t.getAttribute("rx")),s=parseFloat(t.getAttribute("ry"));return t.setAttribute("cx",i.x+n/e),t.setAttribute("cy",i.y+r/e),t.setAttribute("rx",o/e),t.setAttribute("ry",s/e),t},bx=(t,i,e)=>{const n=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(r=>r.trim()).map(r=>{const o=r.substring(0,1);if(o.toLowerCase()==="z")return o;{const s=r.substring(1).split(" ").map(c=>parseFloat(c.trim())),a=o===o.toUpperCase(),l=a?i.x+s[0]/e:s[0]/e,u=a?i.y+s[1]/e:s[1]/e;return o+" "+l+" "+u}}).join(" ");return t.setAttribute("d",n),t},rd=(t,i)=>{const{extent:e,scale:n}=ws(t),r=i.selector("FragmentSelector");if(i.selector("SvgSelector")){const o=Ut(i),s=o.nodeName.toLowerCase();let a=null;if(s==="polygon")a=xx(o,e,n);else if(s==="circle")a=Sx(o,e,n);else if(s==="ellipse")a=_x(o,e,n);else if(s==="path")a=Cx(o,e,n);else throw`Unsupported SVG shape type: ${s}`;let l=a.outerHTML||new XMLSerializer().serializeToString(a);l=l.replace(` xmlns="${ce}"`,"");const u={selector:{type:"SvgSelector",value:`<svg>${l}</svg>`}};return i.clone({target:u})}else if(r){const{x:o,y:s,w:a,h:l}=Ot(i),u=(o-e.x)*n,c=(s-e.y)*n,h=gn(u,c,a*n,l*n);return i.clone({target:h})}},xx=(t,i,e)=>{const n=Array.from(t.points).map(r=>{const o=e*(r.x-i.x),s=e*(r.y-i.y);return o+","+s}).join(" ");return t.setAttribute("points",n),t},Sx=(t,i,e)=>{const n=t.getAttribute("cx"),r=t.getAttribute("cy"),o=t.getAttribute("r");return t.setAttribute("cx",e*(n-i.x)),t.setAttribute("cy",e*(r-i.y)),t.setAttribute("r",o*e),t},_x=(t,i,e)=>{const n=t.getAttribute("cx"),r=t.getAttribute("cy"),o=t.getAttribute("rx"),s=t.getAttribute("ry");return t.setAttribute("cx",e*(n-i.x)),t.setAttribute("cy",e*(r-i.y)),t.setAttribute("rx",o*e),t.setAttribute("ry",s*e),t},Cx=(t,i,e)=>{const n=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(r=>r.trim()).map(r=>{const o=r.substring(0,1);if(o.toLowerCase()==="z")return o;{const s=r.substring(1).split(" ").filter(c=>c).map(c=>parseFloat(c.trim())),a=o===o.toUpperCase(),l=a?e*(s[0]-i.x):e*s[0],u=a?e*(s[1]-i.y):e*s[1];return o+" "+l+" "+u}}).join(" ");return t.setAttribute("d",n),t},od=(t,i)=>{const{extent:e,scale:n}=ws(t),r=vx(i.annotation);if(r==="FragmentSelector")Tx(i,e,n);else if(r==="SvgSelector")Px(i,e,n);else throw`Unsupported selector type type: ${r}`;const o=i.querySelector(".a9s-formatter-el");if(o){const{x:s,y:a}=i.querySelector(".a9s-inner").getBBox();o.setAttribute("x",s),o.setAttribute("y",a)}},Tx=(t,i,e)=>{const{x:n,y:r,w:o,h:s}=Ot(t.annotation),a=t.querySelector(".a9s-outer"),l=t.querySelector(".a9s-inner"),u=e*(n-i.x),c=e*(r-i.y);o===0&&s===0?[a,l].forEach(h=>{h.setAttribute("cx",u),h.setAttribute("cy",c)}):[a,l].forEach(h=>{h.setAttribute("x",u),h.setAttribute("y",c),h.setAttribute("width",o*e),h.setAttribute("height",s*e)})},Px=(t,i,e)=>{const n=Ut(t.annotation),r=n.nodeName.toLowerCase();if(r==="polygon")Ax(t,n,i,e);else if(r==="circle")Dx(t,n,i,e);else if(r==="ellipse")Ox(t,n,i,e);else if(r==="path")Rx(t,n,i,e);else throw`Unsupported SVG shape type: ${r}`},Ax=(t,i,e,n)=>{const r=Array.from(i.points).map(o=>{const s=n*(o.x-e.x),a=n*(o.y-e.y);return s+","+a}).join(" ");t.querySelector(".a9s-outer").setAttribute("points",r),t.querySelector(".a9s-inner").setAttribute("points",r)},Dx=(t,i,e,n)=>{const r=n*(i.getAttribute("cx")-e.x),o=n*(i.getAttribute("cy")-e.y),s=n*i.getAttribute("r"),a=t.querySelector(".a9s-outer");a.setAttribute("cx",r),a.setAttribute("cy",o),a.setAttribute("r",s);const l=t.querySelector(".a9s-inner");l.setAttribute("cx",r),l.setAttribute("cy",o),l.setAttribute("r",s)},Ox=(t,i,e,n)=>{const r=n*(i.getAttribute("cx")-e.x),o=n*(i.getAttribute("cy")-e.y),s=n*i.getAttribute("rx"),a=n*i.getAttribute("ry"),l=t.querySelector(".a9s-outer");l.setAttribute("cx",r),l.setAttribute("cy",o),l.setAttribute("rx",s),l.setAttribute("ry",a);const u=t.querySelector(".a9s-inner");u.setAttribute("cx",r),u.setAttribute("cy",o),u.setAttribute("rx",s),u.setAttribute("ry",a)},Rx=(t,i,e,n)=>{const r=i.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(o=>o.trim()).map(o=>{const s=o.substring(0,1);if(s.toLowerCase()==="z")return s;{const a=o.substring(1).split(" ").filter(h=>h).map(h=>parseFloat(h.trim())),l=s===s.toUpperCase(),u=l?n*(a[0]-e.x):n*a[0],c=l?n*(a[1]-e.y):n*a[1];return s+" "+u+" "+c}}).join(" ");t.querySelector(".a9s-inner").setAttribute("d",r),t.querySelector(".a9s-outer").setAttribute("d",r)},kx=us();class Bx extends nd{constructor(i){super(i),T(this,"_fit",(e,n,r)=>{const o=n?typeof n=="boolean"?n:n.immediately:!1,s=(n==null?void 0:n.padding)||0,a=this.findShape(e);if(a){const l=this.viewer.container.getBoundingClientRect(),u=a.getBoundingClientRect(),c=u.x-l.x,h=u.y-l.y,{width:d,height:g}=u,y=c-s,S=h-s,E=d+2*s,C=g+2*s,p=this.viewer.viewport.viewerElementToViewportRectangle(new Dt.Rect(y,S,E,C));this.viewer.viewport[r](p,o)}}),T(this,"_getShapeAt",e=>{const n=l=>{if(kx){const u=this.svg.getBoundingClientRect(),c=l.clientX-u.x,h=l.clientY-u.y;return new Dt.Point(c,h)}else return new Dt.Point(l.offsetX,l.offsetY)},r=this.viewer.viewport.viewerElementToViewportCoordinates(n(e)),{x:o,y:s}=this.viewer.viewport.viewportToImageCoordinates(r.x,r.y),a=this.store.getAnnotationAt(o,s,this.currentScale());if(a)return this.findShape(a)}),T(this,"_refreshNonScalingAnnotations",()=>{}),T(this,"addAnnotation",(e,n)=>{const r=n||this.g,o=gs(e,this.env.image);return xt(o,"a9s-annotation"),o.setAttribute("data-id",e.id),o.annotation=e,od(this.viewer,o),r.appendChild(o),rr(o,e,this.formatters),o}),T(this,"addOrUpdateAnnotation",(e,n)=>{var r;const o=(r=this.selectedShape)==null?void 0:r.annotation;(o===e||o!=null&&o.isSelection||o==n)&&this.deselect(),n&&this.removeAnnotation(e),this.removeAnnotation(e),this.addAnnotation(e),this.store.insert(e)}),T(this,"deselect",()=>{var e;if((e=this.tools)==null||e.current.stop(),this.selectedShape){const{annotation:n}=this.selectedShape;this.selectedShape.destroy?(this.selectedShape.mouseTracker.destroy(),this.selectedShape.destroy(),n.isSelection||this.addAnnotation(n)):er(this.selectedShape,"selected"),this.selectedShape=null}}),T(this,"onDrawingComplete",e=>{const n=e.annotation.clone({target:id(this.viewer,e.annotation.target)});e.annotation=n,this.selectShape(e),this.emit("createSelection",e.annotation),this.mouseTracker.enabled=!1}),T(this,"selectShape",(e,n)=>{var r;if(!n&&!e.annotation.isSelection&&this.emit("clickAnnotation",e.annotation,e),((r=this.selectedShape)==null?void 0:r.annotation)===e.annotation)return;this.selectedShape&&this.selectedShape.annotation!==e.annotation&&this.deselect(!0);const{annotation:o}=e;if(this.readOnly||o.readOnly||this.headless)this.selectedShape=e,xt(e,"selected"),n||this.emit("select",{annotation:o,element:e,skipEvent:n});else{setTimeout(()=>{e.parentNode.removeChild(e),n||this.emit("select",{annotation:o,element:this.selectedShape.element})},1);const s=this.tools.forAnnotation(o);this.selectedShape=s.createEditableShape(o),this.selectedShape.element.annotation=o;const a=rd(this.viewer,o);this.selectedShape.updateState(a);const l=new Dt.MouseTracker({element:this.svg,preProcessEventHandler:u=>{u.stopPropagation=!0,u.preventDefault=!1,u.preventGesture=!0}}).setTracking(!1);this.selectedShape.element.addEventListener("mouseenter",()=>{this.hoveredShape=this.selectedShape,l.setTracking(!0)}),this.selectedShape.element.addEventListener("mouseleave",()=>{this.hoveredShape=null,l.setTracking(!1)}),this.selectedShape.mouseTracker=l,this.selectedShape.on("update",u=>{const c=id(this.viewer,u);this.selectedShape.element.annotation=this.selectedShape.annotation.clone({target:c}),this.emit("updateTarget",this.selectedShape.element,c)})}}),this._initDrawingTools(!0)}resize(){if(this.store&&(Array.from(this.g.querySelectorAll(".a9s-annotation:not(.selected)")).forEach(i=>od(this.viewer,i)),this.selectedShape))if(this.selectedShape.element){const i=rd(this.viewer,this.selectedShape.element.annotation);this.selectedShape.updateState&&this.selectedShape.updateState(i),this.emit("viewportChange",this.selectedShape.element)}else this.emit("viewportChange",this.selectedShape)}}var Mx=0;function sd(t,i,e,n,r){var o,s,a={};for(s in i)s=="ref"?o=i[s]:a[s]=i[s];var l={type:t,props:a,key:e,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Mx,__source:n,__self:r};if(typeof t=="function"&&(o=t.defaultProps))for(s in o)a[s]===void 0&&(a[s]=o[s]);return Z.vnode&&Z.vnode(l),l}class Fx extends Ae{constructor(i){super(i),T(this,"clearState",e=>this.setState({selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null,beforeHeadlessModify:null},e)),T(this,"forwardEvent",(e,n)=>{this.annotationLayer.on(e,(r,o)=>{this.props[n](r.clone(),o)})}),T(this,"onKeyUp",e=>{if(e.which===27){this.annotationLayer.stopDrawing();const{selectedAnnotation:n}=this.state;n&&(this.cancelSelected(),this.props.onCancelSelected(n))}else if(e.which===46){const{disableDeleteKey:n}=this.props.config;if(!n){const{selectedAnnotation:r}=this.state;r&&(r.isSelection?this.onCancelAnnotation(r):this.onDeleteAnnotation(r))}}}),T(this,"handleStartSelect",e=>this.props.onSelectionStarted(e)),T(this,"handleEndSelect",e=>this.props.onSelectionEnded(e)),T(this,"handleSelect",(e,n)=>{this.state.editorDisabled?this.onHeadlessSelect(e,n):this.onNormalSelect(e,n)}),T(this,"onNormalSelect",(e,n)=>{const{annotation:r,element:o}=e;if(r){const s=()=>{this.setState({selectedAnnotation:r,selectedDOMElement:o,modifiedTarget:null},()=>{n||(r.isSelection?this.props.onSelectionCreated(r.clone()):this.props.onAnnotationSelected(r.clone(),o))})},{selectedAnnotation:a}=this.state;a&&!a.isEqual(r)?this.clearState(()=>{this.props.onCancelSelected(a),s()}):s()}else{const{selectedAnnotation:s}=this.state;s?this.clearState(()=>this.props.onCancelSelected(s)):this.clearState()}}),T(this,"onHeadlessSelect",(e,n)=>{this.saveSelected().then(()=>{this.onNormalSelect(e,n)})}),T(this,"handleUpdateTarget",(e,n)=>{this.setState({selectedDOMElement:e,modifiedTarget:n});const r=JSON.parse(JSON.stringify(n));this.props.onSelectionTargetChanged(r)}),T(this,"handleViewportChange",e=>this.setState({selectedDOMElement:e})),T(this,"overrideAnnotationId",e=>n=>{const{id:r}=e;this.state.selectedAnnotation?this.setState({selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null},()=>{this.annotationLayer.overrideId(r,n)}):this.annotationLayer.overrideId(r,n)}),T(this,"onCreateOrUpdateAnnotation",(e,n)=>(r,o)=>{let s=r.isSelection?r.toAnnotation():r;s=this.state.modifiedTarget?s.clone({target:this.state.modifiedTarget}):s.clone(),this.clearState(()=>{this.annotationLayer.addOrUpdateAnnotation(s,o),o?this.props[e](s,o.clone()):this.props[e](s,this.overrideAnnotationId(s)),n&&n()})}),T(this,"onDeleteAnnotation",e=>{this.clearState(),this.annotationLayer.removeAnnotation(e),this.props.onAnnotationDeleted(e)}),T(this,"onCancelAnnotation",(e,n)=>{this.state.editorDisabled||this.annotationLayer.deselect(),this.props.onCancelSelected(e),this.clearState(n)}),T(this,"addAnnotation",e=>{var n;e.id===((n=this.state.selectedAnnotation)==null?void 0:n.id)&&(this.annotationLayer.deselect(),this.clearState()),this.annotationLayer.addOrUpdateAnnotation(e.clone())}),T(this,"addDrawingTool",e=>this.annotationLayer.addDrawingTool(e)),T(this,"cancelSelected",()=>new Promise(e=>{this.annotationLayer.deselect(),this.state.selectedAnnotation?this.clearState(e):e()})),T(this,"fitBounds",(e,n)=>this.annotationLayer.fitBounds(e,n)),T(this,"fitBoundsWithConstraints",(e,n)=>this.annotationLayer.fitBoundsWithConstraints(e,n)),T(this,"getAnnotationById",e=>{var n;return(n=this.annotationLayer.findShape(e))==null?void 0:n.annotation}),T(this,"getAnnotations",()=>this.annotationLayer.getAnnotations().map(e=>e.clone())),T(this,"getAnnotationsIntersecting",e=>this.annotationLayer.getAnnotationsIntersecting(e)),T(this,"getImageSnippetById",e=>this.annotationLayer.getImageSnippetById(e)),T(this,"getSelected",()=>{var e;if(this.state.selectedAnnotation)return this.state.editorDisabled?this.state.selectedAnnotation:(e=this._editor.current)==null?void 0:e.getCurrentAnnotation()}),T(this,"getSelectedImageSnippet",()=>this.annotationLayer.getSelectedImageSnippet()),T(this,"listDrawingTools",()=>this.annotationLayer.listDrawingTools()),T(this,"panTo",(e,n)=>this.annotationLayer.panTo(e,n)),T(this,"removeAnnotation",e=>this.annotationLayer.removeAnnotation(e)),T(this,"removeDrawingTool",e=>this.annotationLayer.removeDrawingTool(e)),T(this,"saveSelected",()=>new Promise(e=>{const n=this.state.selectedAnnotation;if(n)if(this._editor.current)this._editor.current.onOk(),e();else if(n.isSelection)n.bodies.length>0||this.props.config.allowEmpty?this.onCreateOrUpdateAnnotation("onAnnotationCreated",e)(n):(this.annotationLayer.deselect(),e());else{const{beforeHeadlessModify:r,modifiedTarget:o}=this.state;r?this.onCreateOrUpdateAnnotation("onAnnotationUpdated",e)(n,r):o?this.onCreateOrUpdateAnnotation("onAnnotationUpdated",e)(n,n):this.onCancelAnnotation(n,e)}else e()})),T(this,"selectAnnotation",e=>{const n=this.annotationLayer.selectAnnotation(e,!0);if(n)return this.handleSelect(n,!0),n.annotation.clone();this.clearState()}),T(this,"setAnnotations",e=>this.annotationLayer.init(e.map(n=>n.clone()))),T(this,"setDrawingEnabled",e=>this.annotationLayer.setDrawingEnabled(e)),T(this,"setDrawingTool",e=>this.annotationLayer.setDrawingTool(e)),T(this,"setVisible",e=>{this.annotationLayer.setVisible(e),e||this.clearState()}),T(this,"updateSelected",(e,n)=>new Promise(r=>{this.state.selectedAnnotation&&(n?this.state.selectedAnnotation.isSelection?this.onCreateOrUpdateAnnotation("onAnnotationCreated",r)(e):this.onCreateOrUpdateAnnotation("onAnnotationUpdated",r)(e,this.state.selectedAnnotation):this.setState({selectedAnnotation:e,beforeHeadlessModify:this.state.beforeHeadlessModify||this.state.selectedAnnotation},r))})),this.state={selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null,readOnly:i.config.readOnly,editorDisabled:i.config.disableEditor,widgets:i.config.widgets,beforeHeadlessModify:null},this._editor=B.createRef()}componentDidMount(){this.annotationLayer=this.props.config.gigapixelMode?new Bx(this.props):new mx(this.props),this.annotationLayer.on("load",this.props.onLoad),this.annotationLayer.on("startSelection",this.handleStartSelect),this.annotationLayer.on("endSelection",this.handleEndSelect),this.annotationLayer.on("select",this.handleSelect),this.annotationLayer.on("updateTarget",this.handleUpdateTarget),this.annotationLayer.on("viewportChange",this.handleViewportChange),this.forwardEvent("clickAnnotation","onClickAnnotation"),this.forwardEvent("mouseEnterAnnotation","onMouseEnterAnnotation"),this.forwardEvent("mouseLeaveAnnotation","onMouseLeaveAnnotation"),document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){this.annotationLayer.destroy(),document.removeEventListener("keyup",this.onKeyUp)}get disableEditor(){return this.state.editorDisabled}set disableEditor(i){this.setState({editorDisabled:i})}get disableSelect(){return this.annotationLayer.disableSelect}set disableSelect(i){this.annotationLayer.disableSelect=i}get formatters(){return this.annotationLayer.formatters}set formatters(i){this.annotationLayer.formatters=i}get readOnly(){return this.state.readOnly}set readOnly(i){this.annotationLayer.readOnly=i,this.setState({readOnly:i})}get widgets(){return this.state.widgets}set widgets(i){this.setState({widgets:i})}render(){var i;const e=this.state.selectedAnnotation&&!this.state.editorDisabled,n=this.state.readOnly||((i=this.state.selectedAnnotation)==null?void 0:i.readOnly);return e&&sd(xb,{ref:this._editor,detachable:!0,wrapperEl:this.props.wrapperEl,annotation:this.state.selectedAnnotation,modifiedTarget:this.state.modifiedTarget,selectedElement:this.state.selectedDOMElement,readOnly:n,allowEmpty:this.props.config.allowEmpty,widgets:this.state.widgets,env:this.props.env,onAnnotationCreated:this.onCreateOrUpdateAnnotation("onAnnotationCreated"),onAnnotationUpdated:this.onCreateOrUpdateAnnotation("onAnnotationUpdated"),onAnnotationDeleted:this.onDeleteAnnotation,onCancel:this.onCancelAnnotation})}}class Ix{constructor(i,e){T(this,"handleAnnotationCreated",(r,o)=>this._emitter.emit("createAnnotation",r.underlying,o)),T(this,"handleAnnotationDeleted",r=>this._emitter.emit("deleteAnnotation",r.underlying)),T(this,"handleAnnotationSelected",(r,o)=>this._emitter.emit("selectAnnotation",r.underlying,o)),T(this,"handleAnnotationUpdated",(r,o)=>this._emitter.emit("updateAnnotation",r.underlying,o.underlying)),T(this,"handleCancelSelected",r=>this._emitter.emit("cancelSelected",r.underlying)),T(this,"handleClickAnnotation",(r,o)=>this._emitter.emit("clickAnnotation",r.underlying,o)),T(this,"handleLoad",r=>this._emitter.emit("load",r)),T(this,"handleSelectionCreated",r=>this._emitter.emit("createSelection",r.underlying)),T(this,"handleSelectionStarted",r=>this._emitter.emit("startSelection",r)),T(this,"handleSelectionEnded",r=>this._emitter.emit("endSelection",r)),T(this,"handleSelectionTargetChanged",r=>this._emitter.emit("changeSelectionTarget",r)),T(this,"handleMouseEnterAnnotation",(r,o)=>this._emitter.emit("mouseEnterAnnotation",r.underlying,o)),T(this,"handleMouseLeaveAnnotation",(r,o)=>this._emitter.emit("mouseLeaveAnnotation",r.underlying,o)),T(this,"_wrap",r=>(r==null?void 0:r.type)==="Annotation"?new Vt(r):r),T(this,"addAnnotation",r=>this._app.current.addAnnotation(new Vt(r))),T(this,"addDrawingTool",r=>this._app.current.addDrawingTool(r)),T(this,"cancelSelected",()=>this._app.current.cancelSelected()),T(this,"clearAnnotations",()=>this.setAnnotations([])),T(this,"clearAuthInfo",()=>this._env.user=null),T(this,"destroy",()=>B.unmountComponentAtNode(this.appContainerEl)),T(this,"fitBounds",(r,o)=>this._app.current.fitBounds(this._wrap(r),o)),T(this,"fitBoundsWithConstraints",(r,o)=>this._app.current.fitBoundsWithConstraints(this._wrap(r),o)),T(this,"getAnnotationById",r=>{const o=this._app.current.getAnnotationById(r);return o==null?void 0:o.underlying}),T(this,"getAnnotations",()=>this._app.current.getAnnotations().map(r=>r.underlying)),T(this,"getAnnotationsIntersecting",r=>this._app.current.getAnnotationsIntersecting(this._wrap(r))),T(this,"getImageSnippetById",r=>this._app.current.getImageSnippetById(r)),T(this,"getSelected",()=>{const r=this._app.current.getSelected();return r==null?void 0:r.underlying}),T(this,"getSelectedImageSnippet",()=>this._app.current.getSelectedImageSnippet()),T(this,"listDrawingTools",()=>this._app.current.listDrawingTools()),T(this,"loadAnnotations",r=>fetch(r).then(o=>o.json()).then(o=>(this.setAnnotations(o),o))),T(this,"off",(r,o)=>this._emitter.off(r,o)),T(this,"on",(r,o)=>this._emitter.on(r,o)),T(this,"once",(r,o)=>this._emitter.once(r,o)),T(this,"panTo",(r,o)=>this._app.current.panTo(this._wrap(r),o)),T(this,"removeAnnotation",r=>this._app.current.removeAnnotation(this._wrap(r))),T(this,"removeDrawingTool",r=>this._app.current.removeDrawingTool(r)),T(this,"saveSelected",()=>this._app.current.saveSelected()),T(this,"selectAnnotation",r=>{const o=this._app.current.selectAnnotation(this._wrap(r));return o==null?void 0:o.underlying}),T(this,"setAnnotations",r=>{const o=(r||[]).map(s=>new Vt(s));this._app.current.setAnnotations(o)}),T(this,"setAuthInfo",r=>this._env.user=r),T(this,"setDrawingEnabled",r=>this._app.current.setDrawingEnabled(r)),T(this,"setDrawingTool",r=>this._app.current.setDrawingTool(r)),T(this,"setServerTime",r=>this._env.setServerTime(r)),T(this,"setVisible",r=>this._app.current.setVisible(r)),T(this,"updateSelected",(r,o)=>{let s=null;r.type==="Annotation"?s=new Vt(r):r.type==="Selection"&&(s=new Gn(r.target,r.body)),s&&this._app.current.updateSelected(s,o)});const n=e||{};this._app=B.createRef(),this._emitter=new ei,this._env=Db(),this._element=i.element,window.getComputedStyle(this._element).getPropertyValue("position")==="static"&&(this._element.style.position="relative"),Ob(n.locale,n.messages),this.appContainerEl=document.createElement("DIV"),this._element.appendChild(this.appContainerEl),B.render(sd(Fx,{ref:this._app,viewer:i,wrapperEl:this._element,config:n,env:this._env,onSelectionStarted:this.handleSelectionStarted,onSelectionEnded:this.handleSelectionEnded,onSelectionCreated:this.handleSelectionCreated,onSelectionTargetChanged:this.handleSelectionTargetChanged,onAnnotationCreated:this.handleAnnotationCreated,onAnnotationSelected:this.handleAnnotationSelected,onAnnotationUpdated:this.handleAnnotationUpdated,onAnnotationDeleted:this.handleAnnotationDeleted,onCancelSelected:this.handleCancelSelected,onClickAnnotation:this.handleClickAnnotation,onLoad:this.handleLoad,onMouseEnterAnnotation:this.handleMouseEnterAnnotation,onMouseLeaveAnnotation:this.handleMouseLeaveAnnotation}),this.appContainerEl)}get disableEditor(){return this._app.current.disableEditor}set disableEditor(i){this._app.current.disableEditor=i}get disableSelect(){return this._app.current.disableSelect}set disableSelect(i){this._app.current.disableSelect=i}get formatters(){return this._app.current.formatters||[]}set formatters(i){if(i){const e=Array.isArray(i)?i:[i];this._app.current.formatters=e}else this._app.current.formatters=null}get readOnly(){return this._app.current.readOnly}set readOnly(i){this._app.current.readOnly=i}get widgets(){return this._app.current.widgets}set widgets(i){this._app.current.widgets=i}}var Lx=(t,i)=>new Ix(t,i);return Lx})})(cd);var hd=cd.exports;const Hx=Nx(hd),Vx=zx({__proto__:null,default:Hx},[hd]);export{Vx as o};

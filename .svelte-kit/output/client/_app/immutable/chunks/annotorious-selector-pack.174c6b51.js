import{g as xr}from"./_commonjsHelpers.725317a4.js";function kr(Ae,et){for(var le=0;le<et.length;le++){const $=et[le];if(typeof $!="string"&&!Array.isArray($)){for(const L in $)if(L!=="default"&&!(L in Ae)){const se=Object.getOwnPropertyDescriptor($,L);se&&Object.defineProperty(Ae,L,se.get?se:{enumerable:!0,get:()=>$[L]})}}}return Object.freeze(Object.defineProperty(Ae,Symbol.toStringTag,{value:"Module"}))}var Rn={exports:{}};/*! For license information please see annotorious-selector-pack.js.LICENSE.txt */(function(Ae,et){(function(le,$){Ae.exports=$()})(self,function(){return(()=>{var le={94:D=>{function T(_){return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},T(_)}D.exports=function _(w,C){if(w===C)return!0;if(w&&C&&T(w)=="object"&&T(C)=="object"){if(w.constructor!==C.constructor)return!1;var G,N,V;if(Array.isArray(w)){if((G=w.length)!=C.length)return!1;for(N=G;N--!=0;)if(!_(w[N],C[N]))return!1;return!0}if(w.constructor===RegExp)return w.source===C.source&&w.flags===C.flags;if(w.valueOf!==Object.prototype.valueOf)return w.valueOf()===C.valueOf();if(w.toString!==Object.prototype.toString)return w.toString()===C.toString();if((G=(V=Object.keys(w)).length)!==Object.keys(C).length)return!1;for(N=G;N--!=0;)if(!Object.prototype.hasOwnProperty.call(C,V[N]))return!1;for(N=G;N--!=0;){var fe=V[N];if(!_(w[fe],C[fe]))return!1}return!0}return w!=w&&C!=C}},773:D=>{function T(){}T.prototype={on:function(_,w,C){var G=this.e||(this.e={});return(G[_]||(G[_]=[])).push({fn:w,ctx:C}),this},once:function(_,w,C){var G=this;function N(){G.off(_,N),w.apply(C,arguments)}return N._=w,this.on(_,N,C)},emit:function(_){for(var w=[].slice.call(arguments,1),C=((this.e||(this.e={}))[_]||[]).slice(),G=0,N=C.length;G<N;G++)C[G].fn.apply(C[G].ctx,w);return this},off:function(_,w){var C=this.e||(this.e={}),G=C[_],N=[];if(G&&w)for(var V=0,fe=G.length;V<fe;V++)G[V].fn!==w&&G[V].fn._!==w&&N.push(G[V]);return N.length?C[_]=N:delete C[_],this}},D.exports=T,D.exports.TinyEmitter=T}},$={};function L(D){var T=$[D];if(T!==void 0)return T.exports;var _=$[D]={exports:{}};return le[D](_,_.exports,L),_.exports}L.n=D=>{var T=D&&D.__esModule?()=>D.default:()=>D;return L.d(T,{a:T}),T},L.d=(D,T)=>{for(var _ in T)L.o(T,_)&&!L.o(D,_)&&Object.defineProperty(D,_,{enumerable:!0,get:T[_]})},L.o=(D,T)=>Object.prototype.hasOwnProperty.call(D,T);var se={};return(()=>{L.d(se,{default:()=>Ar});var D,T=L(773),_=L.n(T),w="http://www.w3.org/2000/svg",C=function(t,e){var n=function(r){var s=r.getAttribute("class");return s?new Set(s.split(" ")):new Set}(t);n.add(e),t.setAttribute("class",Array.from(n).join(" "))},G=new Uint8Array(16);function N(){if(!D&&!(D=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return D(G)}const V=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,fe=function(t){return typeof t=="string"&&V.test(t)};for(var U=[],tt=0;tt<256;++tt)U.push((tt+256).toString(16).substr(1));const Ft=function(t,e,n){var r=(t=t||{}).random||(t.rng||N)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var s=0;s<16;++s)e[n+s]=r[s];return e}return function(p){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=(U[p[i+0]]+U[p[i+1]]+U[p[i+2]]+U[p[i+3]]+"-"+U[p[i+4]]+U[p[i+5]]+"-"+U[p[i+6]]+U[p[i+7]]+"-"+U[p[i+8]]+U[p[i+9]]+"-"+U[p[i+10]]+U[p[i+11]]+U[p[i+12]]+U[p[i+13]]+U[p[i+14]]+U[p[i+15]]).toLowerCase();if(!fe(u))throw TypeError("Stringified UUID is invalid");return u}(r)};var Tn=L(94),qt=L.n(Tn);function zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function pe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zt(Object(n),!0).forEach(function(r){Ge(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ge(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var nt=function(){function t(r,s){var p=this;(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),Ge(this,"clone",function(i,u){return new t(pe(pe({},p.underlying),i),pe(pe({},p.opts),u))}),Ge(this,"selector",function(i){var u=p.underlying.target;if(u.selector)return(Array.isArray(u.selector)?u.selector:[u.selector]).find(function(a){return a.type===i})}),this.underlying=r,this.opts=s}var e,n;return e=t,(n=[{key:"isEqual",value:function(r){return(r==null?void 0:r.type)==="Annotation"&&(this.underlying===r.underlying||!(!this.underlying.id||!r.underlying.id)&&qt()(this.underlying,r.underlying))}},{key:"readOnly",get:function(){var r;return(r=this.opts)===null||r===void 0?void 0:r.readOnly}},{key:"id",get:function(){return this.underlying.id}},{key:"type",get:function(){return this.underlying.type}},{key:"motivation",get:function(){return this.underlying.motivation}},{key:"body",get:function(){return this.underlying.body}},{key:"target",get:function(){return this.underlying.target}},{key:"bodies",get:function(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]},set:function(r){this.underlying.body=r}},{key:"targets",get:function(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}},{key:"quote",get:function(){return this.selector("TextQuoteSelector").exact}},{key:"start",get:function(){return this.selector("TextPositionSelector").start}},{key:"end",get:function(){return this.selector("TextPositionSelector").end}}])&&Gn(e.prototype,n),t}();function Vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vt(Object(n),!0).forEach(function(r){De(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function De(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Ge(nt,"create",function(t){var e={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"#".concat(Ft()),body:[]};return new nt(pe(pe({},e),t))});var xe=function(){function t(r,s){var p=this;(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),De(this,"clone",function(i){var u=new t;return u.underlying=JSON.parse(JSON.stringify(p.underlying)),i&&(u.underlying=It(It({},u.underlying),i)),u}),De(this,"selector",function(i){var u=p.underlying.target;if(u.selector)return(Array.isArray(u.selector)?u.selector:[u.selector]).find(function(a){return a.type===i})}),De(this,"toAnnotation",function(){var i=Object.assign({},p.underlying,{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"#".concat(Ft())});return new nt(i)}),this.underlying={type:"Selection",body:s||[],target:r}}var e,n;return e=t,(n=[{key:"type",get:function(){return this.underlying.type}},{key:"body",get:function(){return this.underlying.body}},{key:"target",get:function(){return this.underlying.target}},{key:"targets",get:function(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}},{key:"isEqual",value:function(r){return!!r&&qt()(this.underlying,r.underlying)}},{key:"bodies",get:function(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}},{key:"quote",get:function(){return this.selector("TextQuoteSelector").exact}},{key:"isSelection",get:function(){return!0}}])&&Dn(e.prototype,n),t}();function rt(t){return rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(t)}function Wt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zt(t,e,n){return e&&$t(t.prototype,e),n&&$t(t,n),t}function Kt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ot(t,e)}function ot(t,e){return ot=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},ot(t,e)}function Jt(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Ne(t);if(e){var s=Ne(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return Nn(this,n)}}function Nn(t,e){if(e&&(rt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q(t)}function q(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ne(t)}function I(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var He="An implementation is missing",Hn="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,Qt=function(t){Kt(n,t);var e=Jt(n);function n(r,s,p){var i;Wt(this,n),I(q(i=e.call(this)),"enableResponsive",function(){window.ResizeObserver&&(i.resizeObserver=new ResizeObserver(function(){var a=i.svg.getBoundingClientRect(),f=i.svg.viewBox.baseVal,l=f.width,o=f.height;i.scale=Math.max(l/a.width,o/a.height),i.onScaleChanged&&i.onScaleChanged(i.scale)}),i.resizeObserver.observe(i.svg.parentNode))}),I(q(i),"getSVGPoint",function(a){var f=i.svg.createSVGPoint();if(Hn){var l=i.svg.getBoundingClientRect(),o=a.clientX-l.x,c=a.clientY-l.y,m=i.svg.getBoundingClientRect(),d=m.left,v=m.top;return f.x=o+d,f.y=c+v,f.matrixTransform(i.g.getScreenCTM().inverse())}return f.x=a.offsetX,f.y=a.offsetY,f.matrixTransform(i.g.getCTM().inverse())}),I(q(i),"drawHandle",function(a,f){var l=document.createElementNS(w,"g");l.setAttribute("class","a9s-handle");var o=document.createElementNS(w,"g"),c=function(g){var y=document.createElementNS(w,"circle");return y.setAttribute("cx",a),y.setAttribute("cy",f),y.setAttribute("r",g),y},m=i.config.handleRadius||6,d=c(m);d.setAttribute("class","a9s-handle-inner");var v=c(m+1);return v.setAttribute("class","a9s-handle-outer"),o.appendChild(v),o.appendChild(d),l.appendChild(o),l}),I(q(i),"setHandleXY",function(a,f,l){var o=a.querySelector(".a9s-handle-inner");o.setAttribute("cx",f),o.setAttribute("cy",l);var c=a.querySelector(".a9s-handle-outer");c.setAttribute("cx",f),c.setAttribute("cy",l)}),I(q(i),"getHandleXY",function(a){var f=a.querySelector(".a9s-handle-outer");return{x:parseFloat(f.getAttribute("cx")),y:parseFloat(f.getAttribute("cy"))}}),I(q(i),"scaleHandle",function(a){var f=a.querySelector(".a9s-handle-inner"),l=a.querySelector(".a9s-handle-outer"),o=i.scale*(i.config.handleRadius||6);f.setAttribute("r",o),l.setAttribute("r",o)}),i.svg=r.closest("svg"),i.g=r,i.config=s,i.env=p,i.scale=1;var u=p.image;return(u instanceof Element||u instanceof HTMLDocument)&&i.enableResponsive(),i}return Zt(n,[{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null}}]),n}(_()),ye=function(t){Kt(n,t);var e=Jt(n);function n(r,s,p){var i;return Wt(this,n),I(q(i=e.call(this,r,s,p)),"attachListeners",function(u){var a=u.mouseMove,f=u.mouseUp,l=u.dblClick;a&&(i.mouseMove=function(o){var c=i.getSVGPoint(o),m=c.x,d=c.y;i.started||(i.emit("startSelection",{x:m,y:d}),i.started=!0),a(m,d,o)},i.svg.addEventListener("mousemove",i.mouseMove)),f&&(i.mouseUp=function(o){if(o.button===0){var c=i.getSVGPoint(o),m=c.x,d=c.y;f(m,d,o)}},document.addEventListener("mouseup",i.mouseUp)),l&&(i.dblClick=function(o){var c=i.getSVGPoint(o),m=c.x,d=c.y;l(m,d,o)},document.addEventListener("dblclick",i.dblClick))}),I(q(i),"detachListeners",function(){i.mouseMove&&i.svg.removeEventListener("mousemove",i.mouseMove),i.mouseUp&&document.removeEventListener("mouseup",i.mouseUp),i.dblClick&&document.removeEventListener("dblclick",i.dblClick)}),I(q(i),"start",function(u,a){var f=i.getSVGPoint(u),l=f.x,o=f.y;i.startDrawing(l,o,a,u)}),I(q(i),"startDrawing",function(u){throw new Error(He)}),I(q(i),"createEditableShape",function(u){throw new Error(He)}),i.started=!1,i}return Zt(n,[{key:"isDrawing",get:function(){throw new Error(He)}}]),n}(Qt);function it(t){return it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},it(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function at(t,e){return at=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},at(t,e)}function Bn(t,e){if(e&&(it(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return en(t)}function en(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Le(t){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(t)}ye.supports=function(t){throw new Error(He)};var tn="An implementation is missing",ke=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&at(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=Le(r);if(s){var f=Le(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Bn(this,u)});function i(u,a,f,l){var o,c,m,d;return function(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")}(this,i),d=function(v){throw new Error(tn)},(m="updateState")in(c=en(o=p.call(this,a,f,l)))?Object.defineProperty(c,m,{value:d,enumerable:!0,configurable:!0,writable:!0}):c[m]=d,o.annotation=u,o}return e=i,(n=[{key:"element",get:function(){throw new Error(tn)}}])&&Ln(e.prototype,n),i}(Qt);function nn(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var rn=function(t,e){var n=t.selector("FragmentSelector");if(n!=null&&n.conformsTo.startsWith("http://www.w3.org/TR/media-frags")){var r=n.value,s=r.includes(":")?r.substring(r.indexOf("=")+1,r.indexOf(":")):"pixel",p=function(l,o){return function(c){if(Array.isArray(c))return c}(l)||function(c,m){var d=c==null?null:typeof Symbol<"u"&&c[Symbol.iterator]||c["@@iterator"];if(d!=null){var v,g,y=[],b=!0,h=!1;try{for(d=d.call(c);!(b=(v=d.next()).done)&&(y.push(v.value),!m||y.length!==m);b=!0);}catch(O){h=!0,g=O}finally{try{b||d.return==null||d.return()}finally{if(h)throw g}}return y}}(l,o)||function(c,m){if(c){if(typeof c=="string")return nn(c,m);var d=Object.prototype.toString.call(c).slice(8,-1);return d==="Object"&&c.constructor&&(d=c.constructor.name),d==="Map"||d==="Set"?Array.from(c):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?nn(c,m):void 0}}(l,o)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}((r.includes(":")?r.substring(r.indexOf(":")+1):r.substring(r.indexOf("=")+1)).split(",").map(parseFloat),4),i=p[0],u=p[1],a=p[2],f=p[3];return s.toLowerCase()==="percent"&&(i=i*e.naturalWidth/100,u=u*e.naturalHeight/100,a=a*e.naturalWidth/100,f=f*e.naturalHeight/100),{x:i,y:u,w:a,h:f}}};function on(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function an(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?on(Object(n),!0).forEach(function(r){Un(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Un(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var un=function(t,e,n,r){return an(an({},function(s,p,i,u,a,f){return(f==null?void 0:f.toLowerCase())==="percent"?function(l,o,c,m,d){var v=l/d.naturalWidth*100,g=o/d.naturalHeight*100,y=0/d.naturalWidth*100,b=0/d.naturalHeight*100;return{source:d.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:"xywh=percent:".concat(v,",").concat(g,",").concat(y,",").concat(b)}}}(s,p,0,0,a):function(l,o,c,m,d){return{source:d==null?void 0:d.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:"xywh=pixel:".concat(l,",").concat(o,",").concat(0,",").concat(0)}}}(s,p,0,0,a)}(t,e,0,0,n,r)),{},{renderedVia:{name:"point"}})};function ut(t){return ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(t)}function Xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e,n){return ct=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(r,s,p){var i=function(a,f){for(;!Object.prototype.hasOwnProperty.call(a,f)&&(a=be(a))!==null;);return a}(r,s);if(i){var u=Object.getOwnPropertyDescriptor(i,s);return u.get?u.get.call(p):u.value}},ct(t,e,n||t)}function lt(t,e){return lt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},lt(t,e)}function Yn(t,e){if(e&&(ut(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(t)}function de(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function be(t){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},be(t)}function Ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Fn=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&lt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=be(r);if(s){var f=be(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Yn(this,u)});function i(u,a,f,l){var o;(function(v,g){if(!(v instanceof g))throw new TypeError("Cannot call a class as a function")})(this,i),Ce(de(o=p.call(this,u,a,f,l)),"onScaleChanged",function(){return o.scaleHandle(o.point)}),Ce(de(o),"onGrab",function(){o.isGrabbed=!0}),Ce(de(o),"onMouseMove",function(v){if(v.button===0&&o.isGrabbed){var g=o.getSVGPoint(v),y=g.x,b=g.y;o.setHandleXY(o.point,y,b);var h=un(y,b,o.env.image,o.config.fragmentUnit);o.emit("update",h)}}),Ce(de(o),"onMouseUp",function(){o.isGrabbed=!1}),Ce(de(o),"updateState",function(v){var g=rn(v,o.env.image),y=g.x,b=g.y;o.setHandleXY(o.point,y,b)}),o.svg.addEventListener("mousemove",o.onMouseMove),o.svg.addEventListener("mouseup",o.onMouseUp);var c=rn(u,l.image),m=c.x,d=c.y;return o.container=document.createElementNS(w,"g"),o.elementGroup=document.createElementNS(w,"g"),o.elementGroup.setAttribute("class","a9s-annotation editable selected"),o.point=o.drawHandle(m,d),o.point.addEventListener("mousedown",o.onGrab),o.elementGroup.appendChild(o.point),o.container.appendChild(o.elementGroup),a.appendChild(o.container),o.isGrabbed=!1,o}return e=i,(n=[{key:"element",get:function(){return this.elementGroup}},{key:"destroy",value:function(){this.svg.removeEventListener("mousemove",this.onMouseMove),this.svg.removeEventListener("mouseup",this.onMouseUp),this.container.parentNode.removeChild(this.container),ct(be(i.prototype),"destroy",this).call(this)}}])&&Xn(e.prototype,n),i}(ke);function st(t){return st=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},st(t)}function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ft(t,e){return ft=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},ft(t,e)}function zn(t,e){if(e&&(st(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Be(t)}function Be(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ue(t){return Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ue(t)}function pt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var yt=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&ft(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=Ue(r);if(s){var f=Ue(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return zn(this,u)});function i(u,a,f){var l;return function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}(this,i),pt(Be(l=p.call(this,u,a,f)),"startDrawing",function(o,c,m,d){var v,g=(v=d.target.closest(".a9s-annotation"))===null||v===void 0?void 0:v.annotation;if(g&&function(b){var h;return((h=b.target.renderedVia)===null||h===void 0?void 0:h.name)==="point"}(g))l.emit("cancel");else{var y=l.drawHandle(o,c);l.scaleHandle(y),l.g.appendChild(y),y.annotation=new xe(un(o,c,l.env.image,l.config.fragmentUnit)),l.emit("complete",y)}}),pt(Be(l),"stop",function(){}),pt(Be(l),"createEditableShape",function(o){return new Fn(o,l.g,l.config,l.env)}),l}return e=i,(n=[{key:"isDrawing",get:function(){return!1}}])&&qn(e.prototype,n),i}(ye);yt.identifier="point",yt.supports=function(t){return!1};var cn=function(t){var e=function(r){Array.from(r.attributes).forEach(function(s){s.name.startsWith("on")&&r.removeAttribute(s.name)})},n=t.getElementsByTagName("script");return Array.from(n).reverse().forEach(function(r){return r.parentNode.removeChild(r)}),e(t),Array.from(t.querySelectorAll("*")).forEach(e),t},oe=function(t){var e,n,r=t.selector("SvgSelector");if(r){var s=new DOMParser,p=r.value,i=s.parseFromString(p,"image/svg+xml"),u=i.lookupPrefix(w),a=i.lookupNamespaceURI(null);return u||a?cn(i).firstChild:cn((e=i,n=new XMLSerializer().serializeToString(e.documentElement).replace("<svg>",'<svg xmlns="'.concat(w,'">')),new DOMParser().parseFromString(n,"image/svg+xml").documentElement)).firstChild}},dt=function(t){var e=oe(t),n=document.createElementNS(w,"g"),r=e.cloneNode(!0);r.setAttribute("class","a9s-inner");var s=e.cloneNode(!0);return s.setAttribute("class","a9s-outer"),n.appendChild(s),n.appendChild(r),n},W=function(t,e){var n=t.querySelector(".a9s-inner").cloneNode(!0);n.removeAttribute("class"),n.removeAttribute("xmlns");var r=n.outerHTML||new XMLSerializer().serializeToString(n);return r=r.replace(' xmlns="'.concat(w,'"'),""),{source:e==null?void 0:e.src,selector:{type:"SvgSelector",value:"<svg>".concat(r,"</svg>")}}},Xe=function(t,e,n,r){t.setAttribute("cx",e),t.setAttribute("cy",n),t.setAttribute("r",r)},bt=function(t,e,n,r){var s=t.querySelector(".a9s-inner"),p=t.querySelector(".a9s-outer");Xe(s,e,n,r),Xe(p,e,n,r)},Me=function(t){var e=t.querySelector(".a9s-outer");return{cx:parseFloat(e.getAttribute("cx")),cy:parseFloat(e.getAttribute("cy")),r:parseFloat(e.getAttribute("r"))}};function Vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ln(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var sn=function(){function t(r,s){var p=this;(function(c,m){if(!(c instanceof m))throw new TypeError("Cannot call a class as a function")})(this,t),ln(this,"redraw",function(){var c=Me(p.circle),m=c.cx,d=c.cy,v=c.r,g=m+v>p.w?p.w-v:m,y=d+v>p.h?p.h-v:d+v;p.mask.setAttribute("d","M0 0 h".concat(p.w," v").concat(p.h," h-").concat(p.w," z M").concat(g," ").concat(y," a ").concat(v," ").concat(v," 0 1 1 1 0"))}),ln(this,"destroy",function(){return p.mask.parentNode.removeChild(p.mask)}),this.w=r.naturalWidth,this.h=r.naturalHeight,this.circle=s;var i=Me(this.circle),u=i.cx,a=i.cy,f=i.r,l=u+f>this.w?this.w-f:u,o=a+f>this.h?this.h-f:a+f;this.mask=document.createElementNS(w,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(l," ").concat(o," a ").concat(f," ").concat(f," 0 1 1 1 0"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&Vn(e.prototype,n),t}();function In(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ye(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Wn=function(){function t(r,s,p,i){var u=this;(function(a,f){if(!(a instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),Ye(this,"dragTo",function(a,f){var l=u.env.image,o=l.naturalWidth,c=l.naturalHeight;u.group.style.display=null;var m=a-u.anchor[0],d=f-u.anchor[1],v=Math.max(1,Math.pow(Math.pow(m,2)+Math.pow(d,2),.5)/2),g=u.anchor[0]+m/2,y=u.anchor[1]+d/2;g-v<0||g+v>o||y-v<0||y+v>c||(bt(u.circle,g,y,v),u.mask.redraw())}),Ye(this,"getBoundingClientRect",function(){return u.circle.getBoundingClientRect()}),Ye(this,"toSelection",function(){return new xe(W(u.group,u.env.image))}),Ye(this,"destroy",function(){u.group.parentNode.removeChild(u.group),u.mask=null,u.circle=null,u.group=null}),this.anchor=[r,s],this.env=i,this.group=document.createElementNS(w,"g"),this.circle=function(a,f,l){var o=document.createElementNS(w,"g"),c=document.createElementNS(w,"circle"),m=document.createElementNS(w,"circle");return m.setAttribute("class","a9s-inner"),Xe(m,a,f,2),c.setAttribute("class","a9s-outer"),Xe(c,a,f,2),o.appendChild(c),o.appendChild(m),o}(r,s),this.circle.setAttribute("class","a9s-selection"),this.mask=new sn(i.image,this.circle),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.circle),p.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.circle}}])&&In(e.prototype,n),t}(),$n=/firefox/i.test(navigator.userAgent),fn=function(t,e,n,r,s){t.setAttribute("width",r),t.setAttribute("height",s),$n?(t.setAttribute("x",0),t.setAttribute("y",0),t.setAttribute("transform","translate(".concat(e,", ").concat(n,")"))):(t.setAttribute("x",e),t.setAttribute("y",n))},pn=function(t,e){var n=e.getBBox(),r=n.x,s=n.y,p=n.width,i=n.height,u=document.createElementNS(w,"svg");u.setAttribute("class","a9s-formatter-el"),fn(u,r,s,p,i);var a=document.createElementNS(w,"g");a.appendChild(t),u.appendChild(a),e.append(u)},Fe=function(t,e,n){if(!n)return t;var r=n(e);if(!r)return t;if(typeof r=="string"||r instanceof String)C(t,r);else if(r.nodeType===Node.ELEMENT_NODE)pn(r,t);else{var s=r.className,p=r.style,i=r.element;if(s&&C(t,s),p){var u=t.querySelector(".a9s-outer"),a=t.querySelector(".a9s-inner");u&&a?(u.setAttribute("style","display:none"),a.setAttribute("style",p)):t.setAttribute("style",p)}for(var f in i&&pn(i,t),r)r.hasOwnProperty(f)&&f.startsWith("data-")&&t.setAttribute(f,r[f])}},he=function(t,e,n,r,s){var p=t.querySelector(".a9s-formatter-el");p&&fn(p,e,n,r,s)};function ht(t){return ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(t)}function yn(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var p,i,u=[],a=!0,f=!1;try{for(s=s.call(n);!(a=(p=s.next()).done)&&(u.push(p.value),!r||u.length!==r);a=!0);}catch(l){f=!0,i=l}finally{try{a||s.return==null||s.return()}finally{if(f)throw i}}return u}}(t,e)||function(n,r){if(n){if(typeof n=="string")return dn(n,r);var s=Object.prototype.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?dn(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function dn(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gt(t,e,n){return gt=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(r,s,p){var i=function(a,f){for(;!Object.prototype.hasOwnProperty.call(a,f)&&(a=ge(a))!==null;);return a}(r,s);if(i){var u=Object.getOwnPropertyDescriptor(i,s);return u.get?u.get.call(p):u.value}},gt(t,e,n||t)}function mt(t,e){return mt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},mt(t,e)}function Kn(t,e){if(e&&(ht(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(t)}function Q(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ge(t){return ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(t)}function ie(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Jn=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&mt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=ge(r);if(s){var f=ge(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Kn(this,u)});function i(u,a,f,l){var o;(function(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")})(this,i),ie(Q(o=p.call(this,u,a,f,l)),"setSize",function(g,y,b){bt(o.circle,g,y,b),o.mask.redraw(),he(o.elementGroup,g,y,b,b);var h=yn(o.handles,4),O=h[0],S=h[1],j=h[2],P=h[3];o.setHandleXY(O,g,y-b),o.setHandleXY(S,g+b,y),o.setHandleXY(j,g,y+b),o.setHandleXY(P,g-b,y)}),ie(Q(o),"stretchCorners",function(g,y,b){var h,O=o.getHandleXY(y),S=b.x,j=b.y,P=0,x=0;g==0||g==2?(S=O.x,x=j-O.y,h=Math.abs(x)/2):(j=O.y,P=S-O.x,h=Math.abs(P)/2);var M=P>0?O.x:S,R=x>0?O.y:j,A=M+Math.abs(P)/2,E=R+Math.abs(x)/2;if(bt(o.circle,A,E,h),o.mask.redraw(),he(o.elementGroup,A,E,h,h),g==0||g==2){var k=0,H=2;(g==0&&x>0||g==2&&x<0)&&(k=2,H=0),o.setHandleXY(o.handles[k],A,E-h),o.setHandleXY(o.handles[H],A,E+h),o.setHandleXY(o.handles[1],A+h,E),o.setHandleXY(o.handles[3],A-h,E)}else{var X=3,F=1;(g==1&&P>0||g==3&&P<0)&&(X=1,F=3),o.setHandleXY(o.handles[X],A+h,E),o.setHandleXY(o.handles[F],A-h,E),o.setHandleXY(o.handles[0],A,E-h),o.setHandleXY(o.handles[2],A,E+h)}}),ie(Q(o),"onGrab",function(g){return function(y){o.grabbedElem=g;var b=o.getSVGPoint(y),h=Me(o.circle),O=h.cx,S=h.cy;o.grabbedAt={x:b.x-O,y:b.y-S}}}),ie(Q(o),"onMouseMove",function(g){var y=function(A,E){return A<0?0:A>E?E:A};if(o.grabbedElem){var b=o.getSVGPoint(g);if(o.grabbedElem===o.circle){var h=Me(o.circle).r,O=o.env.image,S=O.naturalWidth,j=O.naturalHeight,P=Math.max(y(b.x-o.grabbedAt.x,S-h),h),x=Math.max(y(b.y-o.grabbedAt.y,j-h),h);o.setSize(P,x,h),o.emit("update",W(o.circle,o.env.image))}else{var M=o.handles.indexOf(o.grabbedElem),R=M<2?o.handles[M+2]:o.handles[M-2];o.stretchCorners(M,R,b),o.emit("update",W(o.circle,o.env.image))}}}),ie(Q(o),"onMouseUp",function(){o.grabbedElem=null,o.grabbedAt=null}),ie(Q(o),"onScaleChanged",function(g){return o.handles.map(o.scaleHandle)}),ie(Q(o),"updateState",function(g){var y=oe(g),b=parseFloat(y.getAttribute("cx")),h=parseFloat(y.getAttribute("cy")),O=parseFloat(y.getAttribute("r"));o.setSize(b,h,O)}),o.svg.addEventListener("mousemove",o.onMouseMove),o.svg.addEventListener("mouseup",o.onMouseUp),o.containerGroup=document.createElementNS(w,"g"),o.circle=dt(u),o.circle.querySelector(".a9s-inner").addEventListener("mousedown",o.onGrab(o.circle)),o.mask=new sn(l.image,o.circle),o.containerGroup.appendChild(o.mask.element),o.elementGroup=document.createElementNS(w,"g"),o.elementGroup.setAttribute("class","a9s-annotation editable selected"),o.elementGroup.appendChild(o.circle);var c=Me(o.circle),m=c.cx,d=c.cy,v=c.r;return o.handles=[[m,d-v],[m+v,d],[m,d+v],[m-v,d]].map(function(g){var y=yn(g,2),b=y[0],h=y[1],O=o.drawHandle(b,h);return O.addEventListener("mousedown",o.onGrab(O)),o.elementGroup.appendChild(O),O}),o.containerGroup.appendChild(o.elementGroup),a.appendChild(o.containerGroup),Fe(o.circle,u,f.formatter),o.grabbedElem=null,o.grabbedAt=null,o}return e=i,(n=[{key:"element",get:function(){return this.elementGroup}},{key:"destroy",value:function(){this.containerGroup.parentNode.removeChild(this.containerGroup),gt(ge(i.prototype),"destroy",this).call(this)}}])&&Zn(e.prototype,n),i}(ke);function vt(t){return vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(t)}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wt(t,e){return wt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},wt(t,e)}function er(t,e){if(e&&(vt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return me(t)}function me(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qe(t){return qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(t)}function Re(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ot=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&wt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=qe(r);if(s){var f=qe(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return er(this,u)});function i(u,a,f){var l;return function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}(this,i),Re(me(l=p.call(this,u,a,f)),"startDrawing",function(o,c){l.attachListeners({mouseMove:l.onMouseMove,mouseUp:l.onMouseUp}),l.rubberband=new Wn(o,c,l.g,l.env)}),Re(me(l),"stop",function(){l.rubberband&&(l.rubberband.destroy(),l.rubberband=null)}),Re(me(l),"onMouseMove",function(o,c){return l.rubberband.dragTo(o,c)}),Re(me(l),"onMouseUp",function(){l.detachListeners(),l.started=!1;var o=l.rubberband.getBoundingClientRect(),c=o.width,m=o.height,d=l.config.minSelectionWidth||4,v=l.config.minSelectionHeight||4;if(c>=d&&m>=v){var g=l.rubberband.element;g.annotation=l.rubberband.toSelection(),l.emit("complete",g)}else l.emit("cancel");l.stop()}),Re(me(l),"createEditableShape",function(o){return new Jn(o,l.g,l.config,l.env)}),l.rubberband=null,l}return e=i,(n=[{key:"isDrawing",get:function(){return this.rubberband!=null}}])&&Qn(e.prototype,n),i}(ye);Ot.identifier="circle",Ot.supports=function(t){var e,n=t.selector("SvgSelector");if(n)return(e=n.value)===null||e===void 0?void 0:e.match(/^<svg.*<circle/g)};var ze=function(t,e,n,r,s){t.setAttribute("cx",e),t.setAttribute("cy",n),t.setAttribute("rx",r),t.setAttribute("ry",s)},St=function(t,e,n,r,s){var p=t.querySelector(".a9s-inner"),i=t.querySelector(".a9s-outer");ze(p,e,n,r,s),ze(i,e,n,r,s)},_e=function(t){var e=t.querySelector(".a9s-outer");return{cx:parseFloat(e.getAttribute("cx")),cy:parseFloat(e.getAttribute("cy")),rx:parseFloat(e.getAttribute("rx")),ry:parseFloat(e.getAttribute("ry"))}};function tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var hn=function(){function t(r,s){var p=this;(function(c,m){if(!(c instanceof m))throw new TypeError("Cannot call a class as a function")})(this,t),bn(this,"redraw",function(){var c=_e(p.ellipse),m=c.cx,d=c.cy,v=c.rx,g=c.ry,y=d+g;p.mask.setAttribute("d","M0 0 h".concat(p.w," v").concat(p.h," h-").concat(p.w," z M").concat(m," ").concat(y," a ").concat(v," ").concat(g," 0 1 1 1 0"))}),bn(this,"destroy",function(){return p.mask.parentNode.removeChild(p.mask)}),this.w=r.naturalWidth,this.h=r.naturalHeight,this.ellipse=s;var i=_e(this.ellipse),u=i.cx,a=i.cy,f=i.rx,l=i.ry,o=a+l;this.mask=document.createElementNS(w,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(u," ").concat(o," a ").concat(f," ").concat(l," 0 1 1 1 0"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&tr(e.prototype,n),t}();function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ve(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var rr=function(){function t(r,s,p,i){var u=this;(function(a,f){if(!(a instanceof f))throw new TypeError("Cannot call a class as a function")})(this,t),Ve(this,"dragTo",function(a,f){u.group.style.display=null;var l=a-u.anchor[0],o=f-u.anchor[1],c=l>0?u.anchor[0]+l/2:a+l/2,m=o>0?u.anchor[1]+o/2:f+o/2,d=Math.abs(l/2),v=Math.abs(o/2);St(u.ellipse,c,m,d,v),u.mask.redraw()}),Ve(this,"getBoundingClientRect",function(){return u.ellipse.getBoundingClientRect()}),Ve(this,"toSelection",function(){return new xe(W(u.group,u.env.image))}),Ve(this,"destroy",function(){u.group.parentNode.removeChild(u.group),u.mask=null,u.ellipse=null,u.group=null}),this.anchor=[r,s],this.env=i,this.group=document.createElementNS(w,"g"),this.ellipse=function(a,f,l,o){var c=document.createElementNS(w,"g"),m=document.createElementNS(w,"ellipse"),d=document.createElementNS(w,"ellipse");return m.setAttribute("class","a9s-inner"),ze(m,a,f,2,o),d.setAttribute("class","a9s-outer"),ze(d,a,f,2,o),c.appendChild(d),c.appendChild(m),c}(r,s),this.ellipse.setAttribute("class","a9s-selection"),this.mask=new hn(i.image,this.ellipse),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.ellipse),p.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.ellipse}}])&&nr(e.prototype,n),t}();function jt(t){return jt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jt(t)}function gn(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var p,i,u=[],a=!0,f=!1;try{for(s=s.call(n);!(a=(p=s.next()).done)&&(u.push(p.value),!r||u.length!==r);a=!0);}catch(l){f=!0,i=l}finally{try{a||s.return==null||s.return()}finally{if(f)throw i}}return u}}(t,e)||function(n,r){if(n){if(typeof n=="string")return mn(n,r);var s=Object.prototype.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?mn(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function mn(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function or(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(t,e,n){return Pt=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(r,s,p){var i=function(a,f){for(;!Object.prototype.hasOwnProperty.call(a,f)&&(a=ve(a))!==null;);return a}(r,s);if(i){var u=Object.getOwnPropertyDescriptor(i,s);return u.get?u.get.call(p):u.value}},Pt(t,e,n||t)}function Et(t,e){return Et=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Et(t,e)}function ir(t,e){if(e&&(jt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ee(t)}function ee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ve(t){return ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(t)}function ae(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ar=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Et(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=ve(r);if(s){var f=ve(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return ir(this,u)});function i(u,a,f,l){var o;(function(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")})(this,i),ae(ee(o=p.call(this,u,a,f,l)),"setSize",function(y,b,h,O){St(o.ellipse,y,b,h,O),o.mask.redraw(),he(o.elementGroup,y,b,h,O);var S=gn(o.handles,4),j=S[0],P=S[1],x=S[2],M=S[3];o.setHandleXY(j,y,b-O),o.setHandleXY(P,y+h,b),o.setHandleXY(x,y,b+O),o.setHandleXY(M,y-h,b)}),ae(ee(o),"stretchCorners",function(y,b,h,O){var S=o.getHandleXY(b),j=o.getHandleXY(h),P=O.x,x=O.y,M=0,R=0;y==0||y==2?P=S.x:x=S.y;var A=P-S.x,E=x-S.y,k=A>0?S.x:P,H=E>0?S.y:x,X=Math.abs(A),F=Math.abs(E),Y=k+X/2,B=H+F/2;if(M=X/2,R=F/2,y==0||y==2?M=Math.abs(S.x-j.x):R=Math.abs(S.y-j.y),St(o.ellipse,Y,B,M,R),o.mask.redraw(),he(o.elementGroup,Y,B,M,R),y==0||y==2){var z=0,Je=2;(y==0&&E>0||y==2&&E<0)&&(z=2,Je=0),o.setHandleXY(o.handles[z],Y,B-R),o.setHandleXY(o.handles[Je],Y,B+R),o.setHandleXY(o.handles[1],Y+M,B),o.setHandleXY(o.handles[3],Y-M,B)}else{var Qe=3,Mn=1;(y==1&&A>0||y==3&&A<0)&&(Qe=1,Mn=3),o.setHandleXY(o.handles[Qe],Y+M,B),o.setHandleXY(o.handles[Mn],Y-M,B),o.setHandleXY(o.handles[0],Y,B-R),o.setHandleXY(o.handles[2],Y,B+R)}}),ae(ee(o),"onGrab",function(y){return function(b){o.grabbedElem=y;var h=o.getSVGPoint(b),O=_e(o.ellipse),S=O.cx,j=O.cy;o.grabbedAt={x:h.x-S,y:h.y-j}}}),ae(ee(o),"onMouseMove",function(y){var b=function(X,F){return X<0?0:X>F?F:X};if(o.grabbedElem){var h=o.getSVGPoint(y);if(o.grabbedElem===o.ellipse){var O=_e(o.ellipse),S=O.rx,j=O.ry,P=o.env.image,x=P.naturalWidth,M=P.naturalHeight,R=b(h.x-o.grabbedAt.x,x-S),A=b(h.y-o.grabbedAt.y,M-j);o.setSize(R,A,S,j),o.emit("update",W(o.ellipse,o.env.image))}else{var E=o.handles.indexOf(o.grabbedElem),k=E<2?o.handles[E+2]:o.handles[E-2],H=o.handles[(E+3)%4];o.stretchCorners(E,k,H,h),o.emit("update",W(o.ellipse,o.env.image))}}}),ae(ee(o),"onMouseUp",function(){o.grabbedElem=null,o.grabbedAt=null}),ae(ee(o),"onScaleChanged",function(y){return o.handles.map(o.scaleHandle)}),ae(ee(o),"updateState",function(y){var b=oe(y),h=parseFloat(b.getAttribute("cx")),O=parseFloat(b.getAttribute("cy")),S=parseFloat(b.getAttribute("rx")),j=parseFloat(b.getAttribute("ry"));o.setSize(h,O,S,j)}),o.svg.addEventListener("mousemove",o.onMouseMove),o.svg.addEventListener("mouseup",o.onMouseUp),o.containerGroup=document.createElementNS(w,"g"),o.ellipse=dt(u),o.ellipse.querySelector(".a9s-inner").addEventListener("mousedown",o.onGrab(o.ellipse)),o.mask=new hn(l.image,o.ellipse),o.containerGroup.appendChild(o.mask.element),o.elementGroup=document.createElementNS(w,"g"),o.elementGroup.setAttribute("class","a9s-annotation editable selected"),o.elementGroup.appendChild(o.ellipse);var c=_e(o.ellipse),m=c.cx,d=c.cy,v=c.rx,g=c.ry;return o.handles=[[m,d-g],[m+v,d],[m,d+g],[m-v,d]].map(function(y){var b=gn(y,2),h=b[0],O=b[1],S=o.drawHandle(h,O);return S.addEventListener("mousedown",o.onGrab(S)),o.elementGroup.appendChild(S),S}),o.containerGroup.appendChild(o.elementGroup),a.appendChild(o.containerGroup),Fe(o.ellipse,u,f.formatter),o.grabbedElem=null,o.grabbedAt=null,o}return e=i,(n=[{key:"element",get:function(){return this.elementGroup}},{key:"destroy",value:function(){this.containerGroup.parentNode.removeChild(this.containerGroup),Pt(ve(i.prototype),"destroy",this).call(this)}}])&&or(e.prototype,n),i}(ke);function At(t){return At=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(t)}function ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xt(t,e){return xt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},xt(t,e)}function cr(t,e){if(e&&(At(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return we(t)}function we(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ie(t){return Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ie(t)}function Te(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var kt=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&xt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=Ie(r);if(s){var f=Ie(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return cr(this,u)});function i(u,a,f){var l;return function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}(this,i),Te(we(l=p.call(this,u,a,f)),"startDrawing",function(o,c){l.attachListeners({mouseMove:l.onMouseMove,mouseUp:l.onMouseUp}),l.rubberband=new rr(o,c,l.g,l.env)}),Te(we(l),"stop",function(){l.rubberband&&(l.rubberband.destroy(),l.rubberband=null)}),Te(we(l),"onMouseMove",function(o,c){return l.rubberband.dragTo(o,c)}),Te(we(l),"onMouseUp",function(){l.detachListeners(),l.started=!1;var o=l.rubberband.getBoundingClientRect(),c=o.width,m=o.height,d=l.config.minSelectionWidth||4,v=l.config.minSelectionHeight||4;if(c>=d&&m>=v){var g=l.rubberband.element;g.annotation=l.rubberband.toSelection(),l.emit("complete",g)}else l.emit("cancel");l.stop()}),Te(we(l),"createEditableShape",function(o){return new ar(o,l.g,l.config,l.env)}),l.rubberband=null,l}return e=i,(n=[{key:"isDrawing",get:function(){return this.rubberband!=null}}])&&ur(e.prototype,n),i}(ye);function Ct(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}kt.identifier="ellipse",kt.supports=function(t){var e,n=t.selector("SvgSelector");if(n)return(e=n.value)===null||e===void 0?void 0:e.match(/^<svg.*<ellipse/g)};var sr=function(){function t(r,s,p){var i=this;(function(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")})(this,t),Oe(this,"setPoints",function(u){var a=u.map(function(f){return"L".concat(f[0]," ").concat(f[1])}).join(" ");a="M"+a.substring(1),i.outer.setAttribute("d",a),i.inner.setAttribute("d",a)}),Oe(this,"getBoundingClientRect",function(){return i.outer.getBoundingClientRect()}),Oe(this,"dragTo",function(u){i.group.style.display=null,i.addPoint(u)}),Oe(this,"addPoint",function(u){var a;i.points=[].concat(function(f){if(Array.isArray(f))return Ct(f)}(a=i.points)||function(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}(a)||function(f,l){if(f){if(typeof f=="string")return Ct(f,l);var o=Object.prototype.toString.call(f).slice(8,-1);return o==="Object"&&f.constructor&&(o=f.constructor.name),o==="Map"||o==="Set"?Array.from(f):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ct(f,l):void 0}}(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}(),[u]),i.setPoints(i.points)}),Oe(this,"destroy",function(){i.group.parentNode.removeChild(i.group),i.freehand=null,i.group=null}),Oe(this,"toSelection",function(){return new xe(W(i.group,i.env.image))}),this.points=[r],this.env=p,this.group=document.createElementNS(w,"g"),this.freehand=document.createElementNS(w,"g"),this.freehand.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(w,"path"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(w,"path"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.freehand.appendChild(this.outer),this.freehand.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.freehand),s.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.freehand}}])&&lr(e.prototype,n),t}();function Mt(t){return Mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(t)}function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rt(t,e){return Rt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Rt(t,e)}function pr(t,e){if(e&&(Mt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return te(t)}function te(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _t(t,e,n){return _t=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(r,s,p){var i=function(a,f){for(;!Object.prototype.hasOwnProperty.call(a,f)&&(a=Se(a))!==null;);return a}(r,s);if(i){var u=Object.getOwnPropertyDescriptor(i,s);return u.get?u.get.call(p):u.value}},_t(t,e,n||t)}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Se(t)}function je(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vn=function(t){var e=t.getAttribute("d").split("L"),n=[];if(e.length>0){var r=e[0].substring(1).trim().split(" ");n.push({x:parseFloat(r[0]),y:parseFloat(r[1])});for(var s=1;s<e.length;s++)r=e[s].trim().split(" "),n.push({x:parseFloat(r[0]),y:parseFloat(r[1])})}return n},wn=function(t){return t.querySelector(".a9s-inner").getBBox()},yr=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Rt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=Se(r);if(s){var f=Se(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return pr(this,u)});function i(u,a,f,l){var o,c;(function(d,v){if(!(d instanceof v))throw new TypeError("Cannot call a class as a function")})(this,i),je(te(c=p.call(this,u,a,f,l)),"setPoints",function(d){var v=function(P){return Math.round(10*P)/10},g=d.map(function(P){return"L".concat(v(P.x)," ").concat(v(P.y))}).join(" ");g="M"+g.substring(1),c.shape.querySelector(".a9s-inner").setAttribute("d",g);var y=c.shape.querySelector(".a9s-outer");y.setAttribute("d",g);var b=y.getBBox(),h=b.x,O=b.y,S=b.width,j=b.height;he(c.elementGroup,h,O,S,j)}),je(te(c),"onGrab",function(d){return function(v){c.grabbedElem=d;var g=c.getSVGPoint(v);c.grabbedAt={x:g.x,y:g.y}}}),je(te(c),"onMouseMove",function(d){var v=function(k,H,X){return k+H<0?-k:k+H>X?X-k:H};if(c.grabbedElem){var g=c.getSVGPoint(d),y=wn(c.shape),b=y.x,h=y.y,O=y.width,S=y.height;if(c.grabbedElem===c.shape){var j=c.env.image,P=j.naturalWidth,x=j.naturalHeight,M=v(b,g.x-c.grabbedAt.x,P-O),R=v(h,g.y-c.grabbedAt.y,x-S),A=c.shape.querySelector(".a9s-inner"),E=vn(A).map(function(k){return{x:k.x+M,y:k.y+R}});c.grabbedAt=g,c.setPoints(E),c.emit("update",W(c.shape,c.env.image))}}}),je(te(c),"onMouseUp",function(d){c.grabbedElem=null,c.grabbedAt=null}),je(te(c),"updateState",function(d){var v=vn(oe(d));c.setPoints(v)}),je(te(c),"destroy",function(){c.containerGroup.parentNode.removeChild(c.containerGroup),_t((o=te(c),Se(i.prototype)),"destroy",o).call(o)}),c.svg.addEventListener("mousemove",c.onMouseMove),c.svg.addEventListener("mouseup",c.onMouseUp),c.containerGroup=document.createElementNS(w,"g"),c.shape=dt(u),c.elementGroup=document.createElementNS(w,"g"),c.elementGroup.setAttribute("class","a9s-annotation editable selected"),c.elementGroup.appendChild(c.shape),c.containerGroup.appendChild(c.elementGroup),a.appendChild(c.containerGroup),Fe(c.shape,u,f.formatter),c.shape.querySelector(".a9s-inner").addEventListener("mousedown",c.onGrab(c.shape));var m=wn(c.shape);return m.x,m.y,m.width,m.height,c.grabbedElem=null,c.grabbedAt=null,c}return e=i,(n=[{key:"element",get:function(){return this.elementGroup}}])&&fr(e.prototype,n),i}(ke);function Tt(t){return Tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(t)}function dr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gt(t,e){return Gt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Gt(t,e)}function br(t,e){if(e&&(Tt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ue(t)}function ue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function We(t){return We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},We(t)}function Pe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Dt=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Gt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=We(r);if(s){var f=We(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return br(this,u)});function i(u,a,f){var l;return function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}(this,i),Pe(ue(l=p.call(this,u,a,f)),"startDrawing",function(o,c){l._isDrawing=!0,l.attachListeners({mouseMove:l.onMouseMove,mouseUp:l.onMouseUp,dblClick:l.onDblClick}),l.rubberband=new sr([o,c],l.g,l.env)}),Pe(ue(l),"stop",function(){l.detachListeners(),l._isDrawing=!1,l.rubberband&&(l.rubberband.destroy(),l.rubberband=null)}),Pe(ue(l),"onMouseMove",function(o,c){return l.rubberband.dragTo([o,c])}),Pe(ue(l),"onMouseUp",function(o,c){l.onDblClick(o,c)}),Pe(ue(l),"onDblClick",function(o,c){l._isDrawing=!1,l.rubberband.addPoint([o,c]),l.detachListeners();var m=l.rubberband.getBoundingClientRect(),d=m.width,v=m.height,g=l.config.minSelectionWidth||4,y=l.config.minSelectionHeight||4;if(d>=g||v>=y){var b=l.rubberband.element;b.annotation=l.rubberband.toSelection(),l.emit("complete",b)}else l.emit("cancel");l.stop()}),Pe(ue(l),"createEditableShape",function(o){return new yr(o,l.g,l.config,l.env)}),l._isDrawing=!1,l}return e=i,(n=[{key:"isDrawing",get:function(){return this._isDrawing}}])&&dr(e.prototype,n),i}(ye);function hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function On(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Dt.identifier="freehand",Dt.supports=function(t){var e=t.selector("SvgSelector");if(e)return e.value.match(/^<svg.*<path*/g)&&!e.value.toUpperCase().includes("Z")};var gr=function(){function t(r,s){var p=this;(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),On(this,"redraw",function(){p.mask.setAttribute("d","M0 0 h".concat(p.w," v").concat(p.h," h-").concat(p.w," z M").concat(p.polygon.getAttribute("points")," z"))}),On(this,"destroy",function(){return p.mask.parentNode.removeChild(p.mask)}),this.w=r.naturalWidth,this.h=r.naturalHeight,this.polygon=s,this.mask=document.createElementNS(w,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(this.polygon.getAttribute("points")," z"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&hr(e.prototype,n),t}();function Sn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function jn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Sn(Object(n),!0).forEach(function(r){Z(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Pn(t){return function(e){if(Array.isArray(e))return Nt(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||An(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function En(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=An(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,s=function(){};return{s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(a){throw a},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var a=n.next();return i=a.done,a},e:function(a){u=!0,p=a},f:function(){try{i||n.return==null||n.return()}finally{if(u)throw p}}}}function An(t,e){if(t){if(typeof t=="string")return Nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nt(t,e):void 0}}function Nt(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Z(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vr=function(){function t(r,s,p){var i=this;(function(u,a){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")})(this,t),Z(this,"setPoints",function(u){var a,f="",l=En(u);try{for(l.s();!(a=l.n()).done;){var o=a.value,c="";if(o.length>0){var m,d=En(o);try{for(d.s();!(m=d.n()).done;){var v=m.value;v&&(c+=c===""?"M".concat(v[0],",").concat(v[1]):" L".concat(v[0],",").concat(v[1]))}}catch(g){d.e(g)}finally{d.f()}f+=c}}}catch(g){l.e(g)}finally{l.f()}f+=" Z",i.outer.setAttribute("d",f),i.inner.setAttribute("d",f)}),Z(this,"getBoundingClientRect",function(){return i.outer.getBoundingClientRect()}),Z(this,"dragTo",function(u){i.group.style.display=null;var a=i.points[i.points.length-1].slice(0,i.points[i.points.length-1].length-1),f=i.points.slice(0,-1),l=[].concat(Pn(a),[u,a[0]]);f.push(l),i.setPoints(f),i.mask.redraw()}),Z(this,"addPoint",function(u){if(i.points[i.points.length-1].length>0){var a=i.points[i.points.length-1].slice(0,i.points[i.points.length-1].length-1),f=a[a.length-1];Math.pow(u[0]-f[0],2)+Math.pow(u[1]-f[1],2)>4&&(i.points[i.points.length-1]=[].concat(Pn(a),[u,a[0]]),i.setPoints(i.points),i.mask.redraw())}else i.points[i.points.length-1]=[u,u],i.setPoints(i.points)}),Z(this,"undo",function(){i.points[i.points.length-1].length>2?i.points[i.points.length-1].pop():i.points.length>1&&i.points.pop()}),Z(this,"newPart",function(){i.points.push([])}),Z(this,"destroy",function(){i.group.parentNode.removeChild(i.group),i.multipolygon=null,i.group=null}),Z(this,"toSelection",function(){return new xe(jn(jn({},W(i.group,i.env.image)),{},{renderedVia:{name:"multipolygon"}}))}),this.points=[],this.points.push([r,r]),this.env=p,this.group=document.createElementNS(w,"g"),this.multipolygon=document.createElementNS(w,"g"),this.multipolygon.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(w,"path"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(w,"path"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.mask=new gr(p.image,this.inner),this.multipolygon.appendChild(this.outer),this.multipolygon.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.multipolygon),s.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.multipolygon}}])&&mr(e.prototype,n),t}();function Ht(t){return Ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(t)}function xn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function $e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xn(Object(n),!0).forEach(function(r){ce(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lt(t,e){return Lt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Lt(t,e)}function Or(t,e){if(e&&(Ht(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ne(t)}function ne(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bt(t,e,n){return Bt=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(r,s,p){var i=function(a,f){for(;!Object.prototype.hasOwnProperty.call(a,f)&&(a=Ee(a))!==null;);return a}(r,s);if(i){var u=Object.getOwnPropertyDescriptor(i,s);return u.get?u.get.call(p):u.value}},Bt(t,e,n||t)}function Ee(t){return Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(t)}function ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(a,f){if(a){if(typeof a=="string")return kn(a,f);var l=Object.prototype.toString.call(a).slice(8,-1);return l==="Object"&&a.constructor&&(l=a.constructor.name),l==="Map"||l==="Set"?Array.from(a):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?kn(a,f):void 0}}(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,s=function(){};return{s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(a){throw a},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var a=n.next();return i=a.done,a},e:function(a){u=!0,p=a},f:function(){try{i||n.return==null||n.return()}finally{if(u)throw p}}}}function kn(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ze=function(t){var e,n=[],r=K(Cn(t.querySelector(".a9s-inner").attributes.d.nodeValue));try{for(r.s();!(e=r.n()).done;){var s,p=e.value,i=[],u=K(p);try{for(u.s();!(s=u.n()).done;){var a=s.value,f={x:parseFloat(a[0]),y:parseFloat(a[1])};i.push(f)}}catch(l){u.e(l)}finally{u.f()}n.push(i)}}catch(l){r.e(l)}finally{r.f()}return n},Cn=function(t){var e=t.split("M"),n=[];return e.forEach(function(r,s){if(r.length>0){var p=[];(r=(r=(r=(r=(r=r.replace(/ Z/g,"Z")).replace(/Z /g,"Z")).replace(/Z/g,"")).replace(/L /g,"L")).replace(/ L/g,"L")).split("L").forEach(function(i,u){p.push([parseFloat(i.split(",")[0]).toFixed(2).toString(),parseFloat(i.split(",")[1]).toFixed(2).toString()])}),p[0]!==p[p.length-1]&&p.push(p[0]),n.push(p)}}),n},Sr=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Lt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=Ee(r);if(s){var f=Ee(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Or(this,u)});function i(u,a,f,l){var o,c;(function(b,h){if(!(b instanceof h))throw new TypeError("Cannot call a class as a function")})(this,i),ce(ne(c=p.call(this,u,a,f,l)),"setPoints",function(b){var h,O=function(B){return Math.round(10*B)/10},S="",j=K(b);try{for(j.s();!(h=j.n()).done;){var P=h.value;S+="M";var x,M=!0,R=K(P);try{for(R.s();!(x=R.n()).done;){var A=x.value;M?(M=!1,S+=A.x.toString()+","+A.y.toString()):S+=" L"+O(A.x).toString()+","+O(A.y).toString()}}catch(B){R.e(B)}finally{R.f()}S+=" Z"}}catch(B){j.e(B)}finally{j.f()}c.shape.querySelector(".a9s-inner").setAttribute("d",S);var E=c.shape.querySelector(".a9s-outer");E.setAttribute("d",S);var k=E.getBBox(),H=k.x,X=k.y,F=k.width,Y=k.height;he(c.elementGroup,H,X,F,Y)}),ce(ne(c),"onGrab",function(b){return function(h){c.grabbedElem=b;var O=c.getSVGPoint(h);c.grabbedAt={x:O.x,y:O.y}}}),ce(ne(c),"onMouseMove",function(b){var h;c.grabbedElem&&(h=c.getSVGPoint(b),c.grabbedElem===c.shape?function(){var O,S=h.x-c.grabbedAt.x,j=h.y-c.grabbedAt.y,P=[],x=K(Ze(c.shape));try{for(x.s();!(O=x.n()).done;){var M=O.value;P.push(M.map(function(k){return{x:k.x+S,y:k.y+j}}))}}catch(k){x.e(k)}finally{x.f()}c.grabbedAt=h,c.setPoints(P);for(var R=0,A=0,E=P;A<E.length;A++)E[A].forEach(function(k,H){c.handles[R][H]!==void 0&&c.setHandleXY(c.handles[R][H],k.x,k.y)}),R+=1;c.emit("update",$e($e({},W(c.shape,c.env.image)),{},{renderedVia:{name:"multipolygon"}}))}():function(){var O,S=-1,j=0,P=!1,x=K(c.handles);try{for(x.s();!(O=x.n()).done;){var M=O.value;M.indexOf(c.grabbedElem)>0?(S=M.indexOf(c.grabbedElem),P=!0):P||(j+=1)}}catch(z){x.e(z)}finally{x.f()}var R,A=Ze(c.shape),E=[],k=0,H=K(A);try{for(H.s();!(R=H.n()).done;){var X=R.value;k===j?function(){var z=[];X.forEach(function(Je,Qe){Qe===S?z.push(h):z.push(Je)}),E.push(z)}():E.push(X),k+=1}}catch(z){H.e(z)}finally{H.f()}c.setPoints(E),k=0;var F,Y=K(c.handles);try{for(Y.s();!(F=Y.n()).done;){var B=F.value;k===j&&c.setHandleXY(B[S],h.x,h.y),k+=1}}catch(z){Y.e(z)}finally{Y.f()}c.emit("update",$e($e({},W(c.shape,c.env.image)),{},{renderedVia:{name:"multipolygon"}}))}())}),ce(ne(c),"onMouseUp",function(b){c.grabbedElem=null,c.grabbedAt=null}),ce(ne(c),"updateState",function(b){var h=Ze(oe(b));c.setPoints(h)}),ce(ne(c),"destroy",function(){c.containerGroup.parentNode.removeChild(c.containerGroup),Bt((o=ne(c),Ee(i.prototype)),"destroy",o).call(o)}),c.svg.addEventListener("mousemove",c.onMouseMove),c.svg.addEventListener("mouseup",c.onMouseUp),c.containerGroup=document.createElementNS(w,"g"),c.shape=function(b){var h=oe(b);(function(P){var x=oe(P).getAttribute("d");Cn(x)})(b);var O=document.createElementNS(w,"g"),S=h.cloneNode(!0);S.setAttribute("class","a9s-inner");var j=h.cloneNode(!0);return j.setAttribute("class","a9s-outer"),O.appendChild(j),O.appendChild(S),O}(u),c.elementGroup=document.createElementNS(w,"g"),c.elementGroup.setAttribute("class","a9s-annotation editable selected"),c.elementGroup.appendChild(c.shape);var m=Ze(c.shape);c.handles=[];var d,v=K(m);try{for(v.s();!(d=v.n()).done;){var g=d.value;c.handles.push(g.map(function(b){var h=c.drawHandle(b.x,b.y);return h.addEventListener("mousedown",c.onGrab(h)),c.elementGroup.appendChild(h),h}))}}catch(b){v.e(b)}finally{v.f()}c.containerGroup.appendChild(c.elementGroup),a.appendChild(c.containerGroup),Fe(c.shape,u,f.formatter),c.shape.querySelector(".a9s-inner").addEventListener("mousedown",c.onGrab(c.shape));var y=c.shape.querySelector(".a9s-inner").getBBox();return y.x,y.y,y.width,y.height,c.grabbedElem=null,c.grabbedAt=null,c}return e=i,(n=[{key:"element",get:function(){return this.elementGroup}}])&&wr(e.prototype,n),i}(ke);function Ut(t){return Ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ut(t)}function jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return Xt=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Xt(t,e)}function Pr(t,e){if(e&&(Ut(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J(t)}function J(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ke(t){return Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ke(t)}function re(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Yt=function(t){(function(u,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(a&&a.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),a&&Xt(u,a)})(i,t);var e,n,r,s,p=(r=i,s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var u,a=Ke(r);if(s){var f=Ke(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Pr(this,u)});function i(u,a,f){var l;return function(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}(this,i),re(J(l=p.call(this,u,a,f)),"startDrawing",function(o,c){l._isDrawing=!0,l.attachListeners({mouseMove:l.onMouseMove,mouseUp:l.onMouseUp,dblClick:l.onDblClick}),l.rubberband=new vr([o,c],l.g,l.env)}),re(J(l),"stop",function(){l.detachListeners(),l._isDrawing=!1,l.rubberband&&(l.rubberband.destroy(),l.rubberband=null)}),re(J(l),"undo",function(){l.rubberband&&l.rubberband.undo()}),re(J(l),"newPart",function(){l.rubberband&&l.rubberband.newPart()}),re(J(l),"onMouseMove",function(o,c){return l.rubberband.dragTo([o,c])}),re(J(l),"onMouseUp",function(o,c,m){if(m.altKey)l.onDblClick(m);else if(m.ctrlKey)l.rubberband.undo();else{var d=l.rubberband.getBoundingClientRect(),v=d.width,g=d.height,y=l.config.minSelectionWidth||4,b=l.config.minSelectionHeight||4;v>=y||g>=b?l.rubberband.addPoint([o,c]):(l.emit("cancel"),l.stop())}}),re(J(l),"onDblClick",function(o,c){l._isDrawing=!1,l.rubberband.addPoint([o,c]);var m=l.rubberband.element;m.annotation=l.rubberband.toSelection(),l.emit("complete",m),l.stop()}),re(J(l),"createEditableShape",function(o){return new Sr(o,l.g,l.config,l.env)}),l._isDrawing=!1,document.addEventListener("keydown",function(o){o.key=="z"&&o.ctrlKey&&l.undo(),o.key=="n"&&l.newPart()}),l}return e=i,(n=[{key:"isDrawing",get:function(){return this._isDrawing}}])&&jr(e.prototype,n),i}(ye);Yt.identifier="multipolygon",Yt.supports=function(t){return!1};var Er=new Set(["point","circle","ellipse","freehand"]);const Ar=function(t,e){(e!=null&&e.tools?e.tools.map(function(n){return n.toLowerCase()}):Er).forEach(function(n){n==="point"&&t.addDrawingTool(yt),n==="circle"&&t.addDrawingTool(Ot),n==="ellipse"&&t.addDrawingTool(kt),n==="freehand"&&t.addDrawingTool(Dt),n==="multipolygon"&&t.addDrawingTool(Yt)})}})(),se.default})()})})(Rn);var _n=Rn.exports;const Cr=xr(_n),Rr=kr({__proto__:null,default:Cr},[_n]);export{Rr as a};
